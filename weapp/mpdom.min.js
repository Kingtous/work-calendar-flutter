(function(t){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=t()}else if(typeof define==="function"&&define.amd){define([],t)}else{var e;if(typeof window!=="undefined"){e=window}else if(typeof global!=="undefined"){e=global}else if(typeof self!=="undefined"){e=self}else{e=this}e.MPDOM=t()}})(function(){var define,module,exports;return function(){function c(r,s,a){function l(i,t){if(!s[i]){if(!r[i]){var e="function"==typeof require&&require;if(!t&&e)return e(i,!0);if(u)return u(i,!0);var n=new Error("Cannot find module '"+i+"'");throw n.code="MODULE_NOT_FOUND",n}var o=s[i]={exports:{}};r[i][0].call(o.exports,function(t){var e=r[i][1][t];return l(e||t)},o,o.exports,c,r,s,a)}return s[i].exports}for(var u="function"==typeof require&&require,t=0;t<a.length;t++)l(a[t]);return l}return c}()({1:[function(t,e,i){"use strict";var s=this&&this.__assign||function(){s=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++){e=arguments[i];for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o))t[o]=e[o]}return t};return s.apply(this,arguments)};var a=this&&this.__awaiter||function(t,s,i,a){function l(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(e,i){function n(t){try{r(a.next(t))}catch(t){i(t)}}function o(t){try{r(a["throw"](t))}catch(t){i(t)}}function r(t){t.done?e(t.value):l(t.value).then(n,o)}r((a=a.apply(t,s||[])).next())})};var l=this&&this.__generator||function(t,i){var n={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},o,r,s,e;return e={next:a(0),throw:a(1),return:a(2)},typeof Symbol==="function"&&(e[Symbol.iterator]=function(){return this}),e;function a(e){return function(t){return l([e,t])}}function l(e){if(o)throw new TypeError("Generator is already executing.");while(n)try{if(o=1,r&&(s=e[0]&2?r["return"]:e[0]?r["throw"]||((s=r["return"])&&s.call(r),0):r.next)&&!(s=s.call(r,e[1])).done)return s;if(r=0,s)e=[e[0]&2,s.value];switch(e[0]){case 0:case 1:s=e;break;case 4:n.label++;return{value:e[1],done:false};case 5:n.label++;r=e[1];e=[0];continue;case 7:e=n.ops.pop();n.trys.pop();continue;default:if(!(s=n.trys,s=s.length>0&&s[s.length-1])&&(e[0]===6||e[0]===2)){n=0;continue}if(e[0]===3&&(!s||e[1]>s[0]&&e[1]<s[3])){n.label=e[1];break}if(e[0]===6&&n.label<s[1]){n.label=s[1];s=e;break}if(s&&n.label<s[2]){n.label=s[2];n.ops.push(e);break}if(s[2])n.ops.pop();n.trys.pop();continue}e=i.call(t,n)}catch(t){e=[6,t];r=0}finally{o=s=0}if(e[0]&5)throw e[1];return{value:e[0]?e[1]:void 0,done:true}}};Object.defineProperty(i,"__esModule",{value:true});i.WXApp=i.BrowserApp=void 0;var u=t("./page");var n=t("./router");var o=function(){function t(t,e){this.rootElement=t;this.engine=e;this.router=new n.BrowserRouter(this.engine);e.app=this;this.setupPageScrollListener()}t.prototype.setupPageScrollListener=function(){var i=this;document.addEventListener("scroll",function(){var t;if(document.documentElement.scrollHeight>innerHeight&&window.pageYOffset+innerHeight>=document.documentElement.scrollHeight){var e=((t=i.engine.app)===null||t===void 0?void 0:t.router).history;e[e.length-1].item.onReachBottom()}})};t.prototype.getURLSearchParams=function(){try{var t={};var e=new URL(window.location.href).searchParams;var i=e.keys();var n=i.next();while(!n.done){t[n.value]=e.get(n.value);n=i.next();if(n.done)break}return t}catch(t){console.error(t);return{}}};t.prototype.setupFirstPage=function(n){var o,r;return a(this,void 0,void 0,function(){var e,i;return l(this,function(t){switch(t.label){case 0:if(!n){if(this.router.isPathRewriteEnabled){n={route:new URL(window.location.href).pathname||"/",params:this.getURLSearchParams()}}else{e=s({},this.getURLSearchParams());delete e["route"];n={route:new URL(window.location.href).searchParams.get("route")||"/",params:e}}}i=new u.Page(this.rootElement,this.engine,n);i.isFirst=true;this.router.history.push({item:i,scrollPosition:0});return[4,i.ready()];case 1:t.sent();this.router.didSetupFirst(i.viewId,(o=n===null||n===void 0?void 0:n.route)!==null&&o!==void 0?o:"/",(r=n===null||n===void 0?void 0:n.params)!==null&&r!==void 0?r:{});return[2]}})})};t.prototype.enablePathRewrite=function(){this.router.isPathRewriteEnabled=true};return t}();i.BrowserApp=o;var r=function(){function t(t,e){this.indexPage=t;this.engine=e;this.router=new n.WXRouter(this.engine);e.app=this}return t}();i.WXApp=r},{"./page":40,"./router":41}],2:[function(t,e,i){"use strict";var n=this&&this.__extends||function(){var n=function(t,e){n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return n(t,e)};return function(t,e){n(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}();Object.defineProperty(i,"__esModule",{value:true});i.AbsorbPointer=void 0;var o=t("../../env");var r=t("../component_view");var s=function(e){n(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.elementType=function(){if(o.MPEnv.platformType==o.PlatformType.wxMiniProgram){return"catchclick"}else{return"div"}};t.prototype.setAttributes=function(t){e.prototype.setAttributes.call(this,t);this.htmlElement.onclick=function(t){if(t)t.stopPropagation()}};return t}(r.ComponentView);i.AbsorbPointer=s},{"../../env":36,"../component_view":24}],3:[function(t,e,i){"use strict";var n=this&&this.__extends||function(){var n=function(t,e){n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return n(t,e)};return function(t,e){n(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}();Object.defineProperty(i,"__esModule",{value:true});i.ClipOval=void 0;var o=t("../component_view");var r=t("../dom_utils");var s=function(e){n(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.setAttributes=function(t){e.prototype.setAttributes.call(this,t);r.setDOMStyle(this.htmlElement,{borderRadius:"50%",overflow:"hidden"})};return t}(o.ComponentView);i.ClipOval=s},{"../component_view":24,"../dom_utils":25}],4:[function(t,e,i){"use strict";var n=this&&this.__extends||function(){var n=function(t,e){n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return n(t,e)};return function(t,e){n(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}();Object.defineProperty(i,"__esModule",{value:true});i.ClipRRect=void 0;var o=t("../component_view");var l=t("../dom_utils");var u=t("../utils");var r=function(a){n(t,a);function t(){return a!==null&&a.apply(this,arguments)||this}t.prototype.setAttributes=function(t){var e,i,n,o,r;a.prototype.setAttributes.call(this,t);var s=t.borderRadius?u.cssBorderRadius(t.borderRadius):{};if(s.borderRadius){l.setDOMStyle(this.htmlElement,{borderRadius:(e=s.borderRadius)!==null&&e!==void 0?e:"unset",overflow:"hidden"})}else{l.setDOMStyle(this.htmlElement,{borderTopLeftRadius:(i=s.borderTopLeftRadius)!==null&&i!==void 0?i:"unset",borderTopRightRadius:(n=s.borderTopRightRadius)!==null&&n!==void 0?n:"unset",borderBottomLeftRadius:(o=s.borderBottomLeftRadius)!==null&&o!==void 0?o:"unset",borderBottomRightRadius:(r=s.borderBottomRightRadius)!==null&&r!==void 0?r:"unset",overflow:"hidden"})}};return t}(o.ComponentView);i.ClipRRect=r},{"../component_view":24,"../dom_utils":25,"../utils":31}],5:[function(t,e,i){"use strict";var n=this&&this.__extends||function(){var n=function(t,e){n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return n(t,e)};return function(t,e){n(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}();Object.defineProperty(i,"__esModule",{value:true});i.CollectionViewLayout=i.CollectionView=void 0;var o=t("../component_view");var r=t("../dom_utils");var s=function(i){n(t,i);function t(t){var e=i.call(this,t)||this;e.wrapperHtmlElement=e.document.createElement("div");e.viewWidth=0;e.viewHeight=0;e.htmlElement.appendChild(e.wrapperHtmlElement);return e}t.prototype.setConstraints=function(t){i.prototype.setConstraints.call(this,t);if(this.viewWidth!==t.w||this.viewHeight!==t.h){this.viewWidth=t.w;this.viewHeight=t.h;this.reloadLayouts()}};t.prototype.reloadLayouts=function(){this.layout.prepareLayout();for(var t=0;t<this.subviews.length;t++){var e=this.subviews[t];var i=this.layout.layoutAttributesForItemAtIndex(t);r.setDOMStyle(e.htmlElement,{position:"absolute",top:i.y+"px",left:i.x+"px",width:i.width+"px",height:i.height+"px"})}var n=this.layout.collectionViewContentSize();r.setDOMStyle(this.wrapperHtmlElement,{position:"absolute",top:"0px",left:"0px",width:n.width+"px",height:n.height+"px"})};t.prototype.setAttributes=function(t){i.prototype.setAttributes.call(this,t);r.setDOMStyle(this.htmlElement,{overflow:t.isRoot?"unset":"scroll"})};t.prototype.addSubview=function(t){this.subviews.push(t);this.wrapperHtmlElement.appendChild(t.htmlElement)};return t}(o.ComponentView);i.CollectionView=s;var a=function(){function t(t){this.collectionView=t}t.prototype.prepareLayout=function(){};t.prototype.layoutAttributesForItemAtIndex=function(t){throw""};t.prototype.collectionViewContentSize=function(){throw""};return t}();i.CollectionViewLayout=a},{"../component_view":24,"../dom_utils":25}],6:[function(t,e,i){"use strict";var n=this&&this.__extends||function(){var n=function(t,e){n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return n(t,e)};return function(t,e){n(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}();Object.defineProperty(i,"__esModule",{value:true});i.ColoredBox=void 0;var o=t("../component_view");var r=t("../dom_utils");var s=t("../utils");var a=function(e){n(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.setAttributes=function(t){e.prototype.setAttributes.call(this,t);r.setDOMStyle(this.htmlElement,{backgroundColor:t.color?s.cssColor(t.color):"unset"})};return t}(o.ComponentView);i.ColoredBox=a},{"../component_view":24,"../dom_utils":25,"../utils":31}],7:[function(t,e,i){"use strict";var n=this&&this.__extends||function(){var n=function(t,e){n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return n(t,e)};return function(t,e){n(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}();var a=this&&this.__awaiter||function(t,s,i,a){function l(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(e,i){function n(t){try{r(a.next(t))}catch(t){i(t)}}function o(t){try{r(a["throw"](t))}catch(t){i(t)}}function r(t){t.done?e(t.value):l(t.value).then(n,o)}r((a=a.apply(t,s||[])).next())})};var l=this&&this.__generator||function(t,i){var n={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},o,r,s,e;return e={next:a(0),throw:a(1),return:a(2)},typeof Symbol==="function"&&(e[Symbol.iterator]=function(){return this}),e;function a(e){return function(t){return l([e,t])}}function l(e){if(o)throw new TypeError("Generator is already executing.");while(n)try{if(o=1,r&&(s=e[0]&2?r["return"]:e[0]?r["throw"]||((s=r["return"])&&s.call(r),0):r.next)&&!(s=s.call(r,e[1])).done)return s;if(r=0,s)e=[e[0]&2,s.value];switch(e[0]){case 0:case 1:s=e;break;case 4:n.label++;return{value:e[1],done:false};case 5:n.label++;r=e[1];e=[0];continue;case 7:e=n.ops.pop();n.trys.pop();continue;default:if(!(s=n.trys,s=s.length>0&&s[s.length-1])&&(e[0]===6||e[0]===2)){n=0;continue}if(e[0]===3&&(!s||e[1]>s[0]&&e[1]<s[3])){n.label=e[1];break}if(e[0]===6&&n.label<s[1]){n.label=s[1];s=e;break}if(s&&n.label<s[2]){n.label=s[2];n.ops.push(e);break}if(s[2])n.ops.pop();n.trys.pop();continue}e=i.call(t,n)}catch(t){e=[6,t];r=0}finally{o=s=0}if(e[0]&5)throw e[1];return{value:e[0]?e[1]:void 0,done:true}}};Object.defineProperty(i,"__esModule",{value:true});i.CustomPaint=i.MPDrawable=void 0;var u=t("../../env");var o=t("../component_view");var r=t("../dom_utils");var c=t("../utils");var s=function(){function s(t){this.engine=t;this.decodedDrawables={}}s.prototype.decodeDrawable=function(n){return a(this,void 0,void 0,function(){var e,e,i;return l(this,function(t){switch(t.label){case 0:if(u.MPEnv.platformType===u.PlatformType.wxMiniProgram){if(!s.offscreenCanvas){s.offscreenCanvas=wx.createOffscreenCanvas()}}t.label=1;case 1:t.trys.push([1,7,,8]);if(!(n.type==="networkImage"))return[3,3];return[4,this.decodeNetworkImage(n.url,n.target)];case 2:e=t.sent();this.engine.sendMessage(JSON.stringify({type:"decode_drawable",message:{event:"onDecode",target:n.target,width:e.width,height:e.height}}));return[3,6];case 3:if(!(n.type==="memoryImage"))return[3,5];return[4,this.decodeMemoryImage(n.data,n.target)];case 4:e=t.sent();this.engine.sendMessage(JSON.stringify({type:"decode_drawable",message:{event:"onDecode",target:n.target,width:e.width,height:e.height}}));return[3,6];case 5:throw new Error("Unknown drawable type.");case 6:return[3,8];case 7:i=t.sent();this.engine.sendMessage(JSON.stringify({type:"decode_drawable",message:{event:"onError",target:n.target,error:i===null||i===void 0?void 0:i.toString()}}));return[3,8];case 8:return[2]}})})};s.prototype.decodeNetworkImage=function(o,r){return a(this,void 0,void 0,function(){var n=this;return l(this,function(t){return[2,new Promise(function(t,e){var i=function(){if(u.MPEnv.platformType===u.PlatformType.wxMiniProgram){return s.offscreenCanvas.createImage()}return document.createElement("img")}();i.onload=function(){n.decodedDrawables[r]=i;t({width:i.width,height:i.height})};i.onerror=function(){e("")};i.src=o})]})})};s.prototype.decodeMemoryImage=function(o,r){return a(this,void 0,void 0,function(){var n=this;return l(this,function(t){return[2,new Promise(function(t,e){var i=function(){if(u.MPEnv.platformType===u.PlatformType.wxMiniProgram){return s.offscreenCanvas.createImage()}return document.createElement("img")}();i.onload=function(){n.decodedDrawables[r]=i;t({width:i.width,height:i.height})};i.onerror=function(){e("")};i.src="data:text/plain;base64,"+o})]})})};return s}();i.MPDrawable=s;var d=function(s){n(t,s);function t(){var t=s!==null&&s.apply(this,arguments)||this;t.canvasWidth=0;t.canvasHeight=0;return t}t.prototype.elementType=function(){return"canvas"};t.prototype.setConstraints=function(t){if(!t)return;var e=t.x;var i=t.y;var n=t.w;var o=t.h;if(typeof e==="number"&&typeof i==="number"&&typeof n==="number"&&typeof o==="number"){r.setDOMStyle(this.htmlElement,{left:e+"px",top:i+"px",width:n+"px",height:o+"px"});if(this.canvasWidth!==n||this.canvasHeight!=o){this.canvasWidth=n;this.canvasHeight=o;r.setDOMAttribute(this.htmlElement,"width",this.canvasWidth.toString());r.setDOMAttribute(this.htmlElement,"height",this.canvasHeight.toString())}}};t.prototype.createContext=function(){return a(this,void 0,void 0,function(){var e=this;return l(this,function(t){if(u.MPEnv.platformType===u.PlatformType.wxMiniProgram){return[2,new Promise(function(r){setTimeout(function(){return a(e,void 0,void 0,function(){var e,i,n,o;return l(this,function(t){switch(t.label){case 0:return[4,this.htmlElement.getFields({node:true,size:true})];case 1:e=t.sent();i=e.node;n=i.getContext("2d");o=wx.getSystemInfoSync().pixelRatio;i.width=e.width*o;i.height=e.height*o;n.scale(o,o);r(n);return[2]}})})},16)})]}else{return[2,this.htmlElement.getContext("2d")]}return[2]})})};t.prototype.setAttributes=function(o){var r;return a(this,void 0,void 0,function(){var e,i;var n=this;return l(this,function(t){switch(t.label){case 0:s.prototype.setAttributes.call(this,o);if(!((r=this.ctx)!==null&&r!==void 0))return[3,1];i=r;return[3,3];case 1:return[4,this.createContext()];case 2:i=t.sent();t.label=3;case 3:e=i;if(!e)return[2];if(!this.ctx){this.ctx=e}e.save();o.commands.forEach(function(t){if(t.action==="drawRect"){n.drawRect(e,t)}else if(t.action==="drawPath"){n.drawPath(e,t)}else if(t.action==="drawDRRect"){n.drawDRRect(e,t)}else if(t.action==="clipPath"){n.drawPath(e,t)}else if(t.action==="drawColor"){n.drawColor(e,t)}else if(t.action==="drawImage"){n.drawImage(e,t)}else if(t.action==="drawImageRect"){n.drawImageRect(e,t)}else if(t.action==="restore"){e.restore()}else if(t.action==="rotate"){e.rotate(t.radians)}else if(t.action==="save"){e.save()}else if(t.action==="scale"){e.scale(t.sx,t.sy)}else if(t.action==="skew"){e.transform(1,t.sy,t.sx,1,0,0)}else if(t.action==="transform"){e.transform(t.a,t.b,t.c,t.d,t.tx,t.ty)}else if(t.action==="translate"){e.translate(t.dx,t.dy)}});e.restore();return[2]}})})};t.prototype.drawRect=function(t,e){this.setPaint(t,e.paint);if(e.paint.style==="PaintingStyle.fill"){t.fillRect(e.x,e.y,e.width,e.height)}else{t.strokeRect(e.x,e.y,e.width,e.height)}};t.prototype.drawPath=function(t,e){this.setPaint(t,e.paint);this.drawRealPath(t,e.path);if(e.action==="clipPath"){t.clip()}else if(e.paint.style==="PaintingStyle.fill"){t.fill()}else{t.stroke()}};t.prototype.drawDRRect=function(t,e){var i=document.createElement("canvas");i.width=t.canvas.width;i.height=t.canvas.height;var n=i.getContext("2d");this.setPaint(n,e.paint);this.drawRealPath(n,e.outer);if(e.paint.style==="PaintingStyle.fill"){n.fill()}else{n.stroke()}n.save();n.fillStyle="white";n.globalCompositeOperation="xor";this.drawRealPath(n,e.inner);n.fill();n.restore();t.drawImage(i,0,0)};t.prototype.drawRealPath=function(e,t){e.beginPath();t.commands.forEach(function(t){if(t.action==="moveTo"){e.moveTo(t.x,t.y)}else if(t.action==="lineTo"){e.lineTo(t.x,t.y)}else if(t.action==="quadraticBezierTo"){e.quadraticCurveTo(t.x1,t.y1,t.x2,t.y2)}else if(t.action==="cubicTo"){e.bezierCurveTo(t.x1,t.y1,t.x2,t.y2,t.x3,t.y3)}else if(t.action==="arcTo"){e.ellipse(t.x,t.y,t.width/2,t.height/2,0,t.startAngle,t.startAngle+t.sweepAngle,t.sweepAngle<0)}else if(t.action==="arcToPoint"){e.arcTo(t.arcControlX,t.arcControlY,t.arcEndX,t.arcEndY,t.radiusX)}else if(t.action==="close"){e.closePath()}})};t.prototype.drawColor=function(t,e){if(e.blendMode==="BlendMode.clear"){t.clearRect(0,0,t.canvas.width,t.canvas.height)}else{t.fillStyle=c.cssColor(e.color);t.fillRect(0,0,t.canvas.width,t.canvas.height)}};t.prototype.drawImage=function(t,e){this.setPaint(t,e.paint);var i=this.engine.drawable.decodedDrawables[e.drawable];if(i){t.drawImage(i,e.dx,e.dy)}};t.prototype.drawImageRect=function(t,e){this.setPaint(t,e.paint);var i=this.engine.drawable.decodedDrawables[e.drawable];if(i){t.drawImage(i,e.srcX,e.srcY,e.srcW,e.srcH,e.dstX,e.dstY,e.dstW,e.dstH)}};t.prototype.setPaint=function(t,e){var i;if(!e)return;t.lineWidth=e.strokeWidth;t.miterLimit=e.strokeMiterLimit;t.lineCap=e.strokeCap.replace("StrokeCap.","");t.lineJoin=e.strokeJoin.replace("StrokeJoin.","");if(e.style==="PaintingStyle.fill"){t.fillStyle=c.cssColor(e.color);t.strokeStyle="transparent"}else{t.fillStyle="transparent";t.strokeStyle=c.cssColor(e.color)}t.globalAlpha=(i=e.alpha)!==null&&i!==void 0?i:1};return t}(o.ComponentView);i.CustomPaint=d},{"../../env":36,"../component_view":24,"../dom_utils":25,"../utils":31}],8:[function(t,e,i){"use strict";var n=this&&this.__extends||function(){var n=function(t,e){n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return n(t,e)};return function(t,e){n(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}();var b=this&&this.__assign||function(){b=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++){e=arguments[i];for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o))t[o]=e[o]}return t};return b.apply(this,arguments)};Object.defineProperty(i,"__esModule",{value:true});i.CustomScrollView=void 0;var _=t("../utils");var o=t("./collection_view");var x=t("./grid_list_layout");var r=function(i){n(t,i);function t(t){var e=i.call(this,t)||this;e.listChildren=[];e.layout=new s(e);return e}t.prototype.setChildren=function(t){var c=this;if(!t)return;var d=[];var p={};var f={};t.forEach(function(t,e){var i,n,o,r,s,a,l,u;if(t.name==="sliver_list"&&t.children){p[d.length]=t.attributes;c.factory.fetchCachedChildren(t.children).forEach(function(t){d.push(t)});f[d.length-1]=true}else if(((n=(i=t.children)===null||i===void 0?void 0:i[0])===null||n===void 0?void 0:n.name)==="sliver_list"&&((r=(o=t.children)===null||o===void 0?void 0:o[0])===null||r===void 0?void 0:r.children)){p[d.length]=t.children[0].attributes;c.factory.fetchCachedChildren(t.children[0].children).forEach(function(t,e){d.push(t)});f[d.length-1]=true}else if(t.name==="sliver_grid"&&t.children){p[d.length]=t.attributes;c.factory.fetchCachedChildren(t.children).forEach(function(t){d.push(t)});f[d.length-1]=true}else if(((a=(s=t.children)===null||s===void 0?void 0:s[0])===null||a===void 0?void 0:a.name)==="sliver_grid"&&((u=(l=t.children)===null||l===void 0?void 0:l[0])===null||u===void 0?void 0:u.children)){p[d.length]=t.children[0].attributes;c.factory.fetchCachedChildren(t.children[0].children).forEach(function(t){d.push(t)});f[d.length-1]=true}else{d.push(t)}c.factory.create(t,c.document)});this.listChildren=d;this.layout.items=d;this.layout.sliverGridAttributes=p;this.layout.sliverGridEndIndex=f;i.prototype.setChildren.call(this,d);this.reloadLayouts()};t.prototype.setAttributes=function(t){i.prototype.setAttributes.call(this,t);this.layout.isHorizontalScroll=t.scrollDirection==="Axis.horizontal"};return t}(o.CollectionView);i.CustomScrollView=r;var s=function(e){n(t,e);function t(){var t=e!==null&&e.apply(this,arguments)||this;t.isHorizontalScroll=false;t.items=[];t.maxVLength=0;t.itemLayouts=[];t.sliverGridAttributes={};t.sliverGridEndIndex={};return t}t.prototype.prepareLayout=function(){var f=this;var h=this.collectionView.viewWidth;var v=this.collectionView.viewHeight;if(h<=.01||v<=.01){return}var y=[];var m=0;var g;var w=0;this.items.forEach(function(t,e){var i,n,o,r;{if(f.sliverGridAttributes[e]){w=0;g=new x.GridListLayout(f.collectionView);g.isHorizontalScroll=f.isHorizontalScroll;var s=[];for(var a=e;a<f.items.length;a++){s.push(f.items[a]);if(f.sliverGridEndIndex[a])break}g.clientWidth=f.collectionView.viewWidth;g.clientHeight=f.collectionView.viewHeight;var l=f.sliverGridAttributes[e].gridDelegate;if(l){g.isPlain=l.classname!=="SliverWaterfallDelegate";g.crossAxisCount=l.crossAxisCount;g.mainAxisSpacing=l.mainAxisSpacing;g.crossAxisSpacing=l.crossAxisSpacing}if(f.sliverGridAttributes[e].padding){var u=_.cssPadding(f.sliverGridAttributes[e].padding);g.padding.top=parseFloat((i=u.paddingTop)!==null&&i!==void 0?i:"0.0");g.padding.left=parseFloat((n=u.paddingLeft)!==null&&n!==void 0?n:"0.0");g.padding.bottom=parseFloat((o=u.paddingBottom)!==null&&o!==void 0?o:"0.0");g.padding.right=parseFloat((r=u.paddingRight)!==null&&r!==void 0?r:"0.0")}g.items=s;g.prepareLayout()}if(g){if(w<g.itemLayouts.length){var c=b({},g.itemLayouts[w]);if(f.isHorizontalScroll){c.x+=m}else{c.y+=m}y.push(c)}else{y.push({x:0,y:0,width:0,height:0})}w++}if(f.sliverGridEndIndex[e]&&g){if(f.isHorizontalScroll){m+=g.collectionViewContentSize().width}else{m+=g.collectionViewContentSize().height}f.maxVLength=m;g=undefined;return}if(g){return}}var d=_.cssSizeFromMPElement(t);var p;if(f.isHorizontalScroll){p={x:m,y:0,width:d.width,height:v};m+=d.width}else{p={x:0,y:m,width:h,height:d.height};m+=d.height}f.maxVLength=m;y.push(p)});this.itemLayouts=y};t.prototype.collectionViewContentSize=function(){if(this.isHorizontalScroll){return{width:this.maxVLength,height:this.collectionView.viewHeight}}else{return{width:this.collectionView.viewWidth,height:this.maxVLength}}};t.prototype.layoutAttributesForItemAtIndex=function(t){return this.itemLayouts[t]};return t}(o.CollectionViewLayout)},{"../utils":31,"./collection_view":5,"./grid_list_layout":11}],9:[function(t,e,i){"use strict";var n=this&&this.__extends||function(){var n=function(t,e){n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return n(t,e)};return function(t,e){n(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}();Object.defineProperty(i,"__esModule",{value:true});i.DecoratedBox=void 0;var o=t("../component_view");var y=t("../dom_utils");var m=t("../utils");var r=function(v){n(t,v);function t(){return v!==null&&v.apply(this,arguments)||this}t.prototype.setAttributes=function(e){var i=this;var t,n,o,r,s,a,l,u,c;v.prototype.setAttributes.call(this,e);var d={};if(e.color){d.backgroundColor=m.cssColor(e.color)}else{d.backgroundColor="unset"}if(e.image){d.backgroundImage='url("'+function(){if(e.image.src){return e.image.src}else if(e.image.assetName){if(i.engine.debugger){var t=function(){if(e.assetPkg){return"http://"+i.engine.debugger.serverAddr+"/assets/packages/"+e.assetPkg+"/"+e.assetName}else{return"http://"+i.engine.debugger.serverAddr+"/assets/"+e.assetName}}();i.htmlElement.src=t}}}()+'")';if(e.image.fit==="BoxFit.cover"){d.backgroundSize="cover"}else{d.backgroundSize="contain"}}if((t=e.decoration)===null||t===void 0?void 0:t.gradient){if(d.backgroundImage){d.backgroundImage=m.cssGradient(e.decoration.gradient)+","+d.backgroundImage}else{d.background=m.cssGradient(e.decoration.gradient)}}if((o=(n=e.decoration)===null||n===void 0?void 0:n.boxShadow)===null||o===void 0?void 0:o[0]){var p=(s=(r=e.decoration)===null||r===void 0?void 0:r.boxShadow)===null||s===void 0?void 0:s[0];d.boxShadow=((a=m.cssOffset(p.offset))===null||a===void 0?void 0:a.dx)+"px "+((l=m.cssOffset(p.offset))===null||l===void 0?void 0:l.dy)+"px "+p.blurRadius+"px "+p.spreadRadius+"px "+m.cssColor(p.color)}if((u=e.decoration)===null||u===void 0?void 0:u.borderRadius){var f=m.cssBorderRadius(e.decoration.borderRadius);for(var h in f){d[h]=f[h]}}if((c=e.decoration)===null||c===void 0?void 0:c.border){var f=m.cssBorder(e.decoration.border);f.boxSizing="border-box";for(var h in f){d[h]=f[h]}}y.setDOMStyle(this.htmlElement,d)};return t}(o.ComponentView);i.DecoratedBox=r},{"../component_view":24,"../dom_utils":25,"../utils":31}],10:[function(t,e,i){"use strict";var n=this&&this.__extends||function(){var n=function(t,e){n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return n(t,e)};return function(t,e){n(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}();Object.defineProperty(i,"__esModule",{value:true});i.GestureDetector=void 0;var o=t("../component_view");var r=t("../dom_utils");var s=function(i){n(t,i);function t(){return i!==null&&i.apply(this,arguments)||this}t.prototype.setConstraints=function(t){if(!t)return;this.constraints=t;var e=t.x;var i=t.y;var n=t.w;var o=t.h;if(typeof e==="number"&&typeof i==="number"&&typeof n==="number"&&typeof o==="number"){r.setDOMStyle(this.htmlElement,{left:"0px",top:"0px",width:"0px",height:"0px"})}};t.prototype.setAttributes=function(t){var e=this;i.prototype.setAttributes.call(this,t);this.htmlElement.onclick=function(){e.engine.sendMessage(JSON.stringify({type:"gesture_detector",message:{event:"onTap",target:t.onTap}}))}};return t}(o.ComponentView);i.GestureDetector=s},{"../component_view":24,"../dom_utils":25}],11:[function(t,e,i){"use strict";var n=this&&this.__extends||function(){var n=function(t,e){n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return n(t,e)};return function(t,e){n(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}();Object.defineProperty(i,"__esModule",{value:true});i.GridListLayout=void 0;var y=t("../utils");var o=t("./collection_view");var r=function(e){n(t,e);function t(){var t=e!==null&&e.apply(this,arguments)||this;t.isPlain=true;t.isHorizontalScroll=false;t.padding={top:0,left:0,bottom:0,right:0};t.clientWidth=0;t.clientHeight=0;t.crossAxisCount=0;t.crossAxisSpacing=0;t.mainAxisSpacing=0;t.items=[];t.maxVLength=0;t.itemLayouts=[];return t}t.prototype.prepareLayout=function(){if(this.isPlain){this.preparePlainLayout()}else{this.prepareWaterfallLayout()}};t.prototype.preparePlainLayout=function(){var s=this;var a=(this.clientWidth>0?this.clientWidth:this.collectionView.viewWidth)-this.padding.right;var l=(this.clientHeight>0?this.clientHeight:this.collectionView.viewHeight)-this.padding.bottom;var u=[];var c=this.padding.left;var d=this.padding.top;var p=0;this.items.forEach(function(t,e){var i=y.cssSizeFromMPElement(t);var n=i.width;var o=i.height;if(s.isHorizontalScroll){var r={x:c,y:d,width:n,height:o};d+=o+s.crossAxisSpacing;p=Math.max(c+n,p);if(d+o-l>.1){d=s.padding.top;if(e+1<s.items.length){c+=n+s.mainAxisSpacing}}u.push(r)}else{var r={x:c,y:d,width:n,height:o};c+=n+s.crossAxisSpacing;p=Math.max(d+o,p);if(c+n-a>.1){c=s.padding.left;if(e+1<s.items.length){d+=o+s.mainAxisSpacing}}u.push(r)}});if(this.isHorizontalScroll){p+=this.padding.right}else{p+=this.padding.bottom}this.itemLayouts=u;this.maxVLength=p};t.prototype.prepareWaterfallLayout=function(){var d=this;if(this.crossAxisCount<=0){this.itemLayouts=[];return}var p=0;var f={};var h=[];var v=0;this.items.forEach(function(t,e){var i=y.cssSizeFromMPElement(t);var n=i.width;var o=i.height;var r=d.isHorizontalScroll?d.padding.left:d.padding.top;{var s=p;var a=s+1>=d.crossAxisCount?0:s+1;if(f[s]&&f[a]){var l=f[s];var u=f[a];if(d.isHorizontalScroll){if(u.x+u.width<l.x+l.width){p=a}else{p=s}}else{if(u.y+u.height<l.y+l.height){p=a}else{p=s}}}else{p=s}}if(f[p]){var l=f[p];if(d.isHorizontalScroll){r=l.x+l.width;if(e>=d.crossAxisCount){r+=d.mainAxisSpacing}}else{r=l.y+l.height;if(e>=d.crossAxisCount){r+=d.mainAxisSpacing}}}else{r=d.isHorizontalScroll?d.padding.left:d.padding.top}if(d.isHorizontalScroll){var c={x:r,y:d.padding.top+o*p+p*d.crossAxisSpacing,width:n,height:o};f[p]=c;p=(p+1)%d.crossAxisCount;v=Math.max(r+n,v);h.push(c)}else{var c={x:d.padding.left+n*p+p*d.crossAxisSpacing,y:r,width:n,height:o};f[p]=c;p=(p+1)%d.crossAxisCount;v=Math.max(r+o,v);h.push(c)}});if(this.isHorizontalScroll){v+=this.padding.right}else{v+=this.padding.bottom}this.itemLayouts=h;this.maxVLength=v};t.prototype.collectionViewContentSize=function(){if(this.isHorizontalScroll){return{width:this.maxVLength,height:this.collectionView.viewHeight-this.padding.top-this.padding.bottom}}else{return{width:this.collectionView.viewWidth-this.padding.left-this.padding.right,height:this.maxVLength}}};t.prototype.layoutAttributesForItemAtIndex=function(t){return this.itemLayouts[t]};return t}(o.CollectionViewLayout);i.GridListLayout=r},{"../utils":31,"./collection_view":5}],12:[function(t,e,i){"use strict";var n=this&&this.__extends||function(){var n=function(t,e){n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return n(t,e)};return function(t,e){n(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}();Object.defineProperty(i,"__esModule",{value:true});i.GridView=void 0;var l=t("../utils");var o=t("./collection_view");var r=t("./grid_list_layout");var s=function(a){n(t,a);function t(t){var e=a.call(this,t)||this;e.listChildren=[];e.layout=new r.GridListLayout(e);return e}t.prototype.setChildren=function(t){var e=this;a.prototype.setChildren.call(this,t);if(!t)return;var i=[];this.factory.fetchCachedChildren(t).forEach(function(t){i.push(t);e.factory.create(t,e.document)});this.layout.items=i;this.listChildren=i;this.reloadLayouts()};t.prototype.setAttributes=function(t){var e,i,n,o;a.prototype.setAttributes.call(this,t);this.layout.isHorizontalScroll=t.scrollDirection==="Axis.horizontal";var r=t.gridDelegate;if(r){this.layout.isPlain=r.classname!=="SliverWaterfallDelegate";this.layout.crossAxisCount=r.crossAxisCount;this.layout.mainAxisSpacing=r.mainAxisSpacing;this.layout.crossAxisSpacing=r.crossAxisSpacing}if(t.padding){var s=l.cssPadding(this.attributes.padding);this.layout.padding.top=parseFloat((e=s.paddingTop)!==null&&e!==void 0?e:"0.0");this.layout.padding.left=parseFloat((i=s.paddingLeft)!==null&&i!==void 0?i:"0.0");this.layout.padding.bottom=parseFloat((n=s.paddingBottom)!==null&&n!==void 0?n:"0.0");this.layout.padding.right=parseFloat((o=s.paddingRight)!==null&&o!==void 0?o:"0.0")}this.reloadLayouts()};return t}(o.CollectionView);i.GridView=s},{"../utils":31,"./collection_view":5,"./grid_list_layout":11}],13:[function(t,e,i){"use strict";var n=this&&this.__extends||function(){var n=function(t,e){n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return n(t,e)};return function(t,e){n(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}();Object.defineProperty(i,"__esModule",{value:true});i.IgnorePointer=void 0;var o=t("../component_view");var r=t("../dom_utils");var s=function(e){n(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.setAttributes=function(t){e.prototype.setAttributes.call(this,t);r.setDOMStyle(this.htmlElement,{pointerEvents:"none"})};return t}(o.ComponentView);i.IgnorePointer=s},{"../component_view":24,"../dom_utils":25}],14:[function(t,e,i){"use strict";var o=this&&this.__extends||function(){var n=function(t,e){n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return n(t,e)};return function(t,e){n(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}();Object.defineProperty(i,"__esModule",{value:true});i.Image=void 0;var n=t("../component_view");var r=t("../dom_utils");var s=function(n){o(t,n);function t(){return n!==null&&n.apply(this,arguments)||this}t.prototype.elementType=function(){return"img"};t.prototype.setAttributes=function(t){var e=this;n.prototype.setAttributes.call(this,t);r.setDOMStyle(this.htmlElement,{objectFit:function(){if(!t.fit)return"cover";switch(t.fit){case"BoxFit.fill":return"fill";case"BoxFit.contain":return"contain";case"BoxFit.cover":return"cover";case"BoxFit.fitWidth":return"scale-down";case"BoxFit.fitHeight":return"scale-down";case"BoxFit.none":return"none";default:return"contain"}}()});if(t.src){r.setDOMAttribute(this.htmlElement,"src",t.src)}else if(t.assetName){if(this.engine.debugger){var i=function(){if(t.assetPkg){return"http://"+e.engine.debugger.serverAddr+"/assets/packages/"+t.assetPkg+"/"+t.assetName}else{return"http://"+e.engine.debugger.serverAddr+"/assets/"+t.assetName}}();r.setDOMAttribute(this.htmlElement,"src",i)}else{var i=function(){if(t.assetPkg){return"assets/packages/"+t.assetPkg+"/"+t.assetName}else{return"assets/"+t.assetName}}();r.setDOMAttribute(this.htmlElement,"src",i)}}};return t}(n.ComponentView);i.Image=s},{"../component_view":24,"../dom_utils":25}],15:[function(t,e,i){"use strict";var n=this&&this.__extends||function(){var n=function(t,e){n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return n(t,e)};return function(t,e){n(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}();Object.defineProperty(i,"__esModule",{value:true});i.ListView=void 0;var a=t("../utils");var o=t("./collection_view");var r=t("./grid_list_layout");var s=function(s){n(t,s);function t(t){var e=s.call(this,t)||this;e.listChildren=[];e.layout=new r.GridListLayout(e);return e}t.prototype.setChildren=function(t){var e=this;s.prototype.setChildren.call(this,t);if(!t)return;var i=[];this.factory.fetchCachedChildren(t).forEach(function(t){i.push(t);e.factory.create(t,e.document)});this.layout.items=i;this.listChildren=i;this.reloadLayouts()};t.prototype.setAttributes=function(t){var e,i,n,o;s.prototype.setAttributes.call(this,t);this.layout.isHorizontalScroll=t.scrollDirection==="Axis.horizontal";if(t.padding){var r=a.cssPadding(this.attributes.padding);this.layout.padding.top=parseFloat((e=r.paddingTop)!==null&&e!==void 0?e:"0.0");this.layout.padding.left=parseFloat((i=r.paddingLeft)!==null&&i!==void 0?i:"0.0");this.layout.padding.bottom=parseFloat((n=r.paddingBottom)!==null&&n!==void 0?n:"0.0");this.layout.padding.right=parseFloat((o=r.paddingRight)!==null&&o!==void 0?o:"0.0")}this.reloadLayouts()};return t}(o.CollectionView);i.ListView=s},{"../utils":31,"./collection_view":5,"./grid_list_layout":11}],16:[function(t,e,i){"use strict";var n=this&&this.__extends||function(){var n=function(t,e){n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return n(t,e)};return function(t,e){n(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}();Object.defineProperty(i,"__esModule",{value:true});i.Offstage=void 0;var o=t("../component_view");var r=t("../dom_utils");var s=function(e){n(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.setAttributes=function(t){e.prototype.setAttributes.call(this,t);r.setDOMStyle(this.htmlElement,{display:t.offstage?"none":"unset"})};return t}(o.ComponentView);i.Offstage=s},{"../component_view":24,"../dom_utils":25}],17:[function(t,e,i){"use strict";var n=this&&this.__extends||function(){var n=function(t,e){n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return n(t,e)};return function(t,e){n(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}();Object.defineProperty(i,"__esModule",{value:true});i.Opacity=void 0;var o=t("../component_view");var r=t("../dom_utils");var s=function(e){n(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.setAttributes=function(t){e.prototype.setAttributes.call(this,t);r.setDOMStyle(this.htmlElement,{opacity:t.opacity.toString()})};return t}(o.ComponentView);i.Opacity=s},{"../component_view":24,"../dom_utils":25}],18:[function(t,e,i){"use strict";var n=this&&this.__extends||function(){var n=function(t,e){n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return n(t,e)};return function(t,e){n(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}();Object.defineProperty(i,"__esModule",{value:true});i.Overlay=void 0;var o=t("../../env");var r=t("../component_view");var s=t("../dom_utils");var a=function(i){n(t,i);function t(){return i!==null&&i.apply(this,arguments)||this}t.prototype.elementType=function(){if(o.MPEnv.platformType==o.PlatformType.wxMiniProgram){return"catchmove"}else{return"div"}};t.prototype.setAttributes=function(t){var e=this;i.prototype.setAttributes.call(this,t);if(o.MPEnv.platformType==o.PlatformType.wxMiniProgram){}else{this.htmlElement.addEventListener("touchmove",function(t){t.preventDefault()})}this.additionalConstraints={position:"fixed"};s.setDOMStyle(this.htmlElement,{position:"fixed"});if(t.onBackgroundTap){this.htmlElement.onclick=function(){e.engine.sendMessage(JSON.stringify({type:"overlay",message:{event:"onBackgroundTap",target:t.onBackgroundTap}}))}}else{this.htmlElement.onclick=null}};return t}(r.ComponentView);i.Overlay=a},{"../../env":36,"../component_view":24,"../dom_utils":25}],19:[function(t,e,i){"use strict";var n=this&&this.__extends||function(){var n=function(t,e){n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return n(t,e)};return function(t,e){n(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}();var a=this&&this.__awaiter||function(t,s,i,a){function l(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(e,i){function n(t){try{r(a.next(t))}catch(t){i(t)}}function o(t){try{r(a["throw"](t))}catch(t){i(t)}}function r(t){t.done?e(t.value):l(t.value).then(n,o)}r((a=a.apply(t,s||[])).next())})};var l=this&&this.__generator||function(t,i){var n={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},o,r,s,e;return e={next:a(0),throw:a(1),return:a(2)},typeof Symbol==="function"&&(e[Symbol.iterator]=function(){return this}),e;function a(e){return function(t){return l([e,t])}}function l(e){if(o)throw new TypeError("Generator is already executing.");while(n)try{if(o=1,r&&(s=e[0]&2?r["return"]:e[0]?r["throw"]||((s=r["return"])&&s.call(r),0):r.next)&&!(s=s.call(r,e[1])).done)return s;if(r=0,s)e=[e[0]&2,s.value];switch(e[0]){case 0:case 1:s=e;break;case 4:n.label++;return{value:e[1],done:false};case 5:n.label++;r=e[1];e=[0];continue;case 7:e=n.ops.pop();n.trys.pop();continue;default:if(!(s=n.trys,s=s.length>0&&s[s.length-1])&&(e[0]===6||e[0]===2)){n=0;continue}if(e[0]===3&&(!s||e[1]>s[0]&&e[1]<s[3])){n.label=e[1];break}if(e[0]===6&&n.label<s[1]){n.label=s[1];s=e;break}if(s&&n.label<s[2]){n.label=s[2];n.ops.push(e);break}if(s[2])n.ops.pop();n.trys.pop();continue}e=i.call(t,n)}catch(t){e=[6,t];r=0}finally{o=s=0}if(e[0]&5)throw e[1];return{value:e[0]?e[1]:void 0,done:true}}};Object.defineProperty(i,"__esModule",{value:true});i.WidgetSpan=i.TextSpan=i.RichText=void 0;var r=t("../../env");var o=t("../component_view");var u=t("../dom_utils");var s=t("../utils");var c=function(o){n(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}t.prototype.setAttributes=function(t){var e;o.prototype.setAttributes.call(this,t);var i=t.maxWidth;if(typeof i==="string"){this.maxWidth=parseFloat(i)}else{this.maxWidth=undefined}var n=t.maxHeight;if(typeof n==="string"){this.maxHeight=parseFloat(n)}else{this.maxHeight=undefined}u.setDOMStyle(this.htmlElement,{overflow:"hidden",textOverflow:"ellipsis",textAlign:s.cssTextAlign(t.textAlign),display:"-webkit-box",fontSize:"11px",lineHeight:(e=t.height)===null||e===void 0?void 0:e.toString(),overflowWrap:"anywhere",wordBreak:"break-all",wordWrap:"break-word",whiteSpace:"pre-line",webkitBoxOrient:"vertical",webkitLineClamp:t.maxLines?t.maxLines.toString():"99999"});this.measureId=t.measureId};t.prototype.setChildren=function(i){return a(this,void 0,void 0,function(){var e;return l(this,function(t){switch(t.label){case 0:o.prototype.setChildren.call(this,i);if(!this.measureId)return[3,2];return[4,d.measureText(this.document,this.htmlElement,this.maxWidth,this.maxHeight)];case 1:e=t.sent();this.factory.callbackTextMeasureResult(this.measureId,e);t.label=2;case 2:return[2]}})})};return t}(o.ComponentView);i.RichText=c;var d=function(){function t(){}t.measureText=function(n,o,r,s){return a(this,void 0,void 0,function(){var e,i;return l(this,function(t){switch(t.label){case 0:e=o.cloneNode(true);u.setDOMStyle(e,{position:"absolute",opacity:"0",width:r?"unset":"999999px",maxWidth:r?r+"px":"999999px",height:s?"unset":"999999px",maxHeight:s?s+"px":"999999px"});return[4,n.body.appendChild(e)];case 1:t.sent();return[4,e.getBoundingClientRect()];case 2:i=t.sent();e.remove();return[2,i]}})})};return t}();var p=function(o){n(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}t.prototype.elementType=function(){return"div"};t.prototype.setChildren=function(t){if(t instanceof Array&&t.length>0){o.prototype.setChildren.call(this,t)}};t.prototype.setAttributes=function(t){o.prototype.setAttributes.call(this,t);var e={position:"unset",display:"inline"};if(t.style){var i=s.cssTextStyle(t.style);for(var n in i){e[n]=i[n]}}if(t.text){this.htmlElement.innerText=t.text;if(r.MPEnv.platformType===r.PlatformType.wxMiniProgram){u.setDOMAttribute(this.htmlElement,"innerText",t.text)}}u.setDOMStyle(this.htmlElement,e)};return t}(o.ComponentView);i.TextSpan=p;var f=function(e){n(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.elementType=function(){return"div"};t.prototype.setChildren=function(t){e.prototype.setChildren.call(this,t);if(this.subviews[0]){this.subviews[0].additionalConstraints={position:"relative"};u.setDOMStyle(this.subviews[0].htmlElement,{position:"relative",display:"inline-flex"})}};t.prototype.setAttributes=function(t){e.prototype.setAttributes.call(this,t);u.setDOMStyle(this.htmlElement,{display:"contents"})};return t}(o.ComponentView);i.WidgetSpan=f},{"../../env":36,"../component_view":24,"../dom_utils":25,"../utils":31}],20:[function(t,e,i){"use strict";var n=this&&this.__extends||function(){var n=function(t,e){n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return n(t,e)};return function(t,e){n(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}();Object.defineProperty(i,"__esModule",{value:true});i.Transform=void 0;var o=t("../component_view");var r=t("../dom_utils");var s=function(e){n(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.setAttributes=function(t){e.prototype.setAttributes.call(this,t);r.setDOMStyle(this.htmlElement,{transform:t.transform})};return t}(o.ComponentView);i.Transform=s},{"../component_view":24,"../dom_utils":25}],21:[function(t,e,i){"use strict";var n=this&&this.__extends||function(){var n=function(t,e){n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return n(t,e)};return function(t,e){n(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}();Object.defineProperty(i,"__esModule",{value:true});i.Visibility=void 0;var o=t("../component_view");var r=t("../dom_utils");var s=function(e){n(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.setAttributes=function(t){e.prototype.setAttributes.call(this,t);r.setDOMStyle(this.htmlElement,{display:t.visible?"contents":"none"})};return t}(o.ComponentView);i.Visibility=s},{"../component_view":24,"../dom_utils":25}],22:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:true});i.WebDialogs=void 0;var n=t("../../env");var o=function(){function t(){}t.receivedWebDialogsMessage=function(t,e){if(n.MPEnv.platformType===n.PlatformType.wxMiniProgram){this.wxMiniProgramReceivedWebDialogsMessage(t,e)}else{this.browserMiniProgramReceivedWebDialogsMessage(t,e)}};t.wxMiniProgramReceivedWebDialogsMessage=function(e,i){var t;if(i["params"]["dialogType"]==="alert"){wx.showModal({content:i["params"]["message"],showCancel:false,confirmText:"确定",success:function(){e.sendMessage(JSON.stringify({type:"action",message:{event:"callback",id:i["id"]}}))}})}else if(i["params"]["dialogType"]==="confirm"){wx.showModal({content:i["params"]["message"],cancelText:"取消",confirmText:"确认",success:function(t){e.sendMessage(JSON.stringify({type:"action",message:{event:"callback",id:i["id"],data:t.confirm==true}}))}})}else if(i["params"]["dialogType"]==="prompt"){wx.showModal({title:i["params"]["message"],content:(t=i["params"]["defaultValue"])!==null&&t!==void 0?t:"",editable:true,cancelText:"取消",confirmText:"确认",success:function(t){e.sendMessage(JSON.stringify({type:"action",message:{event:"callback",id:i["id"],data:t.content}}))}})}};t.browserMiniProgramReceivedWebDialogsMessage=function(t,e){if(e["params"]["dialogType"]==="alert"){window.alert(e["params"]["message"]);t.sendMessage(JSON.stringify({type:"action",message:{event:"callback",id:e["id"]}}))}else if(e["params"]["dialogType"]==="confirm"){var i=window.confirm(e["params"]["message"]);t.sendMessage(JSON.stringify({type:"action",message:{event:"callback",id:e["id"],data:i}}))}else if(e["params"]["dialogType"]==="prompt"){var i=window.prompt(e["params"]["message"],e["params"]["defaultValue"]);t.sendMessage(JSON.stringify({type:"action",message:{event:"callback",id:e["id"],data:i}}))}};return t}();i.WebDialogs=o},{"../../env":36}],23:[function(C,t,M){(function(c){"use strict";Object.defineProperty(M,"__esModule",{value:true});M.ComponentFactory=void 0;var t=C("./basic/absorb_pointer");var e=C("./basic/clip_oval");var i=C("./basic/clip_r_rect");var n=C("./basic/colored_box");var o=C("./basic/decorated_box");var r=C("./basic/gesture_detector");var s=C("./basic/ignore_pointer");var a=C("./basic/offstage");var l=C("./basic/opacity");var d=C("./basic/transform");var p=C("./basic/image");var f=C("./component_view");var h=C("./mpkit/scaffold");var v=C("./basic/rich_text");var y=C("./basic/list_view");var m=C("./basic/grid_view");var g=C("./basic/custom_scroll_view");var w=C("./basic/custom_paint");var b=C("./mpkit/icon");var _=C("./mpkit/video_view");var x=C("./mpkit/web_view");var P=C("./mpkit/page_view");var O=C("./basic/overlay");var S=C("./basic/visibility");var u=function(){function u(t){this.engine=t;this.cachedView={};this.cachedElement={};this.textMeasureResults=[];this.markedNeedsFlushTextMeasureResult=false}u.prototype.create=function(t,e){var i;if(!t)return undefined;var n=t["^"];var o=t.name;var r=t.hashCode;if(n==1&&typeof r==="number"){return this.cachedView[r]}if(!o||!r){return undefined}if(!n){this.cachedElement[r]=t}var s=this.cachedView[r];if(s){e=s.document;if(t.constraints){s.setConstraints(t.constraints)}if(t.attributes){s.setAttributes(t.attributes)}if(t.children){s.setChildren(this.fetchCachedChildren(t.children))}return s}var a=u.components[o];if(!a){a=f.ComponentView}var l=new a(e);if((i=window!==null&&window!==void 0?window:c)===null||i===void 0?void 0:i.mpDEBUG){l.htmlElement.setAttribute("mp-component",o)}l.factory=this;l.engine=this.engine;l.hashCode=r;if(t.constraints){l.setConstraints(t.constraints)}if(t.attributes){l.setAttributes(t.attributes)}if(t.children){l.setChildren(this.fetchCachedChildren(t.children))}this.cachedView[r]=l;return l};u.prototype.fetchCachedChildren=function(t){var n=this;return t.map(function(t){var e=t["^"];var i=t["hashCode"];if(e&&n.cachedElement[i]){return n.cachedElement[i]}else{return t}})};u.prototype.callbackTextMeasureResult=function(t,e){var i=this;this.textMeasureResults.push({measureId:t,size:e});if(!this.markedNeedsFlushTextMeasureResult){this.markedNeedsFlushTextMeasureResult=true;setTimeout(function(){i.flushTextMeasureResult();i.markedNeedsFlushTextMeasureResult=false},16)}};u.prototype.flushTextMeasureResult=function(){if(this.textMeasureResults.length>0){this.engine.sendMessage(JSON.stringify({type:"rich_text",message:{event:"onMeasured",data:this.textMeasureResults}}));this.textMeasureResults=[]}};u.components={absorb_pointer:t.AbsorbPointer,clip_oval:e.ClipOval,clip_r_rect:i.ClipRRect,colored_box:n.ColoredBox,custom_paint:w.CustomPaint,custom_scroll_view:g.CustomScrollView,decorated_box:o.DecoratedBox,gesture_detector:r.GestureDetector,grid_view:m.GridView,ignore_pointer:s.IgnorePointer,image:p.Image,list_view:y.ListView,offstage:a.Offstage,opacity:l.Opacity,overlay:O.Overlay,rich_text:v.RichText,text_span:v.TextSpan,widget_span:v.WidgetSpan,transform:d.Transform,visibility:S.Visibility,mp_icon:b.MPIcon,mp_scaffold:h.MPScaffold,mp_video_view:_.MPVideoView,mp_web_view:x.MPWebView,mp_page_view:P.MPPageView};return u}();M.ComponentFactory=u}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./basic/absorb_pointer":2,"./basic/clip_oval":3,"./basic/clip_r_rect":4,"./basic/colored_box":6,"./basic/custom_paint":7,"./basic/custom_scroll_view":8,"./basic/decorated_box":9,"./basic/gesture_detector":10,"./basic/grid_view":12,"./basic/ignore_pointer":13,"./basic/image":14,"./basic/list_view":15,"./basic/offstage":16,"./basic/opacity":17,"./basic/overlay":18,"./basic/rich_text":19,"./basic/transform":20,"./basic/visibility":21,"./component_view":24,"./mpkit/icon":26,"./mpkit/page_view":27,"./mpkit/scaffold":28,"./mpkit/video_view":29,"./mpkit/web_view":30}],24:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:true});i.ComponentView=void 0;var v=t("./dom_utils");var n=function(){function t(t){this.document=t;this.subviews=[];this.htmlElement=t.createElement(this.elementType())}t.prototype.elementType=function(){return"div"};t.prototype.setConstraints=function(t){var e,i,n,o,r,s,a,l,u,c;if(!t)return;this.constraints=t;var d=t.x;var p=t.y;var f=t.w;var h=t.h;v.setDOMStyle(this.htmlElement,{position:(i=(e=this.additionalConstraints)===null||e===void 0?void 0:e.position)!==null&&i!==void 0?i:"absolute",left:(o=(n=this.additionalConstraints)===null||n===void 0?void 0:n.left)!==null&&o!==void 0?o:d+"px",top:(s=(r=this.additionalConstraints)===null||r===void 0?void 0:r.top)!==null&&s!==void 0?s:p+"px",width:(l=(a=this.additionalConstraints)===null||a===void 0?void 0:a.width)!==null&&l!==void 0?l:f+"px",height:(c=(u=this.additionalConstraints)===null||u===void 0?void 0:u.height)!==null&&c!==void 0?c:h+"px"})};t.prototype.setAttributes=function(t){this.attributes=t};t.prototype.setChildren=function(t){var i=this;if(!(t instanceof Array))return;var e=t.map(function(t){return i.factory.create(t,i.document)}).filter(function(t){return t});var n=false;if(e.length!=this.subviews.length){n=true}else{var o=e.every(function(t,e){return t===i.subviews[e]});if(!o){n=true}}if(n){this.removeAllSubviews();e.forEach(function(t){return i.addSubview(t)})}};t.prototype.removeAllSubviews=function(){this.subviews.forEach(function(t){t.htmlElement.remove()});this.subviews=[]};t.prototype.removeFromSuperview=function(){var t,e;var i=(t=this.superview)===null||t===void 0?void 0:t.subviews.indexOf(this);if(i){(e=this.superview)===null||e===void 0?void 0:e.subviews.splice(i,1)}this.htmlElement.remove()};t.prototype.addSubview=function(t){this.subviews.push(t);t.superview=this;this.htmlElement.appendChild(t.htmlElement)};return t}();i.ComponentView=n},{"./dom_utils":25}],25:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:true});i.setDOMAttribute=i.setDOMStyle=void 0;i.setDOMStyle=function(t,e){if(typeof HTMLElement==="function"&&t instanceof HTMLElement){for(var i in e){t.style[i]=e[i]}}else{t.setStyle(e)}};i.setDOMAttribute=function(t,e,i){if(t.attributes===undefined){t.attributes={}}if(t.attributes[e]===i){return}t.attributes[e]=i;t.setAttribute(e,i)}},{}],26:[function(t,e,i){"use strict";var n=this&&this.__extends||function(){var n=function(t,e){n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return n(t,e)};return function(t,e){n(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}();Object.defineProperty(i,"__esModule",{value:true});i.MPIcon=void 0;var o=t("../component_view");var r=t("../dom_utils");var s=t("../utils");var a=function(e){n(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.setChildren=function(){};t.prototype.setAttributes=function(t){e.prototype.setAttributes.call(this,t);r.setDOMStyle(this.htmlElement,{backgroundColor:s.cssColor(t.color),mask:"url("+t.iconUrl+") no-repeat center",webkitMask:"url("+t.iconUrl+") no-repeat center",width:"24px",height:"24px",transform:"scale("+t.size/24+", "+t.size/24+")",transformOrigin:"top left"})};return t}(o.ComponentView);i.MPIcon=a},{"../component_view":24,"../dom_utils":25,"../utils":31}],27:[function(t,e,i){"use strict";var n=this&&this.__extends||function(){var n=function(t,e){n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return n(t,e)};return function(t,e){n(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}();Object.defineProperty(i,"__esModule",{value:true});i.MPPageView=void 0;var o=t("../../env");var r=t("../component_view");var s=t("../dom_utils");var a=function(i){n(t,i);function t(t){var e=i.call(this,t)||this;e.wrapperHtmlElement=e.document.createElement("div");e.direction="horizontal";e.loop=false;e.wrapperHtmlElement.className="swiper-wrapper";e.htmlElement.appendChild(e.wrapperHtmlElement);return e}t.prototype.setChildren=function(t){i.prototype.setChildren.call(this,t);this.htmlElement.className="swiper-container";this.htmlElement.id="d_"+this.hashCode;this.subviews.forEach(function(t){t.htmlElement.className="swiper-slide";t.htmlElement.style.position="relative"});this.setupSwiperInstance()};t.prototype.setAttributes=function(t){i.prototype.setAttributes.call(this,t);this.direction=t.scrollDirection==="Axis.vertical"?"vertical":"horizontal";this.loop=t.loop;this.wrapperHtmlElement.style.flexDirection=t.scrollDirection==="Axis.vertical"?"column":"row";this.setupSwiperInstance()};t.prototype.setupSwiperInstance=function(){var t=this;setTimeout(function(){if(!t.swiperInstance){t.swiperInstance=new window.Swiper("#d_"+t.hashCode,{direction:t.direction,loop:t.loop})}else{t.swiperInstance.changeDirection(t.direction);t.swiperInstance.update()}},16)};t.prototype.addSubview=function(t){this.subviews.push(t);this.wrapperHtmlElement.appendChild(t.htmlElement)};return t}(r.ComponentView);var l=function(e){n(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.elementType=function(){return"swiper"};t.prototype.setAttributes=function(t){e.prototype.setAttributes.call(this,t);s.setDOMAttribute(this.htmlElement,"vertical",t.scrollDirection==="Axis.vertical"?true:false);s.setDOMAttribute(this.htmlElement,"circular",t.loop?true:false)};return t}(r.ComponentView);i.MPPageView=o.MPEnv.platformType===o.PlatformType.wxMiniProgram?l:a},{"../../env":36,"../component_view":24,"../dom_utils":25}],28:[function(t,e,i){"use strict";var n=this&&this.__extends||function(){var n=function(t,e){n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return n(t,e)};return function(t,e){n(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}();Object.defineProperty(i,"__esModule",{value:true});i.MPScaffold=void 0;var o=t("../component_view");var r=t("../dom_utils");var a=t("../utils");var s=function(s){n(t,s);function t(){var t=s!==null&&s.apply(this,arguments)||this;t.attached=false;return t}t.prototype.setAppBar=function(t){if(this.appBar===t)return;this.removeAllSubviews();this.appBar=t;if(t&&this.engine.pageMode){t.additionalConstraints={position:"fixed"};r.setDOMStyle(t.htmlElement,{position:"fixed",zIndex:"9999"})}this.readdSubviews()};t.prototype.setBody=function(t){if(this.body===t)return;this.removeAllSubviews();this.body=t;this.readdSubviews()};t.prototype.setBottomBar=function(t){if(this.bottomBar===t)return;this.removeAllSubviews();this.bottomBar=t;if(t&&this.engine.pageMode){t.additionalConstraints={position:"fixed",top:"unset",zIndex:"9999"};r.setDOMStyle(t.htmlElement,{position:"fixed",top:"unset",bottom:"0px"});if(this.body){r.setDOMStyle(this.body.htmlElement,{paddingBottom:t.htmlElement.style.height})}}this.readdSubviews()};t.prototype.setFloatingBody=function(t){if(this.floatingBody===t)return;this.removeAllSubviews();this.floatingBody=t;if(t&&this.engine.pageMode){t.additionalConstraints={position:"fixed",zIndex:"9999"};r.setDOMStyle(t.htmlElement,{position:"fixed"})}this.readdSubviews()};t.prototype.readdSubviews=function(){if(this.body){this.addSubview(this.body)}if(this.appBar){this.addSubview(this.appBar)}if(this.bottomBar){this.addSubview(this.bottomBar)}if(this.floatingBody){this.addSubview(this.floatingBody)}};t.prototype.setAttributes=function(t){var e,i,n,o,r;s.prototype.setAttributes.call(this,t);this.setAppBar(t.appBar?this.factory.create(t.appBar,this.document):undefined);this.setBody(t.body?this.factory.create(t.body,this.document):undefined);this.setBottomBar(t.bottomBar?this.factory.create(t.bottomBar,this.document):undefined);this.setFloatingBody(t.floatingBody?this.factory.create(t.floatingBody,this.document):undefined);if(t.name){(e=this.delegate)===null||e===void 0?void 0:e.setPageTitle(t.name)}else{(i=this.delegate)===null||i===void 0?void 0:i.setPageTitle("")}if(t.backgroundColor){(n=this.delegate)===null||n===void 0?void 0:n.setPageBackgroundColor(a.cssColorHex(t.backgroundColor))}else{(o=this.delegate)===null||o===void 0?void 0:o.setPageBackgroundColor("transparent")}if(t.appBarColor){(r=this.delegate)===null||r===void 0?void 0:r.setAppBarColor(a.cssColorHex(t.appBarColor),t.appBarTintColor?a.cssColorHex(t.appBarTintColor):"#000000")}};t.prototype.setDelegate=function(t){this.delegate=t};t.prototype.onRefresh=function(){var e=this;return new Promise(function(t){e.refreshEndResolver=t;e.engine.sendMessage(JSON.stringify({type:"scaffold",message:{event:"onRefresh",target:e.hashCode}}))})};t.prototype.onReachBottom=function(){this.engine.sendMessage(JSON.stringify({type:"scaffold",message:{event:"onReachBottom",target:this.hashCode}}))};t.prototype.setChildren=function(){};return t}(o.ComponentView);i.MPScaffold=s},{"../component_view":24,"../dom_utils":25,"../utils":31}],29:[function(t,e,i){"use strict";var n=this&&this.__extends||function(){var n=function(t,e){n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return n(t,e)};return function(t,e){n(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}();Object.defineProperty(i,"__esModule",{value:true});i.MPVideoView=void 0;var o=t("../component_view");var r=t("../dom_utils");var s=function(e){n(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.elementType=function(){return"video"};t.prototype.setAttributes=function(t){e.prototype.setAttributes.call(this,t);r.setDOMAttribute(this.htmlElement,"src",t.url);if(t.controls){r.setDOMAttribute(this.htmlElement,"controls",t.controls)}if(t.autoplay){r.setDOMAttribute(this.htmlElement,"autoplay",t.autoplay)}if(t.loop){r.setDOMAttribute(this.htmlElement,"loop",t.loop)}if(t.muted){r.setDOMAttribute(this.htmlElement,"muted",t.muted)}if(t.poster){r.setDOMAttribute(this.htmlElement,"poster",t.poster)}};return t}(o.ComponentView);i.MPVideoView=s},{"../component_view":24,"../dom_utils":25}],30:[function(t,e,i){"use strict";var n=this&&this.__extends||function(){var n=function(t,e){n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return n(t,e)};return function(t,e){n(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}();Object.defineProperty(i,"__esModule",{value:true});i.MPWebView=void 0;var o=t("../component_view");var r=t("../dom_utils");var s=function(e){n(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.elementType=function(){return"iframe"};t.prototype.setAttributes=function(t){e.prototype.setAttributes.call(this,t);r.setDOMAttribute(this.htmlElement,"src",t.url);r.setDOMStyle(this.htmlElement,{border:"none"})};return t}(o.ComponentView);i.MPWebView=s},{"../component_view":24,"../dom_utils":25}],31:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:true});n.cssSizeFromMPElement=n.cssPadding=n.cssTextStyle=n.cssTextAlign=n.cssBorder=n.cssOffset=n.cssGradient=n.cssBorderRadius=n.cssColorHex=n.cssColor=void 0;n.cssColor=function(t){var e=parseInt(t);return"rgba("+(e>>16&255)+", "+(e>>8&255)+", "+(e>>0&255)+", "+(e>>24&255)/255+")"};n.cssColorHex=function(t){var e=parseInt(t);var i=(e>>16&255).toString(16);if(i.length<2){i="0"+i}var n=(e>>8&255).toString(16);if(n.length<2){n="0"+i}var o=(e>>0&255).toString(16);if(o.length<2){o="0"+i}return"#"+i+n+o};n.cssBorderRadius=function(t){var e,i,n,o,r,s,a,l;if(t.indexOf("BorderRadius.circular(")===0){var u=t.replace("BorderRadius.circular(","").replace(")","");return{borderRadius:u+"px"}}else if(t.indexOf("BorderRadius.all(")===0){var u=t.replace("BorderRadius.all(","").replace(")","");return{borderRadius:u+"px"}}else if(t.indexOf("BorderRadius.only(")===0){var u=t.replace("BorderRadius.only(","").replace(/\)/gi,"").replace(/Radius.circular\(/gi,"");var c=(i=(e=u.match(/topLeft: ([0-9|.]+)/))===null||e===void 0?void 0:e[1])!==null&&i!==void 0?i:0;var d=(o=(n=u.match(/topRight: ([0-9|.]+)/))===null||n===void 0?void 0:n[1])!==null&&o!==void 0?o:0;var p=(s=(r=u.match(/bottomLeft: ([0-9|.]+)/))===null||r===void 0?void 0:r[1])!==null&&s!==void 0?s:0;var f=(l=(a=u.match(/bottomRight: ([0-9|.]+)/))===null||a===void 0?void 0:a[1])!==null&&l!==void 0?l:0;return{borderTopLeftRadius:c+"px",borderTopRightRadius:d+"px",borderBottomLeftRadius:p+"px",borderBottomRightRadius:f+"px"}}else{return{}}};n.cssGradient=function(i){if(!i)return"";if(i.classname==="LinearGradient"){var t=function(){switch(i.end){case"centerRight":return"to right";case"centerLeft":return"to left";case"topRight":return"to top right";case"bottomRight":return"to bottom right";case"topLeft":return"to top left";case"bottomLeft":return"to bottom left";case"topCenter":return"to top";case"bottomCenter":return"to bottom";default:break}}();var e=[];if(i.stops&&i.stops.length){e=i.colors.map(function(t,e){if(i.stops[e]!==undefined){return n.cssColor(t)+" "+(i.stops[e]*100).toFixed(0)+"%"}else{return n.cssColor(t)}})}else{e=i.colors.map(function(t){return n.cssColor(t)})}return"linear-gradient("+t+", "+e.join(", ")+")"}return""};n.cssOffset=function(t){if(t.indexOf("Offset(")===0){var e=t.replace("Offset(","").replace(")","");var i=e.split(",").map(function(t){return t.trim()});return{dx:i[0],dy:i[1]}}else{return undefined}};n.cssBorder=function(t){var e={};if(t["topStyle"]!=="BorderStyle.none"){e.borderTopWidth=t.topWidth===0?(1/window.devicePixelRatio).toFixed(2)+"px":t.topWidth+"px";e.borderTopColor=n.cssColor(t.topColor);e.borderTopStyle="solid"}if(t["leftStyle"]!=="BorderStyle.none"){e.borderLeftWidth=t.leftWidth===0?(1/window.devicePixelRatio).toFixed(2)+"px":t.leftWidth+"px";e.borderLeftColor=n.cssColor(t.leftColor);e.borderLeftStyle="solid"}if(t["bottomStyle"]!=="BorderStyle.none"){e.borderBottomWidth=t.bottomWidth===0?(1/window.devicePixelRatio).toFixed(2)+"px":t.bottomWidth+"px";e.borderBottomColor=n.cssColor(t.bottomColor);e.borderBottomStyle="solid"}if(t["rightStyle"]!=="BorderStyle.none"){e.borderRightWidth=t.rightWidth===0?(1/window.devicePixelRatio).toFixed(2)+"px":t.rightWidth+"px";e.borderRightColor=n.cssColor(t.rightColor);e.borderRightStyle="solid"}return e};n.cssTextAlign=function(t){return t===null||t===void 0?void 0:t.replace("TextAlign.","")};function o(t){if(t.fontWeight){return t.fontWeight.replace("FontWeight.w","")}return undefined}function r(t){if(t.fontStyle==="FontStyle.italic"){return"italic"}return undefined}function s(t){if(t.textBaseline==="TextBaseline.alphabetic"){return"alphabetic"}else if(t.textBaseline==="TextBaseline.ideographic"){return"ideographic"}return undefined}function i(t){var e;var i={userSelect:"none",WebkitUserSelect:"none"};if(t!=null){if(t.fontFamily){i.fontFamily=t.fontFamily}if(t.fontSize!=null){i.fontSize=((e=t.fontSize)!==null&&e!==void 0?e:14).toString()+"px"}if(t.color!=null){i.color=n.cssColor(t.color)}if(t.fontWeight){i.fontWeight=o(t)}if(t.fontStyle){i.fontStyle=r(t)}if(t.letterSpacing){i.letterSpacing=t.letterSpacing}if(t.wordSpacing){i.wordSpacing=t.wordSpacing}if(t.textBaseline){i.alignmentBaseline=s(t)}if(t.height){i.lineHeight=t.height}if(t.backgroundColor!=null){i.backgroundColor=n.cssColor(t.backgroundColor)}if(t.decoration){if(t.decoration==="TextDecoration.lineThrough"){i.textDecoration="line-through"}else if(t.decoration==="TextDecoration.underline"){i.textDecoration="underline"}}}return i}n.cssTextStyle=i;n.cssPadding=function(t){if(!t)return{};if(t.indexOf("EdgeInsets.zero")===0){return{}}else if(t.indexOf("EdgeInsets.all(")===0){var e=t.replace("EdgeInsets.all(","").replace(")","");return{paddingLeft:e+"px",paddingTop:e+"px",paddingRight:e+"px",paddingBottom:e+"px"}}else if(t.indexOf("EdgeInsets(")===0){var e=t.replace("EdgeInsets(","").replace(")","");var i=e.split(",").map(function(t){return t.trim()});return{paddingLeft:i[0]+"px",paddingTop:i[1]+"px",paddingRight:i[2]+"px",paddingBottom:i[3]+"px"}}else{return{}}};n.cssSizeFromMPElement=function(t){if(!t)return{width:0,height:0};var e=0;var i=0;if(t.constraints&&typeof t.constraints.w==="number"&&typeof t.constraints.h==="number"&&t.constraints.w>0&&t.constraints.h>0){e=t.constraints.w;i=t.constraints.h}else if(t.children instanceof Array&&t.children.length===1){return n.cssSizeFromMPElement(t.children[0])}return{width:e,height:i}}},{}],32:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:true});i.BrowserDebugger=void 0;var n=function(){function t(t,e){this.serverAddr=t;this.engine=e;this.messageQueue=[];this.connected=false}t.prototype.start=function(){var e=this;var t="ws";if(new URL(location.href).protocol==="https:"){t="wss"}this.socket=new WebSocket(t+"://"+this.serverAddr+"/ws");this.socket.onopen=function(){e.socketDidConnect();e.connected=true};this.socket.onmessage=function(t){if(typeof t.data==="string"){e.socketDidReceiveMessage(t.data)}};this.socket.onclose=function(){if(e.connected){location.href="?"}e.socketDidDisconnect()}};t.prototype.socketDidConnect=function(){var i=this;this.messageQueue.forEach(function(t){var e;(e=i.socket)===null||e===void 0?void 0:e.send(t)});this.messageQueue=[]};t.prototype.socketDidDisconnect=function(){var t=this;setTimeout(function(){t.start()},1e3)};t.prototype.socketDidReceiveMessage=function(t){this.engine.didReceivedMessage(t)};t.prototype.sendMessage=function(t){if(!this.socket||this.socket.readyState!=1){this.messageQueue.push(t);return}this.socket.send(t)};return t}();i.BrowserDebugger=n},{}],33:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:true});i.createDebugger=void 0;var n=t("../env");var o=t("./browser_debugger");var r=t("./wx_debugger");function s(t,e){if(n.MPEnv.platformType===n.PlatformType.wxMiniProgram){return new r.WXDebugger(t,e)}else{return new o.BrowserDebugger(t,e)}}i.createDebugger=s},{"../env":36,"./browser_debugger":32,"./wx_debugger":34}],34:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:true});i.WXDebugger=void 0;var n=function(){function t(t,e){this.serverAddr=t;this.engine=e;this.messageQueue=[];this.connected=false}t.prototype.start=function(){var e=this;this.socket=wx.connectSocket({url:"ws://"+this.serverAddr+"/ws"});this.socket.onOpen(function(){e.connected=true;e.socketDidConnect()});this.socket.onMessage(function(t){if(typeof t.data==="string"){e.socketDidReceiveMessage(t.data)}});this.socket.onClose(function(){if(e.connected){wx.reLaunch({url:"/"+wx.getLaunchOptionsSync().path})}e.connected=false;e.socketDidDisconnect()})};t.prototype.socketDidConnect=function(){var i=this;this.messageQueue.forEach(function(t){var e;(e=i.socket)===null||e===void 0?void 0:e.send({data:t})});this.messageQueue=[]};t.prototype.socketDidDisconnect=function(){var t=this;setTimeout(function(){t.start()},1e3)};t.prototype.socketDidReceiveMessage=function(t){this.engine.didReceivedMessage(t)};t.prototype.sendMessage=function(t){if(!this.socket||!this.connected){this.messageQueue.push(t);return}this.socket.send({data:t})};return t}();i.WXDebugger=n},{}],35:[function(require,module,exports){(function(global){"use strict";var _a;Object.defineProperty(exports,"__esModule",{value:true});exports.Engine=void 0;var custom_paint_1=require("./components/basic/custom_paint");var web_dialogs_1=require("./components/basic/web_dialogs");var component_factory_1=require("./components/component_factory");var debugger_1=require("./debugger/debugger");var method_channel_handler_1=require("./mpjs/method_channel_handler");var mpjs_1=require("./mpjs/mpjs");var window_info_1=require("./window_info");try{var self_1=window!==null&&window!==void 0?window:global;self_1.mpDEBUG=(_a=self_1.mpDEBUG)!==null&&_a!==void 0?_a:false}catch(t){}var Engine=function(){function Engine(){this.started=false;this.messageQueue=[];this.managedViews={};this.unmanagedViewFrameData={};this.mpJS=new mpjs_1.MPJS(this);this.windowInfo=new window_info_1.WindowInfo(this);this.pageMode=false;this.componentFactory=new component_factory_1.ComponentFactory(this);this.drawable=new custom_paint_1.MPDrawable(this);method_channel_handler_1.MethodChannelHandler.installHandler()}Engine.codeBlockWithCodePath=function(codePath){return new Promise(function(res,rej){var httpRequest=new XMLHttpRequest;httpRequest.onload=function(){res(function(){eval(httpRequest.response)})};httpRequest.onerror=function(t){rej(t)};httpRequest.open("GET",codePath);httpRequest.send()})};Engine.codeBlockWithFile=function(t){return function(){require(t).main()}};Engine.prototype.initWithDebuggerServerAddr=function(t){this.debugger=debugger_1.createDebugger(t,this)};Engine.prototype.initWithCodeBlock=function(t){this.codeBlock=t};Engine.prototype.start=function(){var e=this;if(this.started)return;if(!this.codeBlock&&!this.debugger)return;this.windowInfo.updateWindowInfo();if(self){self.engineScope=this.mpJS.engineScope}else{global.self={JSON:JSON,setTimeout:setTimeout,setInterval:setInterval,clearTimeout:clearTimeout,clearInterval:clearInterval,wx:wx,Object:Object};global.JSON=JSON;global.setTimeout=setTimeout;global.setInterval=setInterval;global.clearTimeout=clearTimeout;global.clearInterval=clearInterval;global.wx=wx;global.Object=Object;global.self.engineScope=this.mpJS.engineScope}if(this.debugger){this.debugger.start()}if(this.codeBlock){this.mpJS.engineScope.onMessage=function(t){e.didReceivedMessage(t)};(function(){e.codeBlock()})();this.flushQueueMessage()}this.started=true};Engine.prototype.sendMessage=function(t){var e;if((e=window!==null&&window!==void 0?window:global)===null||e===void 0?void 0:e.mpDEBUG){console.log("out",JSON.parse(t))}if(this.debugger){this.debugger.sendMessage(t)}else{if(this.mpJS.engineScope.postMessage){this.mpJS.engineScope.postMessage(t)}else{this.messageQueue.push(t)}}};Engine.prototype.flushQueueMessage=function(){var e=this;if(this.debugger){return}else{if(this.mpJS.engineScope.postMessage){this.messageQueue.forEach(function(t){e.mpJS.engineScope.postMessage(t)})}}};Engine.prototype.didReceivedMessage=function(t){var e,i,n,o;var r=JSON.parse(t);if(!r)return;if((e=window!==null&&window!==void 0?window:global)===null||e===void 0?void 0:e.mpDEBUG){console.log("in",r)}if(r.type==="frame_data"){this.didReceivedFrameData(r.message)}else if(r.type==="diff_data"){this.didReceivedDiffData(r.message)}else if(r.type==="element_gc"){if(r.message instanceof Array){this.didReceivedElementGC(r.message)}}else if(r.type==="decode_drawable"){this.drawable.decodeDrawable(r.message)}else if(r.type==="route"){(o=(n=(i=this.app)===null||i===void 0?void 0:i.router)!==null&&n!==void 0?n:this.router)===null||o===void 0?void 0:o.didReceivedRouteData(r.message)}else if(r.type==="mpjs"){this.didReceivedMPJS(r)}else if(r.type==="action:web_dialogs"){web_dialogs_1.WebDialogs.receivedWebDialogsMessage(this,r.message)}else if(r.type==="scaffold"){this.didReceivedScaffold(r.message)}};Engine.prototype.didReceivedFrameData=function(t){var e;if(!t)return;var i=t.routeId;if(this.managedViews[i]===undefined){if(!this.unmanagedViewFrameData[i]){this.unmanagedViewFrameData[i]=[]}this.unmanagedViewFrameData[i].push(t);return}var n=false;if(!n&&typeof i==="number"){(e=this.managedViews[i])===null||e===void 0?void 0:e.didReceivedFrameData(t)}};Engine.prototype.didReceivedDiffData=function(t){var e=this;if(!t)return;t.diffs.forEach(function(t){e.componentFactory.create(t,undefined)})};Engine.prototype.didReceivedElementGC=function(t){var e=this;t.forEach(function(t){delete e.componentFactory.cachedElement[t];delete e.componentFactory.cachedView[t]})};Engine.prototype.didReceivedScaffold=function(t){var e;if(t.event==="onRefreshEnd"){var i=this.componentFactory.cachedView[t.target];if(i){(e=i.refreshEndResolver)===null||e===void 0?void 0:e.call(i,undefined);i.refreshEndResolver=undefined}}};Engine.prototype.didReceivedMPJS=function(e){var i=this;this.mpJS.handleMessage(e.message,function(t){i.sendMessage(JSON.stringify({type:"mpjs",message:{requestId:e.message.requestId,result:t}}))},function(t,e){i.sendMessage(JSON.stringify({type:"mpjs",message:{funcId:t,arguments:e}}))})};return Engine}();exports.Engine=Engine}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./components/basic/custom_paint":7,"./components/basic/web_dialogs":22,"./components/component_factory":23,"./debugger/debugger":33,"./mpjs/method_channel_handler":38,"./mpjs/mpjs":39,"./window_info":42}],36:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:true});i.MPEnv=i.PlatformType=void 0;var n;(function(t){t[t["unknown"]=0]="unknown";t[t["browser"]=1]="browser";t[t["wxMiniProgram"]=2]="wxMiniProgram"})(n=i.PlatformType||(i.PlatformType={}));i.MPEnv={platformType:function(){if(typeof wx!=="undefined"&&typeof wx.getSystemInfoSync==="function"){return n.wxMiniProgram}else{return n.browser}}()}},{}],37:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:true});var n=t("./engine");Object.defineProperty(i,"Engine",{enumerable:true,get:function(){return n.Engine}});var o=t("./page");Object.defineProperty(i,"Page",{enumerable:true,get:function(){return o.Page}});Object.defineProperty(i,"WXPage",{enumerable:true,get:function(){return o.WXPage}});var r=t("./app");Object.defineProperty(i,"BrowserApp",{enumerable:true,get:function(){return r.BrowserApp}});Object.defineProperty(i,"WXApp",{enumerable:true,get:function(){return r.WXApp}})},{"./app":1,"./engine":35,"./page":40}],38:[function(t,e,n){(function(t){"use strict";var e=this&&this.__awaiter||function(t,s,i,a){function l(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(e,i){function n(t){try{r(a.next(t))}catch(t){i(t)}}function o(t){try{r(a["throw"](t))}catch(t){i(t)}}function r(t){t.done?e(t.value):l(t.value).then(n,o)}r((a=a.apply(t,s||[])).next())})};var a=this&&this.__generator||function(t,i){var n={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},o,r,s,e;return e={next:a(0),throw:a(1),return:a(2)},typeof Symbol==="function"&&(e[Symbol.iterator]=function(){return this}),e;function a(e){return function(t){return l([e,t])}}function l(e){if(o)throw new TypeError("Generator is already executing.");while(n)try{if(o=1,r&&(s=e[0]&2?r["return"]:e[0]?r["throw"]||((s=r["return"])&&s.call(r),0):r.next)&&!(s=s.call(r,e[1])).done)return s;if(r=0,s)e=[e[0]&2,s.value];switch(e[0]){case 0:case 1:s=e;break;case 4:n.label++;return{value:e[1],done:false};case 5:n.label++;r=e[1];e=[0];continue;case 7:e=n.ops.pop();n.trys.pop();continue;default:if(!(s=n.trys,s=s.length>0&&s[s.length-1])&&(e[0]===6||e[0]===2)){n=0;continue}if(e[0]===3&&(!s||e[1]>s[0]&&e[1]<s[3])){n.label=e[1];break}if(e[0]===6&&n.label<s[1]){n.label=s[1];s=e;break}if(s&&n.label<s[2]){n.label=s[2];n.ops.push(e);break}if(s[2])n.ops.pop();n.trys.pop();continue}e=i.call(t,n)}catch(t){e=[6,t];r=0}finally{o=s=0}if(e[0]&5)throw e[1];return{value:e[0]?e[1]:void 0,done:true}}};Object.defineProperty(n,"__esModule",{value:true});n.MethodChannelHandler=void 0;var l=window!==null&&window!==void 0?window:t;var i=function(){function t(){}t.installHandler=function(){l.mp_core_methodChannelHandlerWebOnly=this.handler};t.handler=function(n,o,r,s){return e(this,void 0,void 0,function(){var e,i;return a(this,function(t){switch(t.label){case 0:if(!Object.prototype.hasOwnProperty.call(l,n)){s("NOTIMPLEMENTED");return[2]}if(!(typeof l[n][o]==="function")){s("NOTIMPLEMENTED");return[2]}t.label=1;case 1:t.trys.push([1,3,,4]);return[4,l[n][o](r)];case 2:e=t.sent();s(JSON.stringify(e));return[3,4];case 3:i=t.sent();s("ERROR:"+i);return[3,4];case 4:return[2]}})})};return t}();n.MethodChannelHandler=i}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],39:[function(t,e,i){(function(t){"use strict";Object.defineProperty(i,"__esModule",{value:true});i.MPJS=void 0;var c=window!==null&&window!==void 0?window:t;var e=function(){function t(t){this.engine=t;this.engineScope={};this.objectRefs={}}t.prototype.handleMessage=function(t,e,i){if(t.event==="callMethod"){this.callMethod(t,e,i)}else if(t.event==="getValue"){this.getValue(t,e)}else if(t.event==="setValue"){this.setValue(t,e)}else if(t.event==="hasProperty"){this.hasProperty(t,e)}else if(t.event==="deleteProperty"){this.deleteProperty(t,e)}};t.prototype.callMethod=function(t,e,i){var n=this;var o;var r=t.params;var s=this.getCallee(r.objectHandler,r.callChain);if(typeof s==="object"||typeof s==="function"){try{var a=s[r.method].apply(s,(o=r.args)===null||o===void 0?void 0:o.map(function(t){return n.wrapArgument(t,i)}));e(this.wrapResult(a))}catch(t){console.error(t)}}};t.prototype.getValue=function(t,e){var i=t.params;var n=this.getCallee(i.objectHandler,i.callChain);e(this.wrapResult(n[i.key]))};t.prototype.setValue=function(t,e){var i=t.params;var n=this.getCallee(i.objectHandler,i.callChain);n[i.key]=i.value;e(undefined)};t.prototype.hasProperty=function(t,e){var i=t.params;var n=this.getCallee(i.objectHandler,i.callChain);e(this.wrapResult(n&&n.hasOwnProperty(i.key)))};t.prototype.deleteProperty=function(t,e){var i=t.params;var n=this.getCallee(i.objectHandler,i.callChain);if(n){delete n[i.key]}e(1)};t.prototype.getCallee=function(t,e){var i,n,o,r;var s=(i=this.objectRefs[t])!==null&&i!==void 0?i:c;var a=s;if(e[0]==="engineScope"){a=this.engineScope;e.shift()}for(var l=0;l<e.length;l++){var u=e[l];a=a[u];if(u==="document"&&l===0&&a===undefined){a=(r=(o=(n=this.engine)===null||n===void 0?void 0:n.managedViews)===null||o===void 0?void 0:o[0])===null||r===void 0?void 0:r.document}if(a===undefined||a===null){break}}return a};t.prototype.wrapArgument=function(t,n){var e=this;if(typeof t==="string"&&t.indexOf("func:")===0){var o=t;var r=this;return function(){var t=[];for(var e=0;e<arguments.length;e++){var i=arguments[e];t.push(r.wrapResult(i))}n(o,t)}}else if(typeof t==="string"&&t.indexOf("obj:")===0){return this.objectRefs[t.replace("obj:","")]}else if(typeof t==="object"&&t instanceof Array){return t.map(function(t){return e.wrapArgument(t,n)})}else if(typeof t==="object"){var i={};for(var s in t){i[s]=this.wrapArgument(t[s],n)}return i}else{return t}};t.prototype.wrapResult=function(t){if(typeof t==="string"||typeof t==="number"||typeof t==="boolean"||typeof t==="bigint"){return t}else{var e=Math.random().toString();this.objectRefs[e]=t;return{objectHandler:e}}};return t}();i.MPJS=e}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],40:[function(l,t,p){(function(t){"use strict";var s=this&&this.__assign||function(){s=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++){e=arguments[i];for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o))t[o]=e[o]}return t};return s.apply(this,arguments)};var e=this&&this.__awaiter||function(t,s,i,a){function l(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(e,i){function n(t){try{r(a.next(t))}catch(t){i(t)}}function o(t){try{r(a["throw"](t))}catch(t){i(t)}}function r(t){t.done?e(t.value):l(t.value).then(n,o)}r((a=a.apply(t,s||[])).next())})};var u=this&&this.__generator||function(t,i){var n={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},o,r,s,e;return e={next:a(0),throw:a(1),return:a(2)},typeof Symbol==="function"&&(e[Symbol.iterator]=function(){return this}),e;function a(e){return function(t){return l([e,t])}}function l(e){if(o)throw new TypeError("Generator is already executing.");while(n)try{if(o=1,r&&(s=e[0]&2?r["return"]:e[0]?r["throw"]||((s=r["return"])&&s.call(r),0):r.next)&&!(s=s.call(r,e[1])).done)return s;if(r=0,s)e=[e[0]&2,s.value];switch(e[0]){case 0:case 1:s=e;break;case 4:n.label++;return{value:e[1],done:false};case 5:n.label++;r=e[1];e=[0];continue;case 7:e=n.ops.pop();n.trys.pop();continue;default:if(!(s=n.trys,s=s.length>0&&s[s.length-1])&&(e[0]===6||e[0]===2)){n=0;continue}if(e[0]===3&&(!s||e[1]>s[0]&&e[1]<s[3])){n.label=e[1];break}if(e[0]===6&&n.label<s[1]){n.label=s[1];s=e;break}if(s&&n.label<s[2]){n.label=s[2];n.ops.push(e);break}if(s[2])n.ops.pop();n.trys.pop();continue}e=i.call(t,n)}catch(t){e=[6,t];r=0}finally{o=s=0}if(e[0]&5)throw e[1];return{value:e[0]?e[1]:void 0,done:true}}};Object.defineProperty(p,"__esModule",{value:true});p.WXPage=p.WXPageScaffoldDelegate=p.BrowserPageScaffoldDelegate=p.Page=void 0;var i=l("./components/dom_utils");var n=l("./components/mpkit/scaffold");var c=l("./env");var d=l("./router");var a=function(){function t(t,i,e,n){var o=this;if(n===void 0){n=self===null||self===void 0?void 0:self.document}this.element=t;this.engine=i;this.options=e;this.document=n;this._active=true;this.viewId=-1;this.overlaysView=[];this.isFirst=false;this.requestRoute().then(function(t){var e;o.viewId=t;i.managedViews[o.viewId]=o;i.pageMode=true;if(i.unmanagedViewFrameData[o.viewId]){i.unmanagedViewFrameData[o.viewId].forEach(function(t){o.didReceivedFrameData(t)});delete i.unmanagedViewFrameData[o.viewId]}(e=o.readyCallback)===null||e===void 0?void 0:e.call(o,undefined)})}t.prototype.ready=function(){return e(this,void 0,void 0,function(){var e=this;return u(this,function(t){return[2,new Promise(function(t){e.readyCallback=t})]})})};t.prototype.requestRoute=function(){var n,o,r,s,a,l;return e(this,void 0,void 0,function(){var e,i;return u(this,function(t){switch(t.label){case 0:if(!this.engine.app){this.engine.router=new d.Router(this.engine)}e=(o=(n=this.engine.app)===null||n===void 0?void 0:n.router)!==null&&o!==void 0?o:(r=this.engine)===null||r===void 0?void 0:r.router;return[4,this.element.getBoundingClientRect()];case 1:i=t.sent();if(i.height<=0){if(c.MPEnv.platformType===c.PlatformType.wxMiniProgram){i.height=wx.getSystemInfoSync().windowHeight}else{i.height=window.innerHeight}}return[2,e.requestRoute((a=(s=this.options)===null||s===void 0?void 0:s.route)!==null&&a!==void 0?a:"/",(l=this.options)===null||l===void 0?void 0:l.params,this.isFirst||this.engine.app===undefined,{width:i.width,height:i.height})]}})})};t.prototype.dispose=function(){delete this.engine.managedViews[this.viewId]};t.prototype.didReceivedFrameData=function(t){var e=this.engine.componentFactory.create(t.scaffold,this.document);if(!(e instanceof n.MPScaffold))return;if(this.scaffoldView!==e){if(this.scaffoldView){this.scaffoldView.removeFromSuperview()}this.scaffoldView=e;if(e instanceof n.MPScaffold&&!e.delegate){if(c.MPEnv.platformType===c.PlatformType.wxMiniProgram){e.setDelegate(new r);e.setAttributes(t.scaffold.attributes)}else{e.setDelegate(new o);e.setAttributes(t.scaffold.attributes)}}}if(this.scaffoldView&&this.active&&!this.scaffoldView.attached){this.scaffoldView.attached=true;this.element.appendChild(this.scaffoldView.htmlElement);i.setDOMStyle(this.scaffoldView.htmlElement,{display:"contents"})}if(t.overlays&&t.overlays instanceof Array){this.setOverlays(t.overlays)}};t.prototype.onRefresh=function(){return e(this,void 0,void 0,function(){return u(this,function(t){switch(t.label){case 0:if(!(this.scaffoldView instanceof n.MPScaffold))return[3,2];return[4,this.scaffoldView.onRefresh()];case 1:t.sent();t.label=2;case 2:return[2]}})})};t.prototype.onReachBottom=function(){if(this.scaffoldView instanceof n.MPScaffold){this.scaffoldView.onReachBottom()}};t.prototype.setOverlays=function(t){var e=this;this.overlaysView.forEach(function(t){t.removeFromSuperview()});var i=t.map(function(t){return e.engine.componentFactory.create(t,e.document)}).filter(function(t){return t});i.forEach(function(t){e.document.body.appendChild(t.htmlElement)});this.overlaysView=i};Object.defineProperty(t.prototype,"active",{get:function(){return this._active},set:function(t){var e;this._active=t;if(!t){if(this.scaffoldView){this.scaffoldView.attached=false;this.scaffoldView.htmlElement.remove()}}else{if((e=this.scaffoldView)===null||e===void 0?void 0:e.htmlElement){this.element.appendChild(this.scaffoldView.htmlElement);this.scaffoldView.setAttributes(this.scaffoldView.attributes)}}},enumerable:false,configurable:true});return t}();p.Page=a;var o=function(){function t(){}t.prototype.setPageTitle=function(t){document.title=t};t.prototype.setPageBackgroundColor=function(t){document.body.style.backgroundColor=t};t.prototype.setAppBarColor=function(t,e){};return t}();p.BrowserPageScaffoldDelegate=o;var r=function(){function t(){}t.prototype.setPageTitle=function(t){wx.setNavigationBarTitle({title:t})};t.prototype.setPageBackgroundColor=function(t){wx.setBackgroundColor({backgroundColor:t})};t.prototype.setAppBarColor=function(t,e){wx.setNavigationBarColor({backgroundColor:t,frontColor:e})};return t}();p.WXPageScaffoldDelegate=r;p.WXPage=function(n,o,r){if(o===void 0){o="#vdom"}if(r===void 0){r=t.app}return{onLoad:function(){var t=this.selectComponent(o).miniDom.document;var e=function(){var t=r.indexPage.split("/");t.pop();return t.join("/")}();if(!n||this.options.route){var i=s({},this.options);delete i["route"];if(this.options.route){n={route:this.options.route,params:i}}else{n={route:this.route.replace(e,""),params:i};if(n.route==="/index"){n.route="/"}}}this.mpPage=new a(t.body,r.engine,n,t)},onUnload:function(){if(this.mpPage.viewId){r.router.disposeRoute(this.mpPage.viewId)}},onPullDownRefresh:function(){this.mpPage.onRefresh().then(function(t){wx.stopPullDownRefresh()})},onReachBottom:function(){this.mpPage.onReachBottom()}}}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./components/dom_utils":25,"./components/mpkit/scaffold":28,"./env":36,"./router":41}],41:[function(t,e,i){"use strict";var n=this&&this.__extends||function(){var n=function(t,e){n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i]};return n(t,e)};return function(t,e){n(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}();var l=this&&this.__awaiter||function(t,s,i,a){function l(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(e,i){function n(t){try{r(a.next(t))}catch(t){i(t)}}function o(t){try{r(a["throw"](t))}catch(t){i(t)}}function r(t){t.done?e(t.value):l(t.value).then(n,o)}r((a=a.apply(t,s||[])).next())})};var u=this&&this.__generator||function(t,i){var n={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},o,r,s,e;return e={next:a(0),throw:a(1),return:a(2)},typeof Symbol==="function"&&(e[Symbol.iterator]=function(){return this}),e;function a(e){return function(t){return l([e,t])}}function l(e){if(o)throw new TypeError("Generator is already executing.");while(n)try{if(o=1,r&&(s=e[0]&2?r["return"]:e[0]?r["throw"]||((s=r["return"])&&s.call(r),0):r.next)&&!(s=s.call(r,e[1])).done)return s;if(r=0,s)e=[e[0]&2,s.value];switch(e[0]){case 0:case 1:s=e;break;case 4:n.label++;return{value:e[1],done:false};case 5:n.label++;r=e[1];e=[0];continue;case 7:e=n.ops.pop();n.trys.pop();continue;default:if(!(s=n.trys,s=s.length>0&&s[s.length-1])&&(e[0]===6||e[0]===2)){n=0;continue}if(e[0]===3&&(!s||e[1]>s[0]&&e[1]<s[3])){n.label=e[1];break}if(e[0]===6&&n.label<s[1]){n.label=s[1];s=e;break}if(s&&n.label<s[2]){n.label=s[2];n.ops.push(e);break}if(s[2])n.ops.pop();n.trys.pop();continue}e=i.call(t,n)}catch(t){e=[6,t];r=0}finally{o=s=0}if(e[0]&5)throw e[1];return{value:e[0]?e[1]:void 0,done:true}}};Object.defineProperty(i,"__esModule",{value:true});i.WXRouter=i.BrowserRouter=i.Router=void 0;var r=t("./page");var o=function(){function t(t){this.engine=t;this.routeResponseHandler={}}t.prototype.requestRoute=function(o,r,s,a){return l(this,void 0,void 0,function(){var e,i;var n=this;return u(this,function(t){if(this.thePushingRouteId){e=this.thePushingRouteId;this.thePushingRouteId=undefined;this.engine.sendMessage(JSON.stringify({type:"router",message:{event:"updateRoute",routeId:e,viewport:a}}));return[2,e]}i=Math.random().toString();return[2,new Promise(function(t){n.routeResponseHandler[i]=t;n.engine.sendMessage(JSON.stringify({type:"router",message:{event:"requestRoute",requestId:i,name:o,params:r!==null&&r!==void 0?r:{},viewport:a,root:s===true}}))})]})})};t.prototype.responseRoute=function(t){var e;var i=t.requestId;var n=t.routeId;(e=this.routeResponseHandler[i])===null||e===void 0?void 0:e.call(this,n)};t.prototype.disposeRoute=function(t){this.engine.sendMessage(JSON.stringify({type:"router",message:{event:"disposeRoute",routeId:t}}))};t.prototype.didReceivedRouteData=function(t){var e=t.event;if(e==="responseRoute"){this.responseRoute(t)}else if(e==="didPush"){this.didPush(t)}else if(e==="didReplace"){this.didReplace(t)}else if(e==="didPop"){this.didPop()}};t.prototype.didPush=function(t){throw"native implementation"};t.prototype.didReplace=function(t){throw"native implementation"};t.prototype.didPop=function(){throw"native implementation"};return t}();i.Router=o;var s=function(e){n(t,e);function t(t){var i=e.call(this,t)||this;i.history=[];i.isPathRewriteEnabled=false;i.doBacking=false;window.addEventListener("popstate",function(t){if(i.doBacking){return true}if(window.history.state&&window.history.state.routeId){var e=window.history.state.routeId;i.popHistory();i.engine.sendMessage(JSON.stringify({type:"router",message:{event:"popToRoute",routeId:e}}))}});return i}t.prototype.encodePath=function(t,e){var i=[];if(e){for(var n in e){i.push(n+"="+encodeURIComponent(e[n]))}}if(this.isPathRewriteEnabled){if(i.length>0){return t+"?"+i.join("&")}else{return""+t}}else{if(i.length>0){return"?route="+encodeURIComponent(t)+"&"+i.join("&")}else{return"?route="+encodeURIComponent(t)}}};t.prototype.didSetupFirst=function(t,e,i){window.history.replaceState({routeId:t},"",this.encodePath(e,i))};t.prototype.didPush=function(t){var e=t.routeId;this.thePushingRouteId=e;var i=t.name;window.history.pushState({routeId:e},"",this.encodePath(i,t.params));var n=window.pageYOffset;var o=new r.Page(this.engine.app.rootElement,this.engine);this.pushHistory(o,n)};t.prototype.didReplace=function(t){var e=t.routeId;this.thePushingRouteId=e;var i=t.name;window.history.replaceState({routeId:e},"",this.encodePath(i,t.params));var n=new r.Page(this.engine.app.rootElement,this.engine);this.replaceHistory(n)};t.prototype.didPop=function(){var t=this;this.doBacking=true;window.history.back();this.popHistory();setTimeout(function(){t.doBacking=false},100)};t.prototype.pushHistory=function(t,e){this.history.forEach(function(t){return t.item.active=false});this.history.push({item:t,scrollPosition:e});window.scrollTo(0,0)};t.prototype.replaceHistory=function(t){this.history.forEach(function(t){return t.item.active=false});this.history[this.history.length-1]={item:t,scrollPosition:0};window.scrollTo(0,0)};t.prototype.popHistory=function(){if(this.history.length<=0)return;this.history.pop().item.active=false;this.history[this.history.length-1].item.active=true;window.scrollTo(0,this.history[this.history.length-1].scrollPosition)};return t}(o);i.BrowserRouter=s;var a=function(t){n(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}e.prototype.encodeRelativePath=function(t,e){var i=[];if(e){for(var n in e){i.push(n+"="+encodeURIComponent(e[n]))}}if(i.length>0){return(t.indexOf("/")===0?t.substr(1):t)+"?"+i.join("&")}else{return""+(t.indexOf("/")===0?t.substr(1):t)}};e.prototype.encodeIndexPath=function(t,e){var i=[];if(e){for(var n in e){i.push(n+"="+encodeURIComponent(e[n]))}}if(i.length>0){return"/"+this.engine.app.indexPage+"?route="+encodeURIComponent(t)+"&"+i.join("&")}else{return"/"+this.engine.app.indexPage+"?route="+encodeURIComponent(t)+"}"}};e.prototype.didPush=function(t){var e=this;var i=t.routeId;this.thePushingRouteId=i;var n=t.name;wx.navigateTo({url:this.encodeRelativePath(n,t.params),fail:function(){wx.navigateTo({url:e.encodeIndexPath(n,t.params)})}})};e.prototype.didReplace=function(t){var e=this;var i=t.routeId;this.thePushingRouteId=i;var n=t.name;wx.redirectTo({url:this.encodeRelativePath(n,t.params),fail:function(){wx.redirectTo({url:e.encodeIndexPath(n,t.params)})}})};e.prototype.didPop=function(){wx.navigateBack()};return e}(o);i.WXRouter=a},{"./page":40}],42:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:true});i.WindowInfo=void 0;var n=t("./env");var o=function(){function t(t){this.engine=t}t.prototype.updateWindowInfo=function(){if(n.MPEnv.platformType===n.PlatformType.wxMiniProgram){this.engine.sendMessage(JSON.stringify({type:"window_info",message:{window:{width:wx.getSystemInfoSync().screenWidth,height:wx.getSystemInfoSync().screenHeight,padding:{top:wx.getSystemInfoSync().statusBarHeight,bottom:wx.getSystemInfoSync().screenHeight-wx.getSystemInfoSync().safeArea.bottom}},devicePixelRatio:wx.getSystemInfoSync().pixelRatio}}))}else{this.engine.sendMessage(JSON.stringify({type:"window_info",message:{window:{width:document.body.clientWidth,height:window.innerHeight,padding:{top:0,bottom:0}},devicePixelRatio:devicePixelRatio}}))}};return t}();i.WindowInfo=o},{"./env":36}]},{},[37])(37)});
