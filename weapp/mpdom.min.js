(function(e){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=e()}else if(typeof define==="function"&&define.amd){define([],e)}else{var t;if(typeof window!=="undefined"){t=window}else if(typeof global!=="undefined"){t=global}else if(typeof self!=="undefined"){t=self}else{t=this}t.MPDOM=e()}})(function(){var define,module,exports;return function(){function c(r,s,a){function u(n,e){if(!s[n]){if(!r[n]){var t="function"==typeof require&&require;if(!e&&t)return t(n,!0);if(l)return l(n,!0);var i=new Error("Cannot find module '"+n+"'");throw i.code="MODULE_NOT_FOUND",i}var o=s[n]={exports:{}};r[n][0].call(o.exports,function(e){var t=r[n][1][e];return u(t||e)},o,o.exports,c,r,s,a)}return s[n].exports}for(var l="function"==typeof require&&require,e=0;e<a.length;e++)u(a[e]);return u}return c}()({1:[function(e,t,n){"use strict";var o=this&&this.__awaiter||function(e,s,n,a){function u(t){return t instanceof n?t:new n(function(e){e(t)})}return new(n||(n=Promise))(function(t,n){function i(e){try{r(a.next(e))}catch(e){n(e)}}function o(e){try{r(a["throw"](e))}catch(e){n(e)}}function r(e){e.done?t(e.value):u(e.value).then(i,o)}r((a=a.apply(e,s||[])).next())})};var r=this&&this.__generator||function(e,n){var i={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},o,r,s,t;return t={next:a(0),throw:a(1),return:a(2)},typeof Symbol==="function"&&(t[Symbol.iterator]=function(){return this}),t;function a(t){return function(e){return u([t,e])}}function u(t){if(o)throw new TypeError("Generator is already executing.");while(i)try{if(o=1,r&&(s=t[0]&2?r["return"]:t[0]?r["throw"]||((s=r["return"])&&s.call(r),0):r.next)&&!(s=s.call(r,t[1])).done)return s;if(r=0,s)t=[t[0]&2,s.value];switch(t[0]){case 0:case 1:s=t;break;case 4:i.label++;return{value:t[1],done:false};case 5:i.label++;r=t[1];t=[0];continue;case 7:t=i.ops.pop();i.trys.pop();continue;default:if(!(s=i.trys,s=s.length>0&&s[s.length-1])&&(t[0]===6||t[0]===2)){i=0;continue}if(t[0]===3&&(!s||t[1]>s[0]&&t[1]<s[3])){i.label=t[1];break}if(t[0]===6&&i.label<s[1]){i.label=s[1];s=t;break}if(s&&i.label<s[2]){i.label=s[2];i.ops.push(t);break}if(s[2])i.ops.pop();i.trys.pop();continue}t=n.call(e,i)}catch(e){t=[6,e];r=0}finally{o=s=0}if(t[0]&5)throw t[1];return{value:t[0]?t[1]:void 0,done:true}}};Object.defineProperty(n,"__esModule",{value:true});n.WXApp=n.BrowserApp=void 0;var s=e("./page");var i=e("./router");var a=function(){function e(e,t){this.rootElement=e;this.engine=t;this.router=new i.BrowserRouter(this.engine);t.app=this;this.setupPageScrollListener()}e.prototype.setupPageScrollListener=function(){var n=this;document.addEventListener("scroll",function(){var e;if(document.documentElement.scrollHeight>innerHeight&&window.pageYOffset+innerHeight>=document.documentElement.scrollHeight){var t=((e=n.engine.app)===null||e===void 0?void 0:e.router).history;t[t.length-1].item.onReachBottom()}})};e.prototype.setupFirstPage=function(n){var i;return o(this,void 0,void 0,function(){var t;return r(this,function(e){switch(e.label){case 0:t=new s.Page(this.rootElement,this.engine,n);this.router.history.push({item:t,scrollPosition:0});return[4,t.ready()];case 1:e.sent();this.router.didSetupFirst(t.viewId,(i=n===null||n===void 0?void 0:n.route)!==null&&i!==void 0?i:"/");return[2]}})})};return e}();n.BrowserApp=a;var u=function(){function e(e,t){this.indexPage=e;this.engine=t;this.router=new i.WXRouter(this.engine);t.app=this}return e}();n.WXApp=u},{"./page":38,"./router":39}],2:[function(e,t,n){"use strict";var i=this&&this.__extends||function(){var i=function(e,t){i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n]};return i(e,t)};return function(e,t){i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();Object.defineProperty(n,"__esModule",{value:true});n.AbsorbPointer=void 0;var o=e("../../env");var r=e("../component_view");var s=function(t){i(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}e.prototype.elementType=function(){if(o.MPEnv.platformType==o.PlatformType.wxMiniProgram){return"catchclick"}else{return"div"}};e.prototype.setAttributes=function(e){t.prototype.setAttributes.call(this,e);this.htmlElement.onclick=function(e){if(e)e.stopPropagation()}};return e}(r.ComponentView);n.AbsorbPointer=s},{"../../env":34,"../component_view":23}],3:[function(e,t,n){"use strict";var i=this&&this.__extends||function(){var i=function(e,t){i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n]};return i(e,t)};return function(e,t){i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();Object.defineProperty(n,"__esModule",{value:true});n.ClipOval=void 0;var o=e("../component_view");var r=e("../dom_utils");var s=function(t){i(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}e.prototype.setAttributes=function(e){t.prototype.setAttributes.call(this,e);r.setDOMStyle(this.htmlElement,{borderRadius:"50%",overflow:"hidden"})};return e}(o.ComponentView);n.ClipOval=s},{"../component_view":23,"../dom_utils":24}],4:[function(e,t,n){"use strict";var i=this&&this.__extends||function(){var i=function(e,t){i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n]};return i(e,t)};return function(e,t){i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();Object.defineProperty(n,"__esModule",{value:true});n.ClipRRect=void 0;var o=e("../component_view");var u=e("../dom_utils");var l=e("../utils");var r=function(a){i(e,a);function e(){return a!==null&&a.apply(this,arguments)||this}e.prototype.setAttributes=function(e){var t,n,i,o,r;a.prototype.setAttributes.call(this,e);var s=e.borderRadius?l.cssBorderRadius(e.borderRadius):{};if(s.borderRadius){u.setDOMStyle(this.htmlElement,{borderRadius:(t=s.borderRadius)!==null&&t!==void 0?t:"unset",overflow:"hidden"})}else{u.setDOMStyle(this.htmlElement,{borderTopLeftRadius:(n=s.borderTopLeftRadius)!==null&&n!==void 0?n:"unset",borderTopRightRadius:(i=s.borderTopRightRadius)!==null&&i!==void 0?i:"unset",borderBottomLeftRadius:(o=s.borderBottomLeftRadius)!==null&&o!==void 0?o:"unset",borderBottomRightRadius:(r=s.borderBottomRightRadius)!==null&&r!==void 0?r:"unset",overflow:"hidden"})}};return e}(o.ComponentView);n.ClipRRect=r},{"../component_view":23,"../dom_utils":24,"../utils":29}],5:[function(e,t,n){"use strict";var i=this&&this.__extends||function(){var i=function(e,t){i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n]};return i(e,t)};return function(e,t){i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();Object.defineProperty(n,"__esModule",{value:true});n.ColoredBox=void 0;var o=e("../component_view");var r=e("../dom_utils");var s=e("../utils");var a=function(t){i(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}e.prototype.setAttributes=function(e){t.prototype.setAttributes.call(this,e);r.setDOMStyle(this.htmlElement,{backgroundColor:e.color?s.cssColor(e.color):"unset"})};return e}(o.ComponentView);n.ColoredBox=a},{"../component_view":23,"../dom_utils":24,"../utils":29}],6:[function(e,t,n){"use strict";var o=this&&this.__extends||function(){var i=function(e,t){i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n]};return i(e,t)};return function(e,t){i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();var s=this&&this.__awaiter||function(e,s,n,a){function u(t){return t instanceof n?t:new n(function(e){e(t)})}return new(n||(n=Promise))(function(t,n){function i(e){try{r(a.next(e))}catch(e){n(e)}}function o(e){try{r(a["throw"](e))}catch(e){n(e)}}function r(e){e.done?t(e.value):u(e.value).then(i,o)}r((a=a.apply(e,s||[])).next())})};var a=this&&this.__generator||function(e,n){var i={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},o,r,s,t;return t={next:a(0),throw:a(1),return:a(2)},typeof Symbol==="function"&&(t[Symbol.iterator]=function(){return this}),t;function a(t){return function(e){return u([t,e])}}function u(t){if(o)throw new TypeError("Generator is already executing.");while(i)try{if(o=1,r&&(s=t[0]&2?r["return"]:t[0]?r["throw"]||((s=r["return"])&&s.call(r),0):r.next)&&!(s=s.call(r,t[1])).done)return s;if(r=0,s)t=[t[0]&2,s.value];switch(t[0]){case 0:case 1:s=t;break;case 4:i.label++;return{value:t[1],done:false};case 5:i.label++;r=t[1];t=[0];continue;case 7:t=i.ops.pop();i.trys.pop();continue;default:if(!(s=i.trys,s=s.length>0&&s[s.length-1])&&(t[0]===6||t[0]===2)){i=0;continue}if(t[0]===3&&(!s||t[1]>s[0]&&t[1]<s[3])){i.label=t[1];break}if(t[0]===6&&i.label<s[1]){i.label=s[1];s=t;break}if(s&&i.label<s[2]){i.label=s[2];i.ops.push(t);break}if(s[2])i.ops.pop();i.trys.pop();continue}t=n.call(e,i)}catch(e){t=[6,e];r=0}finally{o=s=0}if(t[0]&5)throw t[1];return{value:t[0]?t[1]:void 0,done:true}}};Object.defineProperty(n,"__esModule",{value:true});n.CustomPaint=n.MPDrawable=void 0;var i=e("../component_view");var r=e("../dom_utils");var u=e("../utils");var l=function(){function e(e){this.engine=e;this.decodedDrawables={}}e.prototype.decodeDrawable=function(i){return s(this,void 0,void 0,function(){var t,t,n;return a(this,function(e){switch(e.label){case 0:e.trys.push([0,6,,7]);if(!(i.type==="networkImage"))return[3,2];return[4,this.decodeNetworkImage(i.url,i.target)];case 1:t=e.sent();this.engine.sendMessage(JSON.stringify({type:"decode_drawable",message:{event:"onDecode",target:i.target,width:t.width,height:t.height}}));return[3,5];case 2:if(!(i.type==="memoryImage"))return[3,4];return[4,this.decodeMemoryImage(i.data,i.target)];case 3:t=e.sent();this.engine.sendMessage(JSON.stringify({type:"decode_drawable",message:{event:"onDecode",target:i.target,width:t.width,height:t.height}}));return[3,5];case 4:throw new Error("Unknown drawable type.");case 5:return[3,7];case 6:n=e.sent();this.engine.sendMessage(JSON.stringify({type:"decode_drawable",message:{event:"onError",target:i.target,error:n===null||n===void 0?void 0:n.toString()}}));return[3,7];case 7:return[2]}})})};e.prototype.decodeNetworkImage=function(o,r){return s(this,void 0,void 0,function(){var i=this;return a(this,function(e){return[2,new Promise(function(e,t){var n=document.createElement("img");n.onload=function(){i.decodedDrawables[r]=n;e({width:n.width,height:n.height})};n.onerror=function(){t("")};n.src=o})]})})};e.prototype.decodeMemoryImage=function(o,r){return s(this,void 0,void 0,function(){var i=this;return a(this,function(e){return[2,new Promise(function(e,t){var n=document.createElement("img");n.onload=function(){i.decodedDrawables[r]=n;e({width:n.width,height:n.height})};n.onerror=function(){t("")};n.src="data:text/plain;base64,"+o})]})})};return e}();n.MPDrawable=l;var c=function(i){o(e,i);function e(){var e=i!==null&&i.apply(this,arguments)||this;e.canvasWidth=0;e.canvasHeight=0;return e}e.prototype.elementType=function(){return"canvas"};e.prototype.setConstraints=function(e){if(!e)return;var t=e.x;var n=e.y;var i=e.w;var o=e.h;if(typeof t==="number"&&typeof n==="number"&&typeof i==="number"&&typeof o==="number"){r.setDOMStyle(this.htmlElement,{left:t+"px",top:n+"px",width:i+"px",height:o+"px"});if(this.canvasWidth!==i||this.canvasHeight!=o){this.canvasWidth=i;this.canvasHeight=o;this.htmlElement.setAttribute("width",this.canvasWidth.toString());this.htmlElement.setAttribute("height",this.canvasHeight.toString())}}};e.prototype.setAttributes=function(e){var t=this;i.prototype.setAttributes.call(this,e);var n=this.htmlElement.getContext("2d");if(!n)return;n.save();e.commands.forEach(function(e){if(e.action==="drawRect"){t.drawRect(n,e)}else if(e.action==="drawPath"){t.drawPath(n,e)}else if(e.action==="drawDRRect"){t.drawDRRect(n,e)}else if(e.action==="clipPath"){t.drawPath(n,e)}else if(e.action==="drawColor"){t.drawColor(n,e)}else if(e.action==="drawImage"){t.drawImage(n,e)}else if(e.action==="drawImageRect"){t.drawImageRect(n,e)}else if(e.action==="restore"){n.restore()}else if(e.action==="rotate"){n.rotate(e.radians)}else if(e.action==="save"){n.save()}else if(e.action==="scale"){n.scale(e.sx,e.sy)}else if(e.action==="skew"){n.transform(1,e.sy,e.sx,1,0,0)}else if(e.action==="transform"){n.transform(e.a,e.b,e.c,e.d,e.tx,e.ty)}else if(e.action==="translate"){n.translate(e.dx,e.dy)}});n.restore()};e.prototype.drawRect=function(e,t){this.setPaint(e,t.paint);if(t.paint.style==="PaintingStyle.fill"){e.fillRect(t.x,t.y,t.width,t.height)}else{e.strokeRect(t.x,t.y,t.width,t.height)}};e.prototype.drawPath=function(e,t){this.setPaint(e,t.paint);this.drawRealPath(e,t.path);if(t.action==="clipPath"){e.clip()}else if(t.paint.style==="PaintingStyle.fill"){e.fill()}else{e.stroke()}};e.prototype.drawDRRect=function(e,t){var n=document.createElement("canvas");n.width=e.canvas.width;n.height=e.canvas.height;var i=n.getContext("2d");this.setPaint(i,t.paint);this.drawRealPath(i,t.outer);if(t.paint.style==="PaintingStyle.fill"){i.fill()}else{i.stroke()}i.save();i.fillStyle="white";i.globalCompositeOperation="xor";this.drawRealPath(i,t.inner);i.fill();i.restore();e.drawImage(n,0,0)};e.prototype.drawRealPath=function(t,e){t.beginPath();e.commands.forEach(function(e){if(e.action==="moveTo"){t.moveTo(e.x,e.y)}else if(e.action==="lineTo"){t.lineTo(e.x,e.y)}else if(e.action==="quadraticBezierTo"){t.quadraticCurveTo(e.x1,e.y1,e.x2,e.y2)}else if(e.action==="cubicTo"){t.bezierCurveTo(e.x1,e.y1,e.x2,e.y2,e.x3,e.y3)}else if(e.action==="arcTo"){t.ellipse(e.x,e.y,e.width/2,e.height/2,0,e.startAngle,e.startAngle+e.sweepAngle,e.sweepAngle<0)}else if(e.action==="arcToPoint"){t.arcTo(e.arcControlX,e.arcControlY,e.arcEndX,e.arcEndY,e.radiusX)}else if(e.action==="close"){t.closePath()}})};e.prototype.drawColor=function(e,t){if(t.blendMode==="BlendMode.clear"){e.clearRect(0,0,e.canvas.width,e.canvas.height)}else{e.fillStyle=u.cssColor(t.color);e.fillRect(0,0,e.canvas.width,e.canvas.height)}};e.prototype.drawImage=function(e,t){this.setPaint(e,t.paint);var n=this.engine.drawable.decodedDrawables[t.drawable];if(n){e.drawImage(n,t.dx,t.dy)}};e.prototype.drawImageRect=function(e,t){this.setPaint(e,t.paint);var n=this.engine.drawable.decodedDrawables[t.drawable];if(n){e.drawImage(n,t.srcX,t.srcY,t.srcW,t.srcH,t.dstX,t.dstY,t.dstW,t.dstH)}};e.prototype.setPaint=function(e,t){var n;if(!t)return;e.lineWidth=t.strokeWidth;e.miterLimit=t.strokeMiterLimit;e.lineCap=t.strokeCap.replace("StrokeCap.","");e.lineJoin=t.strokeJoin.replace("StrokeJoin.","");if(t.style==="PaintingStyle.fill"){e.fillStyle=u.cssColor(t.color);e.strokeStyle="transparent"}else{e.fillStyle="transparent";e.strokeStyle=u.cssColor(t.color)}e.globalAlpha=(n=t.alpha)!==null&&n!==void 0?n:1};return e}(i.ComponentView);n.CustomPaint=c},{"../component_view":23,"../dom_utils":24,"../utils":29}],7:[function(e,t,n){"use strict";var i=this&&this.__extends||function(){var i=function(e,t){i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n]};return i(e,t)};return function(e,t){i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();Object.defineProperty(n,"__esModule",{value:true});n.CustomScrollView=void 0;var o=e("../component_view");var r=e("../dom_utils");var s=e("../utils");var a=function(o){i(e,o);function e(e){var t=o.call(this,e)||this;t.wrapperHtmlElement=t.document.createElement("div");t.viewWidth=0;t.viewHeight=0;t.htmlElement.appendChild(t.wrapperHtmlElement);return t}e.prototype.setConstraints=function(e){o.prototype.setConstraints.call(this,e);this.viewWidth=e.w;this.viewHeight=e.h};e.prototype.setChildren=function(e){o.prototype.setChildren.call(this,e);for(var t=0;t<this.subviews.length;t++){var n=this.subviews[t];n.setRelativeConstraint();if(e[t].name==="sliver_list"){}else if(e[t].name==="sliver_grid"){n.viewWidth=this.viewWidth;n.viewHeight=this.viewHeight;n.resetChildrenLayout()}else{var i=s.cssSizeFromMPElement(e[t]);r.setDOMStyle(n.htmlElement,{width:i.width+"px",height:i.height+"px"})}}};e.prototype.setAttributes=function(e){o.prototype.setAttributes.call(this,e);var t={};var n={};t.display="flex";if(e.scrollDirection==="Axis.horizontal"){t.flexDirection="row";t.width="max-content";t.height="unset";n.overflowX="scroll";n.overflowY="hidden";if(this.engine.pageMode&&e.isRoot){n.width="unset"}}else{t.flexDirection="column";t.width="unset";t.height="max-content";n.overflowY="scroll";n.overflowX="hidden";if(this.engine.pageMode&&e.isRoot){n.height="unset"}}r.setDOMStyle(this.wrapperHtmlElement,t);r.setDOMStyle(this.htmlElement,n)};e.prototype.addSubview=function(e){this.subviews.push(e);this.wrapperHtmlElement.appendChild(e.htmlElement)};return e}(o.ComponentView);n.CustomScrollView=a},{"../component_view":23,"../dom_utils":24,"../utils":29}],8:[function(e,t,n){"use strict";var i=this&&this.__extends||function(){var i=function(e,t){i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n]};return i(e,t)};return function(e,t){i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();Object.defineProperty(n,"__esModule",{value:true});n.DecoratedBox=void 0;var o=e("../component_view");var m=e("../dom_utils");var g=e("../utils");var r=function(v){i(e,v);function e(){return v!==null&&v.apply(this,arguments)||this}e.prototype.setAttributes=function(t){var n=this;var e,i,o,r,s,a,u,l,c;v.prototype.setAttributes.call(this,t);var p={};if(t.color){p.backgroundColor=g.cssColor(t.color)}else{p.backgroundColor="unset"}if(t.image){p.backgroundImage='url("'+function(){if(t.image.src){return t.image.src}else if(t.image.assetName){if(n.engine.debugger){var e=function(){if(t.assetPkg){return"http://"+n.engine.debugger.serverAddr+"/assets/packages/"+t.assetPkg+"/"+t.assetName}else{return"http://"+n.engine.debugger.serverAddr+"/assets/"+t.assetName}}();n.htmlElement.src=e}}}()+'")';if(t.image.fit==="BoxFit.cover"){p.backgroundSize="cover"}else{p.backgroundSize="contain"}}if((e=t.decoration)===null||e===void 0?void 0:e.gradient){if(p.backgroundImage){p.backgroundImage=g.cssGradient(t.decoration.gradient)+","+p.backgroundImage}else{p.background=g.cssGradient(t.decoration.gradient)}}if((o=(i=t.decoration)===null||i===void 0?void 0:i.boxShadow)===null||o===void 0?void 0:o[0]){var d=(s=(r=t.decoration)===null||r===void 0?void 0:r.boxShadow)===null||s===void 0?void 0:s[0];p.boxShadow=((a=g.cssOffset(d.offset))===null||a===void 0?void 0:a.dx)+"px "+((u=g.cssOffset(d.offset))===null||u===void 0?void 0:u.dy)+"px "+d.blurRadius+"px "+d.spreadRadius+"px "+g.cssColor(d.color)}if((l=t.decoration)===null||l===void 0?void 0:l.borderRadius){var f=g.cssBorderRadius(t.decoration.borderRadius);for(var h in f){p[h]=f[h]}}if((c=t.decoration)===null||c===void 0?void 0:c.border){var f=g.cssBorder(t.decoration.border);for(var h in f){p[h]=f[h]}}m.setDOMStyle(this.htmlElement,p)};return e}(o.ComponentView);n.DecoratedBox=r},{"../component_view":23,"../dom_utils":24,"../utils":29}],9:[function(e,t,n){"use strict";var i=this&&this.__extends||function(){var i=function(e,t){i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n]};return i(e,t)};return function(e,t){i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();Object.defineProperty(n,"__esModule",{value:true});n.Flexible=void 0;var o=e("../component_view");var r=e("../dom_utils");var s=function(e){i(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.setConstraints=function(e){if(!e)return;this.constraints=e;var t=e.x;var n=e.y;var i=e.w;var o=e.h;if(typeof t==="number"&&typeof n==="number"&&typeof i==="number"&&typeof o==="number"){r.setDOMStyle(this.htmlElement,{left:"0px",top:"0px",width:"0px",height:"0px"})}};return t}(o.ComponentView);n.Flexible=s},{"../component_view":23,"../dom_utils":24}],10:[function(e,t,n){"use strict";var i=this&&this.__extends||function(){var i=function(e,t){i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n]};return i(e,t)};return function(e,t){i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();Object.defineProperty(n,"__esModule",{value:true});n.GestureDetector=void 0;var o=e("../component_view");var r=e("../dom_utils");var s=function(n){i(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}e.prototype.setConstraints=function(e){if(!e)return;this.constraints=e;var t=e.x;var n=e.y;var i=e.w;var o=e.h;if(typeof t==="number"&&typeof n==="number"&&typeof i==="number"&&typeof o==="number"){r.setDOMStyle(this.htmlElement,{left:"0px",top:"0px",width:"0px",height:"0px"})}};e.prototype.setAttributes=function(e){var t=this;n.prototype.setAttributes.call(this,e);this.htmlElement.onclick=function(){t.engine.sendMessage(JSON.stringify({type:"gesture_detector",message:{event:"onTap",target:e.onTap}}))}};return e}(o.ComponentView);n.GestureDetector=s},{"../component_view":23,"../dom_utils":24}],11:[function(e,t,n){"use strict";var i=this&&this.__extends||function(){var i=function(e,t){i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n]};return i(e,t)};return function(e,t){i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();Object.defineProperty(n,"__esModule",{value:true});n.GridView=void 0;var o=e("../component_view");var h=e("../dom_utils");var f=e("../utils");var r=function(d){i(e,d);function e(e){var t=d.call(this,e)||this;t.wrapperHtmlElement=t.document.createElement("div");t.isHorizontal=false;t.children=[];t.viewWidth=0;t.viewHeight=0;t.crossAxisSpacing=0;t.mainAxisSpacing=0;t.htmlElement.appendChild(t.wrapperHtmlElement);return t}e.prototype.setConstraints=function(e){d.prototype.setConstraints.call(this,e);this.viewWidth=e.w;this.viewHeight=e.h};e.prototype.setChildren=function(e){d.prototype.setChildren.call(this,e);this.children=e;for(var t=0;t<this.subviews.length;t++){var n=this.subviews[t];n.setRelativeConstraint()}this.resetChildrenLayout()};e.prototype.setAttributes=function(e){var t,n,i,o,r,s,a,u;d.prototype.setAttributes.call(this,e);this.gridDelegate=e.gridDelegate;this.crossAxisSpacing=(n=(t=e.gridDelegate)===null||t===void 0?void 0:t.crossAxisSpacing)!==null&&n!==void 0?n:0;this.mainAxisSpacing=(o=(i=e.gridDelegate)===null||i===void 0?void 0:i.mainAxisSpacing)!==null&&o!==void 0?o:0;var l={};var c={};l.display="flex";l.flexWrap="wrap";if(e.scrollDirection==="Axis.horizontal"){this.isHorizontal=true;l.flexDirection="column";l.width="max-content";l.height="calc(100% + "+this.crossAxisSpacing+"px)";c.overflowX="scroll";c.overflowY="hidden";if(this.engine.pageMode&&e.isRoot){c.width="unset"}}else{this.isHorizontal=false;l.flexDirection="row";l.width="calc(100% + "+this.crossAxisSpacing+"px)";l.height="max-content";c.overflowY="scroll";c.overflowX="hidden";if(this.engine.pageMode&&e.isRoot){c.height="unset"}}if(e.padding){var p=f.cssPadding(e.padding);this.padding=p;c.paddingTop=(r=p.paddingTop)!==null&&r!==void 0?r:"";c.paddingLeft=(s=p.paddingLeft)!==null&&s!==void 0?s:"";c.paddingBottom=(a=p.paddingBottom)!==null&&a!==void 0?a:"";c.paddingRight=(u=p.paddingRight)!==null&&u!==void 0?u:""}else{this.padding={};c.paddingTop="";c.paddingLeft="";c.paddingBottom="";c.paddingRight=""}h.setDOMStyle(this.wrapperHtmlElement,l);h.setDOMStyle(this.htmlElement,c);this.resetChildrenLayout()};e.prototype.resetChildrenLayout=function(){var e;if(((e=this.gridDelegate)===null||e===void 0?void 0:e.classname)==="SliverWaterfallDelegate"){this.resetWaterfallChildrenLayout();return}for(var t=0;t<this.subviews.length;t++){var n=this.subviews[t];if(this.isHorizontal){h.setDOMStyle(n.htmlElement,{marginBottom:this.crossAxisSpacing+"px",marginRight:this.mainAxisSpacing+"px"})}else{h.setDOMStyle(n.htmlElement,{marginRight:this.crossAxisSpacing+"px",marginBottom:this.mainAxisSpacing+"px"})}}};e.prototype.resetWaterfallChildrenLayout=function(){var l=this;var e,t,n,i;var o=this.isHorizontal?this.viewHeight:this.viewWidth-parseFloat((t=(e=this.padding)===null||e===void 0?void 0:e.paddingLeft)!==null&&t!==void 0?t:"0.0")-parseFloat((i=(n=this.padding)===null||n===void 0?void 0:n.paddingRight)!==null&&i!==void 0?i:"0.0");var c=(o-this.gridDelegate.crossAxisSpacing*(this.gridDelegate.crossAxisCount-1))/this.gridDelegate.crossAxisCount;var p=0;var d=[];var f=0;var r=this.children.map(function(e,t){var n,i;var o=(i=(n=e.attributes)===null||n===void 0?void 0:n.height)!==null&&i!==void 0?i:0;var r;for(var s=p;s<l.gridDelegate.crossAxisCount;s++){var a=s+1>=l.gridDelegate.crossAxisCount?0:s+1;if(d[s]&&d[a]){if(d[a].y+d[a].height<d[s].y+d[s].height){p=a;break}else{p=s;break}}else{p=s;break}}if(d[p]){r=d[p].y+d[p].height;if(t>=l.gridDelegate.crossAxisCount){r+=l.gridDelegate.mainAxisSpacing}}else{r=0}var u={x:c*p+p*l.gridDelegate.crossAxisSpacing,y:r,width:c,height:o};d[p]=u;p=(p+1)%l.gridDelegate.crossAxisCount;f=Math.max(r+o,f);return u});var s={};s.position="relative";s.flexFlow="";s.width="unset";s.height=f+"px";h.setDOMStyle(this.wrapperHtmlElement,s);this.subviews.forEach(function(e,t){var n={};n.position="absolute";n.left=r[t].x+"px";n.top=r[t].y+"px";n.width=r[t].width+"px";n.height=r[t].height+"px";h.setDOMStyle(e.htmlElement,n)})};e.prototype.addSubview=function(e){this.subviews.push(e);this.wrapperHtmlElement.appendChild(e.htmlElement)};return e}(o.ComponentView);n.GridView=r},{"../component_view":23,"../dom_utils":24,"../utils":29}],12:[function(e,t,n){"use strict";var i=this&&this.__extends||function(){var i=function(e,t){i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n]};return i(e,t)};return function(e,t){i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();Object.defineProperty(n,"__esModule",{value:true});n.IgnorePointer=void 0;var o=e("../component_view");var r=e("../dom_utils");var s=function(t){i(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}e.prototype.setAttributes=function(e){t.prototype.setAttributes.call(this,e);r.setDOMStyle(this.htmlElement,{pointerEvents:"none"})};return e}(o.ComponentView);n.IgnorePointer=s},{"../component_view":23,"../dom_utils":24}],13:[function(e,t,n){"use strict";var o=this&&this.__extends||function(){var i=function(e,t){i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n]};return i(e,t)};return function(e,t){i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();Object.defineProperty(n,"__esModule",{value:true});n.Image=void 0;var i=e("../component_view");var r=e("../dom_utils");var s=function(i){o(e,i);function e(){return i!==null&&i.apply(this,arguments)||this}e.prototype.elementType=function(){return"img"};e.prototype.setAttributes=function(e){var t=this;i.prototype.setAttributes.call(this,e);r.setDOMStyle(this.htmlElement,{objectFit:function(){if(!e.fit)return"cover";switch(e.fit){case"BoxFit.fill":return"fill";case"BoxFit.contain":return"contain";case"BoxFit.cover":return"cover";case"BoxFit.fitWidth":return"scale-down";case"BoxFit.fitHeight":return"scale-down";case"BoxFit.none":return"none";default:return"contain"}}()});if(e.src){this.htmlElement.setAttribute("src",e.src)}else if(e.assetName){if(this.engine.debugger){var n=function(){if(e.assetPkg){return"http://"+t.engine.debugger.serverAddr+"/assets/packages/"+e.assetPkg+"/"+e.assetName}else{return"http://"+t.engine.debugger.serverAddr+"/assets/"+e.assetName}}();this.htmlElement.src=n}}};return e}(i.ComponentView);n.Image=s},{"../component_view":23,"../dom_utils":24}],14:[function(e,t,n){"use strict";var i=this&&this.__extends||function(){var i=function(e,t){i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n]};return i(e,t)};return function(e,t){i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();Object.defineProperty(n,"__esModule",{value:true});n.ListView=void 0;var o=e("../component_view");var l=e("../dom_utils");var c=e("../utils");var r=function(u){i(e,u);function e(e){var t=u.call(this,e)||this;t.wrapperHtmlElement=t.document.createElement("div");t.htmlElement.appendChild(t.wrapperHtmlElement);return t}e.prototype.setChildren=function(e){u.prototype.setChildren.call(this,e);for(var t=0;t<this.subviews.length;t++){var n=this.subviews[t];n.setRelativeConstraint()}};e.prototype.setAttributes=function(e){var t,n,i,o;u.prototype.setAttributes.call(this,e);var r={};var s={};r.display="flex";if(e.scrollDirection==="Axis.horizontal"){r.flexDirection="row";r.width="max-content";r.height="unset";s.overflowX="scroll";s.overflowY="hidden";if(this.engine.pageMode&&e.isRoot){s.width="unset"}}else{r.flexDirection="column";r.width="unset";r.height="max-content";s.overflowY="scroll";s.overflowX="hidden";if(this.engine.pageMode&&e.isRoot){s.height="unset"}}if(e.padding){var a=c.cssPadding(e.padding);s.paddingTop=(t=a.paddingTop)!==null&&t!==void 0?t:"";s.paddingLeft=(n=a.paddingLeft)!==null&&n!==void 0?n:"";s.paddingBottom=(i=a.paddingBottom)!==null&&i!==void 0?i:"";s.paddingRight=(o=a.paddingRight)!==null&&o!==void 0?o:""}else{s.paddingTop="";s.paddingLeft="";s.paddingBottom="";s.paddingRight=""}l.setDOMStyle(this.wrapperHtmlElement,r);l.setDOMStyle(this.htmlElement,s)};e.prototype.addSubview=function(e){this.subviews.push(e);this.wrapperHtmlElement.appendChild(e.htmlElement)};return e}(o.ComponentView);n.ListView=r},{"../component_view":23,"../dom_utils":24,"../utils":29}],15:[function(e,t,n){"use strict";var i=this&&this.__extends||function(){var i=function(e,t){i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n]};return i(e,t)};return function(e,t){i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();Object.defineProperty(n,"__esModule",{value:true});n.Offstage=void 0;var o=e("../component_view");var r=e("../dom_utils");var s=function(t){i(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}e.prototype.setAttributes=function(e){t.prototype.setAttributes.call(this,e);r.setDOMStyle(this.htmlElement,{display:e.offstage?"none":"unset"})};return e}(o.ComponentView);n.Offstage=s},{"../component_view":23,"../dom_utils":24}],16:[function(e,t,n){"use strict";var i=this&&this.__extends||function(){var i=function(e,t){i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n]};return i(e,t)};return function(e,t){i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();Object.defineProperty(n,"__esModule",{value:true});n.Opacity=void 0;var o=e("../component_view");var r=e("../dom_utils");var s=function(t){i(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}e.prototype.setAttributes=function(e){t.prototype.setAttributes.call(this,e);r.setDOMStyle(this.htmlElement,{opacity:e.opacity.toString()})};return e}(o.ComponentView);n.Opacity=s},{"../component_view":23,"../dom_utils":24}],17:[function(e,t,n){"use strict";var i=this&&this.__extends||function(){var i=function(e,t){i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n]};return i(e,t)};return function(e,t){i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();Object.defineProperty(n,"__esModule",{value:true});n.Overlay=void 0;var o=e("../../env");var r=e("../component_view");var s=e("../dom_utils");var a=function(n){i(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}e.prototype.elementType=function(){if(o.MPEnv.platformType==o.PlatformType.wxMiniProgram){return"catchmove"}else{return"div"}};e.prototype.setAttributes=function(e){var t=this;n.prototype.setAttributes.call(this,e);if(o.MPEnv.platformType==o.PlatformType.wxMiniProgram){}else{this.htmlElement.addEventListener("touchmove",function(e){e.preventDefault()})}s.setDOMStyle(this.htmlElement,{position:"fixed"});if(e.onBackgroundTap){this.htmlElement.onclick=function(){t.engine.sendMessage(JSON.stringify({type:"overlay",message:{event:"onBackgroundTap",target:e.onBackgroundTap}}))}}else{this.htmlElement.onclick=null}};return e}(r.ComponentView);n.Overlay=a},{"../../env":34,"../component_view":23,"../dom_utils":24}],18:[function(e,t,n){"use strict";var i=this&&this.__extends||function(){var i=function(e,t){i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n]};return i(e,t)};return function(e,t){i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();Object.defineProperty(n,"__esModule",{value:true});n.Positioned=void 0;var o=e("../component_view");var r=e("../dom_utils");var s=function(e){i(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.setConstraints=function(e){if(!e)return;this.constraints=e;var t=e.x;var n=e.y;var i=e.w;var o=e.h;if(typeof t==="number"&&typeof n==="number"&&typeof i==="number"&&typeof o==="number"){r.setDOMStyle(this.htmlElement,{left:"0px",top:"0px",width:"0px",height:"0px"})}};return t}(o.ComponentView);n.Positioned=s},{"../component_view":23,"../dom_utils":24}],19:[function(e,t,n){"use strict";var r=this&&this.__extends||function(){var i=function(e,t){i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n]};return i(e,t)};return function(e,t){i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();var a=this&&this.__awaiter||function(e,s,n,a){function u(t){return t instanceof n?t:new n(function(e){e(t)})}return new(n||(n=Promise))(function(t,n){function i(e){try{r(a.next(e))}catch(e){n(e)}}function o(e){try{r(a["throw"](e))}catch(e){n(e)}}function r(e){e.done?t(e.value):u(e.value).then(i,o)}r((a=a.apply(e,s||[])).next())})};var u=this&&this.__generator||function(e,n){var i={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},o,r,s,t;return t={next:a(0),throw:a(1),return:a(2)},typeof Symbol==="function"&&(t[Symbol.iterator]=function(){return this}),t;function a(t){return function(e){return u([t,e])}}function u(t){if(o)throw new TypeError("Generator is already executing.");while(i)try{if(o=1,r&&(s=t[0]&2?r["return"]:t[0]?r["throw"]||((s=r["return"])&&s.call(r),0):r.next)&&!(s=s.call(r,t[1])).done)return s;if(r=0,s)t=[t[0]&2,s.value];switch(t[0]){case 0:case 1:s=t;break;case 4:i.label++;return{value:t[1],done:false};case 5:i.label++;r=t[1];t=[0];continue;case 7:t=i.ops.pop();i.trys.pop();continue;default:if(!(s=i.trys,s=s.length>0&&s[s.length-1])&&(t[0]===6||t[0]===2)){i=0;continue}if(t[0]===3&&(!s||t[1]>s[0]&&t[1]<s[3])){i.label=t[1];break}if(t[0]===6&&i.label<s[1]){i.label=s[1];s=t;break}if(s&&i.label<s[2]){i.label=s[2];i.ops.push(t);break}if(s[2])i.ops.pop();i.trys.pop();continue}t=n.call(e,i)}catch(e){t=[6,e];r=0}finally{o=s=0}if(t[0]&5)throw t[1];return{value:t[0]?t[1]:void 0,done:true}}};Object.defineProperty(n,"__esModule",{value:true});n.WidgetSpan=n.TextSpan=n.RichText=void 0;var i=e("../component_view");var l=e("../dom_utils");var s=e("../utils");var o=function(i){r(e,i);function e(){return i!==null&&i.apply(this,arguments)||this}e.prototype.setConstraints=function(e){i.prototype.setConstraints.call(this,e);var t=e.maxWidth;if(typeof t==="string"){this.maxWidth=parseFloat(t)}else{this.maxWidth=undefined}var n=e.maxHeight;if(typeof n==="string"){this.maxHeight=parseFloat(n)}else{this.maxHeight=undefined}};e.prototype.setAttributes=function(e){var t;i.prototype.setAttributes.call(this,e);l.setDOMStyle(this.htmlElement,{overflow:"hidden",textOverflow:"ellipsis",textAlign:s.cssTextAlign(e.textAlign),display:"-webkit-box",fontSize:"11px",lineHeight:(t=e.height)===null||t===void 0?void 0:t.toString(),overflowWrap:"anywhere",wordBreak:"break-all",wordWrap:"break-word",whiteSpace:"pre-line",inlineSize:e.inline===true?"max-content":"unset",webkitBoxOrient:"vertical",webkitLineClamp:e.maxLines?e.maxLines.toString():"99999"});this.measureId=e.measureId};e.prototype.setChildren=function(n){return a(this,void 0,void 0,function(){var t;return u(this,function(e){switch(e.label){case 0:i.prototype.setChildren.call(this,n);if(!this.measureId)return[3,2];return[4,c.measureText(this.document,this.htmlElement,this.maxWidth,this.maxHeight)];case 1:t=e.sent();this.factory.callbackTextMeasureResult(this.measureId,t);e.label=2;case 2:return[2]}})})};return e}(i.ComponentView);n.RichText=o;var c=function(){function e(){}e.measureText=function(i,o,r,s){return a(this,void 0,void 0,function(){var t,n;return u(this,function(e){switch(e.label){case 0:t=o.cloneNode(true);l.setDOMStyle(t,{position:"absolute",opacity:"0",width:r?"unset":"999999px",maxWidth:r?r+"px":"999999px",height:s?"unset":"999999px",maxHeight:s?s+"px":"999999px"});return[4,i.body.appendChild(t)];case 1:e.sent();return[4,t.getBoundingClientRect()];case 2:n=e.sent();t.remove();return[2,n]}})})};return e}();var p=function(o){r(e,o);function e(){return o!==null&&o.apply(this,arguments)||this}e.prototype.elementType=function(){return"div"};e.prototype.setChildren=function(e){if(e instanceof Array&&e.length>0){o.prototype.setChildren.call(this,e)}};e.prototype.setAttributes=function(e){o.prototype.setAttributes.call(this,e);var t={position:"unset",display:"inline-block"};if(e.style){var n=s.cssTextStyle(e.style);for(var i in n){t[i]=n[i]}}if(e.text){this.htmlElement.innerText=e.text;this.htmlElement.setAttribute("innerText",e.text)}l.setDOMStyle(this.htmlElement,t)};return e}(i.ComponentView);n.TextSpan=p;var d=function(t){r(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}e.prototype.elementType=function(){return"div"};e.prototype.setChildren=function(e){t.prototype.setChildren.call(this,e);if(this.subviews[0]){l.setDOMStyle(this.subviews[0].htmlElement,{position:"relative",display:"inline-flex"})}};e.prototype.setAttributes=function(e){t.prototype.setAttributes.call(this,e);l.setDOMStyle(this.htmlElement,{display:"contents"})};return e}(i.ComponentView);n.WidgetSpan=d},{"../component_view":23,"../dom_utils":24,"../utils":29}],20:[function(e,t,n){"use strict";var i=this&&this.__extends||function(){var i=function(e,t){i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n]};return i(e,t)};return function(e,t){i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();Object.defineProperty(n,"__esModule",{value:true});n.Transform=void 0;var o=e("../component_view");var r=e("../dom_utils");var s=function(t){i(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}e.prototype.setAttributes=function(e){t.prototype.setAttributes.call(this,e);r.setDOMStyle(this.htmlElement,{transform:e.transform})};return e}(o.ComponentView);n.Transform=s},{"../component_view":23,"../dom_utils":24}],21:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:true});n.WebDialogs=void 0;var i=e("../../env");var o=function(){function e(){}e.receivedWebDialogsMessage=function(e,t){if(i.MPEnv.platformType===i.PlatformType.wxMiniProgram){this.wxMiniProgramReceivedWebDialogsMessage(e,t)}else{this.browserMiniProgramReceivedWebDialogsMessage(e,t)}};e.wxMiniProgramReceivedWebDialogsMessage=function(t,n){var e;if(n["params"]["dialogType"]==="alert"){wx.showModal({content:n["params"]["message"],showCancel:false,confirmText:"确定",success:function(){t.sendMessage(JSON.stringify({type:"action",message:{event:"callback",id:n["id"]}}))}})}else if(n["params"]["dialogType"]==="confirm"){wx.showModal({content:n["params"]["message"],cancelText:"取消",confirmText:"确认",success:function(e){t.sendMessage(JSON.stringify({type:"action",message:{event:"callback",id:n["id"],data:e.confirm==true}}))}})}else if(n["params"]["dialogType"]==="prompt"){wx.showModal({title:n["params"]["message"],content:(e=n["params"]["defaultValue"])!==null&&e!==void 0?e:"",editable:true,cancelText:"取消",confirmText:"确认",success:function(e){t.sendMessage(JSON.stringify({type:"action",message:{event:"callback",id:n["id"],data:e.content}}))}})}};e.browserMiniProgramReceivedWebDialogsMessage=function(e,t){if(t["params"]["dialogType"]==="alert"){window.alert(t["params"]["message"]);e.sendMessage(JSON.stringify({type:"action",message:{event:"callback",id:t["id"]}}))}else if(t["params"]["dialogType"]==="confirm"){var n=window.confirm(t["params"]["message"]);e.sendMessage(JSON.stringify({type:"action",message:{event:"callback",id:t["id"],data:n}}))}else if(t["params"]["dialogType"]==="prompt"){var n=window.prompt(t["params"]["message"],t["params"]["defaultValue"]);e.sendMessage(JSON.stringify({type:"action",message:{event:"callback",id:t["id"],data:n}}))}};return e}();n.WebDialogs=o},{"../../env":34}],22:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:true});n.ComponentFactory=void 0;var i=e("./basic/absorb_pointer");var o=e("./basic/clip_oval");var r=e("./basic/clip_r_rect");var s=e("./basic/colored_box");var a=e("./basic/decorated_box");var u=e("./basic/flexible");var c=e("./basic/gesture_detector");var p=e("./basic/ignore_pointer");var d=e("./basic/offstage");var f=e("./basic/opacity");var h=e("./basic/positioned");var v=e("./basic/transform");var m=e("./basic/image");var g=e("./component_view");var y=e("./mpkit/scaffold");var w=e("./basic/rich_text");var b=e("./basic/list_view");var _=e("./basic/grid_view");var x=e("./basic/custom_scroll_view");var P=e("./basic/custom_paint");var O=e("./mpkit/icon");var S=e("./mpkit/video_view");var M=e("./mpkit/web_view");var R=e("./basic/overlay");var l=function(){function l(e){this.engine=e;this.cachedView={};this.cachedElement={};this.textMeasureResults=[];this.markedNeedsFlushTextMeasureResult=false}l.prototype.create=function(e,t){var i=this;if(!e)return undefined;var n=e["^"];var o=e.name;var r=e.hashCode;if(n==1&&typeof r==="number"){return this.cachedView[r]}if(!o||!r){return undefined}this.cachedElement[r]=e;var s=this.cachedView[r];if(s){t=s.document;if(e.constraints){s.setConstraints(e.constraints)}if(e.attributes){s.setAttributes(e.attributes)}if(e.children){s.setChildren(e.children.map(function(e){var t=e["^"];var n=e["hashCode"];if(t&&i.cachedElement[n]){return i.cachedElement[n]}else{return e}}))}return s}var a=l.components[o];if(!a){a=g.ComponentView}var u=new a(t);u.factory=this;u.engine=this.engine;u.hashCode=r;if(e.constraints){u.setConstraints(e.constraints)}if(e.attributes){u.setAttributes(e.attributes)}if(e.children){u.setChildren(e.children.map(function(e){var t=e["^"];var n=e["hashCode"];if(t&&i.cachedElement[n]){return i.cachedElement[n]}else{return e}}))}this.cachedView[r]=u;return u};l.prototype.callbackTextMeasureResult=function(e,t){var n=this;this.textMeasureResults.push({measureId:e,size:t});if(!this.markedNeedsFlushTextMeasureResult){this.markedNeedsFlushTextMeasureResult=true;setTimeout(function(){n.flushTextMeasureResult();n.markedNeedsFlushTextMeasureResult=false},16)}};l.prototype.flushTextMeasureResult=function(){if(this.textMeasureResults.length>0){this.engine.sendMessage(JSON.stringify({type:"rich_text",message:{event:"onMeasured",data:this.textMeasureResults}}));this.textMeasureResults=[]}};l.components={absorb_pointer:i.AbsorbPointer,clip_oval:o.ClipOval,clip_r_rect:r.ClipRRect,colored_box:s.ColoredBox,custom_paint:P.CustomPaint,custom_scroll_view:x.CustomScrollView,decorated_box:a.DecoratedBox,flexible:u.Flexible,gesture_detector:c.GestureDetector,grid_view:_.GridView,ignore_pointer:p.IgnorePointer,image:m.Image,list_view:b.ListView,offstage:d.Offstage,opacity:f.Opacity,overlay:R.Overlay,positioned:h.Positioned,rich_text:w.RichText,sliver_list:b.ListView,sliver_grid:_.GridView,text_span:w.TextSpan,widget_span:w.WidgetSpan,transform:v.Transform,mp_icon:O.MPIcon,mp_scaffold:y.MPScaffold,mp_video_view:S.MPVideoView,mp_web_view:M.MPWebView};return l}();n.ComponentFactory=l},{"./basic/absorb_pointer":2,"./basic/clip_oval":3,"./basic/clip_r_rect":4,"./basic/colored_box":5,"./basic/custom_paint":6,"./basic/custom_scroll_view":7,"./basic/decorated_box":8,"./basic/flexible":9,"./basic/gesture_detector":10,"./basic/grid_view":11,"./basic/ignore_pointer":12,"./basic/image":13,"./basic/list_view":14,"./basic/offstage":15,"./basic/opacity":16,"./basic/overlay":17,"./basic/positioned":18,"./basic/rich_text":19,"./basic/transform":20,"./component_view":23,"./mpkit/icon":25,"./mpkit/scaffold":26,"./mpkit/video_view":27,"./mpkit/web_view":28}],23:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:true});n.ComponentView=void 0;var r=e("./dom_utils");var i=function(){function e(e){this.document=e;this.subviews=[];this.htmlElement=e.createElement(this.elementType());r.setDOMStyle(this.htmlElement,{position:"absolute"})}e.prototype.elementType=function(){return"div"};e.prototype.setConstraints=function(e){if(!e)return;this.constraints=e;var t=e.x;var n=e.y;var i=e.w;var o=e.h;if(typeof t==="number"&&typeof n==="number"&&typeof i==="number"&&typeof o==="number"){r.setDOMStyle(this.htmlElement,{left:t+"px",top:n+"px",width:i+"px",height:o+"px"})}};e.prototype.setRelativeConstraint=function(){if(!this.constraints)return;var e=this.constraints.x;var t=this.constraints.y;var n=this.constraints.w;var i=this.constraints.h;if(typeof e==="number"&&typeof t==="number"&&typeof n==="number"&&typeof i==="number"){r.setDOMStyle(this.htmlElement,{position:"relative",left:"unset",top:"unset",width:n+"px",height:i+"px"})}};e.prototype.setAttributes=function(e){this.attributes=e};e.prototype.setChildren=function(e){var n=this;if(!(e instanceof Array))return;var t=e.map(function(e){return n.factory.create(e,n.document)}).filter(function(e){return e});var i=false;if(t.length!=this.subviews.length){i=true}else{var o=t.every(function(e,t){return e===n.subviews[t]});if(!o){i=true}}if(i){this.removeAllSubviews();t.forEach(function(e){return n.addSubview(e)})}};e.prototype.removeAllSubviews=function(){this.subviews.forEach(function(e){e.htmlElement.remove()});this.subviews=[]};e.prototype.removeFromSuperview=function(){var e,t;var n=(e=this.superview)===null||e===void 0?void 0:e.subviews.indexOf(this);if(n){(t=this.superview)===null||t===void 0?void 0:t.subviews.splice(n,1)}this.htmlElement.remove()};e.prototype.addSubview=function(e){this.subviews.push(e);e.superview=this;this.htmlElement.appendChild(e.htmlElement)};return e}();n.ComponentView=i},{"./dom_utils":24}],24:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:true});n.setDOMStyle=void 0;n.setDOMStyle=function(e,t){if(typeof HTMLElement==="function"&&e instanceof HTMLElement){for(var n in t){e.style[n]=t[n]}}else{e.setStyle(t)}}},{}],25:[function(e,t,n){"use strict";var i=this&&this.__extends||function(){var i=function(e,t){i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n]};return i(e,t)};return function(e,t){i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();Object.defineProperty(n,"__esModule",{value:true});n.MPIcon=void 0;var o=e("../component_view");var r=e("../dom_utils");var s=e("../utils");var a=function(t){i(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}e.prototype.setAttributes=function(e){t.prototype.setAttributes.call(this,e);r.setDOMStyle(this.htmlElement,{backgroundColor:s.cssColor(e.color),mask:"url("+e.iconUrl+") no-repeat center",webkitMask:"url("+e.iconUrl+") no-repeat center",width:"24px",height:"24px",transform:"scale("+e.size/24+", "+e.size/24+")",transformOrigin:"top left"})};return e}(o.ComponentView);n.MPIcon=a},{"../component_view":23,"../dom_utils":24,"../utils":29}],26:[function(e,t,n){"use strict";var i=this&&this.__extends||function(){var i=function(e,t){i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n]};return i(e,t)};return function(e,t){i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();Object.defineProperty(n,"__esModule",{value:true});n.MPScaffold=void 0;var o=e("../component_view");var r=e("../dom_utils");var a=e("../utils");var s=function(s){i(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}e.prototype.setAppBar=function(e){if(this.appBar===e)return;this.removeAllSubviews();this.appBar=e;if(e&&this.engine.pageMode){r.setDOMStyle(e.htmlElement,{position:"fixed"})}this.readdSubviews()};e.prototype.setBody=function(e){if(this.body===e)return;this.removeAllSubviews();this.body=e;this.readdSubviews()};e.prototype.setBottomBar=function(e){if(this.bottomBar===e)return;this.removeAllSubviews();this.bottomBar=e;if(e&&this.engine.pageMode){r.setDOMStyle(e.htmlElement,{position:"fixed",top:"unset",bottom:"0px"});if(this.body){r.setDOMStyle(this.body.htmlElement,{paddingBottom:e.htmlElement.style.height})}}this.readdSubviews()};e.prototype.setFloatingBody=function(e){if(this.floatingBody===e)return;this.removeAllSubviews();this.floatingBody=e;this.readdSubviews()};e.prototype.readdSubviews=function(){if(this.body){this.addSubview(this.body)}if(this.appBar){this.addSubview(this.appBar)}if(this.bottomBar){this.addSubview(this.bottomBar)}if(this.floatingBody){this.addSubview(this.floatingBody)}};e.prototype.setAttributes=function(e){var t,n,i,o,r;s.prototype.setAttributes.call(this,e);this.setAppBar(e.appBar?this.factory.create(e.appBar,this.document):undefined);this.setBody(e.body?this.factory.create(e.body,this.document):undefined);this.setBottomBar(e.bottomBar?this.factory.create(e.bottomBar,this.document):undefined);this.setFloatingBody(e.floatingBody?this.factory.create(e.floatingBody,this.document):undefined);if(e.name){(t=this.delegate)===null||t===void 0?void 0:t.setPageTitle(e.name)}else{(n=this.delegate)===null||n===void 0?void 0:n.setPageTitle("")}if(e.backgroundColor){(i=this.delegate)===null||i===void 0?void 0:i.setPageBackgroundColor(a.cssColorHex(e.backgroundColor))}else{(o=this.delegate)===null||o===void 0?void 0:o.setPageBackgroundColor("transparent")}if(e.appBarColor){(r=this.delegate)===null||r===void 0?void 0:r.setAppBarColor(a.cssColorHex(e.appBarColor),e.appBarTintColor?a.cssColorHex(e.appBarTintColor):"#000000")}};e.prototype.setDelegate=function(e){this.delegate=e};e.prototype.onRefresh=function(){var t=this;return new Promise(function(e){t.refreshEndResolver=e;t.engine.sendMessage(JSON.stringify({type:"scaffold",message:{event:"onRefresh",target:t.hashCode}}))})};e.prototype.onReachBottom=function(){this.engine.sendMessage(JSON.stringify({type:"scaffold",message:{event:"onReachBottom",target:this.hashCode}}))};e.prototype.setChildren=function(){};return e}(o.ComponentView);n.MPScaffold=s},{"../component_view":23,"../dom_utils":24,"../utils":29}],27:[function(e,t,n){"use strict";var i=this&&this.__extends||function(){var i=function(e,t){i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n]};return i(e,t)};return function(e,t){i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();Object.defineProperty(n,"__esModule",{value:true});n.MPVideoView=void 0;var o=e("../component_view");var r=function(t){i(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}e.prototype.elementType=function(){return"video"};e.prototype.setAttributes=function(e){t.prototype.setAttributes.call(this,e);this.htmlElement.setAttribute("src",e.url);this.htmlElement.setAttribute("controls",e.controls);this.htmlElement.setAttribute("autoplay",e.autoplay);this.htmlElement.setAttribute("loop",e.loop);this.htmlElement.setAttribute("muted",e.muted);this.htmlElement.setAttribute("poster",e.poster)};return e}(o.ComponentView);n.MPVideoView=r},{"../component_view":23}],28:[function(e,t,n){"use strict";var i=this&&this.__extends||function(){var i=function(e,t){i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n]};return i(e,t)};return function(e,t){i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();Object.defineProperty(n,"__esModule",{value:true});n.MPWebView=void 0;var o=e("../component_view");var r=e("../dom_utils");var s=function(t){i(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}e.prototype.elementType=function(){return"iframe"};e.prototype.setAttributes=function(e){t.prototype.setAttributes.call(this,e);this.htmlElement.setAttribute("src",e.url);r.setDOMStyle(this.htmlElement,{border:"none"})};return e}(o.ComponentView);n.MPWebView=s},{"../component_view":23,"../dom_utils":24}],29:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:true});i.cssSizeFromMPElement=i.cssPadding=i.cssTextStyle=i.cssTextAlign=i.cssBorder=i.cssOffset=i.cssGradient=i.cssBorderRadius=i.cssColorHex=i.cssColor=void 0;i.cssColor=function(e){var t=parseInt(e);return"rgba("+(t>>16&255)+", "+(t>>8&255)+", "+(t>>0&255)+", "+(t>>24&255)/255+")"};i.cssColorHex=function(e){var t=parseInt(e);var n=(t>>16&255).toString(16);if(n.length<2){n="0"+n}var i=(t>>8&255).toString(16);if(i.length<2){i="0"+n}var o=(t>>0&255).toString(16);if(o.length<2){o="0"+n}return"#"+n+i+o};i.cssBorderRadius=function(e){var t,n,i,o,r,s,a,u;if(e.indexOf("BorderRadius.circular(")===0){var l=e.replace("BorderRadius.circular(","").replace(")","");return{borderRadius:l+"px"}}else if(e.indexOf("BorderRadius.all(")===0){var l=e.replace("BorderRadius.all(","").replace(")","");return{borderRadius:l+"px"}}else if(e.indexOf("BorderRadius.only(")===0){var l=e.replace("BorderRadius.only(","").replace(/\)/gi,"").replace(/Radius.circular\(/gi,"");var c=(n=(t=l.match(/topLeft: ([0-9|.]+)/))===null||t===void 0?void 0:t[1])!==null&&n!==void 0?n:0;var p=(o=(i=l.match(/topRight: ([0-9|.]+)/))===null||i===void 0?void 0:i[1])!==null&&o!==void 0?o:0;var d=(s=(r=l.match(/bottomLeft: ([0-9|.]+)/))===null||r===void 0?void 0:r[1])!==null&&s!==void 0?s:0;var f=(u=(a=l.match(/bottomRight: ([0-9|.]+)/))===null||a===void 0?void 0:a[1])!==null&&u!==void 0?u:0;return{borderTopLeftRadius:c+"px",borderTopRightRadius:p+"px",borderBottomLeftRadius:d+"px",borderBottomRightRadius:f+"px"}}else{return{}}};i.cssGradient=function(n){if(!n)return"";if(n.classname==="LinearGradient"){var e=function(){switch(n.end){case"centerRight":return"to right";case"centerLeft":return"to left";case"topRight":return"to top right";case"bottomRight":return"to bottom right";case"topLeft":return"to top left";case"bottomLeft":return"to bottom left";case"topCenter":return"to top";case"bottomCenter":return"to bottom";default:break}}();var t=[];if(n.stops&&n.stops.length){t=n.colors.map(function(e,t){if(n.stops[t]!==undefined){return i.cssColor(e)+" "+(n.stops[t]*100).toFixed(0)+"%"}else{return i.cssColor(e)}})}else{t=n.colors.map(function(e){return i.cssColor(e)})}return"linear-gradient("+e+", "+t.join(", ")+")"}return""};i.cssOffset=function(e){if(e.indexOf("Offset(")===0){var t=e.replace("Offset(","").replace(")","");var n=t.split(",").map(function(e){return e.trim()});return{dx:n[0],dy:n[1]}}else{return undefined}};i.cssBorder=function(e){var t={};if(e["topStyle"]!=="BorderStyle.none"){t.borderTopWidth=e.topWidth===0?(1/window.devicePixelRatio).toFixed(2)+"px":e.topWidth+"px";t.borderTopColor=i.cssColor(e.topColor);t.borderTopStyle="solid"}if(e["leftStyle"]!=="BorderStyle.none"){t.borderLeftWidth=e.leftWidth===0?(1/window.devicePixelRatio).toFixed(2)+"px":e.leftWidth+"px";t.borderLeftColor=i.cssColor(e.leftColor);t.borderLeftStyle="solid"}if(e["bottomStyle"]!=="BorderStyle.none"){t.borderBottomWidth=e.bottomWidth===0?(1/window.devicePixelRatio).toFixed(2)+"px":e.bottomWidth+"px";t.borderBottomColor=i.cssColor(e.bottomColor);t.borderBottomStyle="solid"}if(e["rightStyle"]!=="BorderStyle.none"){t.borderRightWidth=e.rightWidth===0?(1/window.devicePixelRatio).toFixed(2)+"px":e.rightWidth+"px";t.borderRightColor=i.cssColor(e.rightColor);t.borderRightStyle="solid"}return t};i.cssTextAlign=function(e){return e===null||e===void 0?void 0:e.replace("TextAlign.","")};function o(e){if(e.fontWeight){return e.fontWeight.replace("FontWeight.w","")}return undefined}function r(e){if(e.fontStyle==="FontStyle.italic"){return"italic"}return undefined}function s(e){if(e.textBaseline==="TextBaseline.alphabetic"){return"alphabetic"}else if(e.textBaseline==="TextBaseline.ideographic"){return"ideographic"}return undefined}function n(e){var t;var n={userSelect:"none",WebkitUserSelect:"none"};if(e!=null){if(e.fontFamily){n.fontFamily=e.fontFamily}if(e.fontSize!=null){n.fontSize=((t=e.fontSize)!==null&&t!==void 0?t:14).toString()+"px"}if(e.color!=null){n.color=i.cssColor(e.color)}if(e.fontWeight){n.fontWeight=o(e)}if(e.fontStyle){n.fontStyle=r(e)}if(e.letterSpacing){n.letterSpacing=e.letterSpacing}if(e.wordSpacing){n.wordSpacing=e.wordSpacing}if(e.textBaseline){n.alignmentBaseline=s(e)}if(e.height){n.lineHeight=e.height}if(e.backgroundColor!=null){n.backgroundColor=i.cssColor(e.backgroundColor)}if(e.decoration){if(e.decoration==="TextDecoration.lineThrough"){n.textDecoration="line-through"}else if(e.decoration==="TextDecoration.underline"){n.textDecoration="underline"}}}return n}i.cssTextStyle=n;i.cssPadding=function(e){if(!e)return{};if(e.indexOf("EdgeInsets.zero")===0){return{}}else if(e.indexOf("EdgeInsets.all(")===0){var t=e.replace("EdgeInsets.all(","").replace(")","");return{paddingLeft:t+"px",paddingTop:t+"px",paddingRight:t+"px",paddingBottom:t+"px"}}else if(e.indexOf("EdgeInsets(")===0){var t=e.replace("EdgeInsets(","").replace(")","");var n=t.split(",").map(function(e){return e.trim()});return{paddingLeft:n[0]+"px",paddingTop:n[1]+"px",paddingRight:n[2]+"px",paddingBottom:n[3]+"px"}}else{return{}}};i.cssSizeFromMPElement=function(e){if(!e)return{width:0,height:0};var t=0;var n=0;if(e.constraints&&typeof e.constraints.w==="number"&&typeof e.constraints.h==="number"){t=e.constraints.w;n=e.constraints.h}else if(e.children instanceof Array&&e.children.length===1){return i.cssSizeFromMPElement(e.children[0])}return{width:t,height:n}}},{}],30:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:true});n.BrowserDebugger=void 0;var i=function(){function e(e,t){this.serverAddr=e;this.engine=t;this.messageQueue=[]}e.prototype.start=function(){var t=this;this.socket=new WebSocket("ws://"+this.serverAddr+"/ws");this.socket.onopen=function(){t.socketDidConnect()};this.socket.onmessage=function(e){if(typeof e.data==="string"){t.socketDidReceiveMessage(e.data)}};this.socket.onclose=function(){t.socketDidDisconnect()}};e.prototype.socketDidConnect=function(){var n=this;this.messageQueue.forEach(function(e){var t;(t=n.socket)===null||t===void 0?void 0:t.send(e)});this.messageQueue=[]};e.prototype.socketDidDisconnect=function(){var e=this;setTimeout(function(){e.start()},1e3)};e.prototype.socketDidReceiveMessage=function(e){this.engine.didReceivedMessage(e)};e.prototype.sendMessage=function(e){if(!this.socket||this.socket.readyState!=1){this.messageQueue.push(e);return}this.socket.send(e)};return e}();n.BrowserDebugger=i},{}],31:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:true});n.createDebugger=void 0;var i=e("../env");var o=e("./browser_debugger");var r=e("./wx_debugger");function s(e,t){if(i.MPEnv.platformType===i.PlatformType.wxMiniProgram){return new r.WXDebugger(e,t)}else{return new o.BrowserDebugger(e,t)}}n.createDebugger=s},{"../env":34,"./browser_debugger":30,"./wx_debugger":32}],32:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:true});n.WXDebugger=void 0;var i=function(){function e(e,t){this.serverAddr=e;this.engine=t;this.messageQueue=[];this.connected=false}e.prototype.start=function(){var t=this;this.socket=wx.connectSocket({url:"ws://"+this.serverAddr+"/ws"});this.socket.onOpen(function(){t.connected=true;t.socketDidConnect()});this.socket.onMessage(function(e){if(typeof e.data==="string"){t.socketDidReceiveMessage(e.data)}});this.socket.onClose(function(){t.connected=false;t.socketDidDisconnect()})};e.prototype.socketDidConnect=function(){var n=this;this.messageQueue.forEach(function(e){var t;(t=n.socket)===null||t===void 0?void 0:t.send({data:e})});this.messageQueue=[]};e.prototype.socketDidDisconnect=function(){var e=this;setTimeout(function(){e.start()},1e3)};e.prototype.socketDidReceiveMessage=function(e){this.engine.didReceivedMessage(e)};e.prototype.sendMessage=function(e){if(!this.socket||!this.connected){this.messageQueue.push(e);return}this.socket.send({data:e})};return e}();n.WXDebugger=i},{}],33:[function(require,module,exports){(function(global){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Engine=void 0;var custom_paint_1=require("./components/basic/custom_paint");var web_dialogs_1=require("./components/basic/web_dialogs");var component_factory_1=require("./components/component_factory");var debugger_1=require("./debugger/debugger");var method_channel_handler_1=require("./mpjs/method_channel_handler");var mpjs_1=require("./mpjs/mpjs");var window_info_1=require("./window_info");var Engine=function(){function Engine(){this.started=false;this.messageQueue=[];this.managedViews={};this.unmanagedViewFrameData={};this.mpJS=new mpjs_1.MPJS(this);this.windowInfo=new window_info_1.WindowInfo(this);this.pageMode=false;this.componentFactory=new component_factory_1.ComponentFactory(this);this.drawable=new custom_paint_1.MPDrawable(this);method_channel_handler_1.MethodChannelHandler.installHandler()}Engine.codeBlockWithCodePath=function(codePath){return new Promise(function(res,rej){var httpRequest=new XMLHttpRequest;httpRequest.onload=function(){res(function(){eval(httpRequest.response)})};httpRequest.onerror=function(e){rej(e)};httpRequest.open("GET",codePath);httpRequest.send()})};Engine.codeBlockWithFile=function(e){return function(){require(e).main()}};Engine.prototype.initWithDebuggerServerAddr=function(e){this.debugger=debugger_1.createDebugger(e,this)};Engine.prototype.initWithCodeBlock=function(e){this.codeBlock=e};Engine.prototype.start=function(){var t=this;if(this.started)return;if(!this.codeBlock&&!this.debugger)return;this.windowInfo.updateWindowInfo();if(this.debugger){this.debugger.start()}if(this.codeBlock){this.mpJS.engineScope.onMessage=function(e){t.didReceivedMessage(e)};if(self){self.engineScope=this.mpJS.engineScope}else{global.self={JSON:JSON,setTimeout:setTimeout,setInterval:setInterval,clearTimeout:clearTimeout,clearInterval:clearInterval,wx:wx,Object:Object};global.self.engineScope=this.mpJS.engineScope}(function(){t.codeBlock()})();this.flushQueueMessage()}this.started=true};Engine.prototype.sendMessage=function(e){if(this.debugger){this.debugger.sendMessage(e)}else{if(this.mpJS.engineScope.postMessage){this.mpJS.engineScope.postMessage(e)}else{this.messageQueue.push(e)}}};Engine.prototype.flushQueueMessage=function(){var t=this;if(this.debugger){return}else{if(this.mpJS.engineScope.postMessage){this.messageQueue.forEach(function(e){t.mpJS.engineScope.postMessage(e)})}}};Engine.prototype.didReceivedMessage=function(e){var t,n,i;var o=JSON.parse(e);if(!o)return;if(o.type==="frame_data"){this.didReceivedFrameData(o.message)}else if(o.type==="diff_data"){this.didReceivedDiffData(o.message)}else if(o.type==="element_gc"){if(o.message instanceof Array){this.didReceivedElementGC(o.message)}}else if(o.type==="decode_drawable"){this.drawable.decodeDrawable(o.message)}else if(o.type==="route"){(i=(n=(t=this.app)===null||t===void 0?void 0:t.router)!==null&&n!==void 0?n:this.router)===null||i===void 0?void 0:i.didReceivedRouteData(o.message)}else if(o.type==="mpjs"){this.didReceivedMPJS(o)}else if(o.type==="action:web_dialogs"){web_dialogs_1.WebDialogs.receivedWebDialogsMessage(this,o.message)}else if(o.type==="scaffold"){this.didReceivedScaffold(o.message)}};Engine.prototype.didReceivedFrameData=function(e){var t;if(!e)return;var n=e.routeId;if(this.managedViews[n]===undefined){if(!this.unmanagedViewFrameData[n]){this.unmanagedViewFrameData[n]=[]}this.unmanagedViewFrameData[n].push(e);return}var i=false;if(!i&&typeof n==="number"){(t=this.managedViews[n])===null||t===void 0?void 0:t.didReceivedFrameData(e)}};Engine.prototype.didReceivedDiffData=function(e){var t=this;if(!e)return;e.diffs.forEach(function(e){t.componentFactory.create(e,undefined)})};Engine.prototype.didReceivedElementGC=function(e){var t=this;e.forEach(function(e){delete t.componentFactory.cachedElement[e];delete t.componentFactory.cachedView[e]})};Engine.prototype.didReceivedScaffold=function(e){var t;if(e.event==="onRefreshEnd"){var n=this.componentFactory.cachedView[e.target];if(n){(t=n.refreshEndResolver)===null||t===void 0?void 0:t.call(n,undefined);n.refreshEndResolver=undefined}}};Engine.prototype.didReceivedMPJS=function(t){var n=this;this.mpJS.handleMessage(t.message,function(e){n.sendMessage(JSON.stringify({type:"mpjs",message:{requestId:t.message.requestId,result:e}}))},function(e,t){n.sendMessage(JSON.stringify({type:"mpjs",message:{funcId:e,arguments:t}}))})};return Engine}();exports.Engine=Engine}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./components/basic/custom_paint":6,"./components/basic/web_dialogs":21,"./components/component_factory":22,"./debugger/debugger":31,"./mpjs/method_channel_handler":36,"./mpjs/mpjs":37,"./window_info":41}],34:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:true});n.MPEnv=n.PlatformType=void 0;var i;(function(e){e[e["unknown"]=0]="unknown";e[e["browser"]=1]="browser";e[e["wxMiniProgram"]=2]="wxMiniProgram"})(i=n.PlatformType||(n.PlatformType={}));n.MPEnv={platformType:function(){if(typeof wx!=="undefined"&&typeof wx.getSystemInfoSync==="function"){return i.wxMiniProgram}else{return i.browser}}()}},{}],35:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:true});var i=e("./engine");Object.defineProperty(n,"Engine",{enumerable:true,get:function(){return i.Engine}});var o=e("./view");Object.defineProperty(n,"View",{enumerable:true,get:function(){return o.View}});var r=e("./page");Object.defineProperty(n,"Page",{enumerable:true,get:function(){return r.Page}});Object.defineProperty(n,"WXPage",{enumerable:true,get:function(){return r.WXPage}});var s=e("./app");Object.defineProperty(n,"BrowserApp",{enumerable:true,get:function(){return s.BrowserApp}});Object.defineProperty(n,"WXApp",{enumerable:true,get:function(){return s.WXApp}})},{"./app":1,"./engine":33,"./page":38,"./view":40}],36:[function(e,t,i){(function(e){"use strict";var t=this&&this.__awaiter||function(e,s,n,a){function u(t){return t instanceof n?t:new n(function(e){e(t)})}return new(n||(n=Promise))(function(t,n){function i(e){try{r(a.next(e))}catch(e){n(e)}}function o(e){try{r(a["throw"](e))}catch(e){n(e)}}function r(e){e.done?t(e.value):u(e.value).then(i,o)}r((a=a.apply(e,s||[])).next())})};var a=this&&this.__generator||function(e,n){var i={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},o,r,s,t;return t={next:a(0),throw:a(1),return:a(2)},typeof Symbol==="function"&&(t[Symbol.iterator]=function(){return this}),t;function a(t){return function(e){return u([t,e])}}function u(t){if(o)throw new TypeError("Generator is already executing.");while(i)try{if(o=1,r&&(s=t[0]&2?r["return"]:t[0]?r["throw"]||((s=r["return"])&&s.call(r),0):r.next)&&!(s=s.call(r,t[1])).done)return s;if(r=0,s)t=[t[0]&2,s.value];switch(t[0]){case 0:case 1:s=t;break;case 4:i.label++;return{value:t[1],done:false};case 5:i.label++;r=t[1];t=[0];continue;case 7:t=i.ops.pop();i.trys.pop();continue;default:if(!(s=i.trys,s=s.length>0&&s[s.length-1])&&(t[0]===6||t[0]===2)){i=0;continue}if(t[0]===3&&(!s||t[1]>s[0]&&t[1]<s[3])){i.label=t[1];break}if(t[0]===6&&i.label<s[1]){i.label=s[1];s=t;break}if(s&&i.label<s[2]){i.label=s[2];i.ops.push(t);break}if(s[2])i.ops.pop();i.trys.pop();continue}t=n.call(e,i)}catch(e){t=[6,e];r=0}finally{o=s=0}if(t[0]&5)throw t[1];return{value:t[0]?t[1]:void 0,done:true}}};Object.defineProperty(i,"__esModule",{value:true});i.MethodChannelHandler=void 0;var u=window!==null&&window!==void 0?window:e;var n=function(){function e(){}e.installHandler=function(){u.mp_core_methodChannelHandlerWebOnly=this.handler};e.handler=function(i,o,r,s){return t(this,void 0,void 0,function(){var t,n;return a(this,function(e){switch(e.label){case 0:if(!Object.prototype.hasOwnProperty.call(u,i)){s("NOTIMPLEMENTED");return[2]}if(!(typeof u[i][o]==="function")){s("NOTIMPLEMENTED");return[2]}e.label=1;case 1:e.trys.push([1,3,,4]);return[4,u[i][o](r)];case 2:t=e.sent();s(JSON.stringify(t));return[3,4];case 3:n=e.sent();s("ERROR:"+n);return[3,4];case 4:return[2]}})})};return e}();i.MethodChannelHandler=n}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],37:[function(e,t,n){(function(e){"use strict";Object.defineProperty(n,"__esModule",{value:true});n.MPJS=void 0;var c=window!==null&&window!==void 0?window:e;var t=function(){function e(e){this.engine=e;this.engineScope={};this.objectRefs={}}e.prototype.handleMessage=function(e,t,n){if(e.event==="callMethod"){this.callMethod(e,t,n)}else if(e.event==="getValue"){this.getValue(e,t)}else if(e.event==="setValue"){this.setValue(e,t)}else if(e.event==="hasProperty"){this.hasProperty(e,t)}else if(e.event==="deleteProperty"){this.deleteProperty(e,t)}};e.prototype.callMethod=function(e,t,n){var i=this;var o;var r=e.params;var s=this.getCallee(r.objectHandler,r.callChain);if(typeof s==="object"||typeof s==="function"){try{var a=s[r.method].apply(s,(o=r.args)===null||o===void 0?void 0:o.map(function(e){return i.wrapArgument(e,n)}));t(this.wrapResult(a))}catch(e){console.error(e)}}};e.prototype.getValue=function(e,t){var n=e.params;var i=this.getCallee(n.objectHandler,n.callChain);t(this.wrapResult(i[n.key]))};e.prototype.setValue=function(e,t){var n=e.params;var i=this.getCallee(n.objectHandler,n.callChain);i[n.key]=n.value;t(undefined)};e.prototype.hasProperty=function(e,t){var n=e.params;var i=this.getCallee(n.objectHandler,n.callChain);t(this.wrapResult(i&&i.hasOwnProperty(n.key)))};e.prototype.deleteProperty=function(e,t){var n=e.params;var i=this.getCallee(n.objectHandler,n.callChain);if(i){delete i[n.key]}t(1)};e.prototype.getCallee=function(e,t){var n,i,o,r;var s=(n=this.objectRefs[e])!==null&&n!==void 0?n:c;var a=s;if(t[0]==="engineScope"){a=this.engineScope;t.shift()}for(var u=0;u<t.length;u++){var l=t[u];a=a[l];if(l==="document"&&u===0&&a===undefined){a=(r=(o=(i=this.engine)===null||i===void 0?void 0:i.managedViews)===null||o===void 0?void 0:o[0])===null||r===void 0?void 0:r.document}if(a===undefined||a===null){break}}return a};e.prototype.wrapArgument=function(e,i){var t=this;if(typeof e==="string"&&e.indexOf("func:")===0){var o=e;var r=this;return function(){var e=[];for(var t=0;t<arguments.length;t++){var n=arguments[t];e.push(r.wrapResult(n))}i(o,e)}}else if(typeof e==="string"&&e.indexOf("obj:")===0){return this.objectRefs[e.replace("obj:","")]}else if(typeof e==="object"&&e instanceof Array){return e.map(function(e){return t.wrapArgument(e,i)})}else if(typeof e==="object"){var n={};for(var s in e){n[s]=this.wrapArgument(e[s],i)}return n}else{return e}};e.prototype.wrapResult=function(e){if(typeof e==="string"||typeof e==="number"||typeof e==="boolean"||typeof e==="bigint"){return e}else{var t=Math.random().toString();this.objectRefs[t]=e;return{objectHandler:t}}};return e}();n.MPJS=t}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],38:[function(a,e,p){(function(e){"use strict";var t=this&&this.__awaiter||function(e,s,n,a){function u(t){return t instanceof n?t:new n(function(e){e(t)})}return new(n||(n=Promise))(function(t,n){function i(e){try{r(a.next(e))}catch(e){n(e)}}function o(e){try{r(a["throw"](e))}catch(e){n(e)}}function r(e){e.done?t(e.value):u(e.value).then(i,o)}r((a=a.apply(e,s||[])).next())})};var u=this&&this.__generator||function(e,n){var i={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},o,r,s,t;return t={next:a(0),throw:a(1),return:a(2)},typeof Symbol==="function"&&(t[Symbol.iterator]=function(){return this}),t;function a(t){return function(e){return u([t,e])}}function u(t){if(o)throw new TypeError("Generator is already executing.");while(i)try{if(o=1,r&&(s=t[0]&2?r["return"]:t[0]?r["throw"]||((s=r["return"])&&s.call(r),0):r.next)&&!(s=s.call(r,t[1])).done)return s;if(r=0,s)t=[t[0]&2,s.value];switch(t[0]){case 0:case 1:s=t;break;case 4:i.label++;return{value:t[1],done:false};case 5:i.label++;r=t[1];t=[0];continue;case 7:t=i.ops.pop();i.trys.pop();continue;default:if(!(s=i.trys,s=s.length>0&&s[s.length-1])&&(t[0]===6||t[0]===2)){i=0;continue}if(t[0]===3&&(!s||t[1]>s[0]&&t[1]<s[3])){i.label=t[1];break}if(t[0]===6&&i.label<s[1]){i.label=s[1];s=t;break}if(s&&i.label<s[2]){i.label=s[2];i.ops.push(t);break}if(s[2])i.ops.pop();i.trys.pop();continue}t=n.call(e,i)}catch(e){t=[6,e];r=0}finally{o=s=0}if(t[0]&5)throw t[1];return{value:t[0]?t[1]:void 0,done:true}}};Object.defineProperty(p,"__esModule",{value:true});p.WXPage=p.WXPageScaffoldDelegate=p.BrowserPageScaffoldDelegate=p.Page=void 0;var n=a("./components/dom_utils");var i=a("./components/mpkit/scaffold");var l=a("./env");var c=a("./router");var r=function(){function e(e,n,t,i){var o=this;if(i===void 0){i=self===null||self===void 0?void 0:self.document}this.element=e;this.engine=n;this.options=t;this.document=i;this._active=true;this.viewId=-1;this.overlaysView=[];this.requestRoute().then(function(e){var t;o.viewId=e;n.managedViews[o.viewId]=o;n.pageMode=true;if(n.unmanagedViewFrameData[o.viewId]){n.unmanagedViewFrameData[o.viewId].forEach(function(e){o.didReceivedFrameData(e)});delete n.unmanagedViewFrameData[o.viewId]}(t=o.readyCallback)===null||t===void 0?void 0:t.call(o,undefined)})}e.prototype.ready=function(){return t(this,void 0,void 0,function(){var t=this;return u(this,function(e){return[2,new Promise(function(e){t.readyCallback=e})]})})};e.prototype.requestRoute=function(){var i,o,r,s,a;return t(this,void 0,void 0,function(){var t,n;return u(this,function(e){switch(e.label){case 0:if(!this.engine.app){this.engine.router=new c.Router(this.engine)}t=(o=(i=this.engine.app)===null||i===void 0?void 0:i.router)!==null&&o!==void 0?o:(r=this.engine)===null||r===void 0?void 0:r.router;return[4,this.element.getBoundingClientRect()];case 1:n=e.sent();if(n.height<=0){if(l.MPEnv.platformType===l.PlatformType.wxMiniProgram){n.height=wx.getSystemInfoSync().windowHeight}else{n.height=window.innerHeight}}return[2,t.requestRoute((a=(s=this.options)===null||s===void 0?void 0:s.route)!==null&&a!==void 0?a:"/",{},this.engine.app===undefined,{width:n.width,height:n.height})]}})})};e.prototype.dispose=function(){delete this.engine.managedViews[this.viewId]};e.prototype.didReceivedFrameData=function(e){var t=this.engine.componentFactory.create(e.scaffold,this.document);this.scaffoldView=t;if(t instanceof i.MPScaffold&&!t.delegate){if(l.MPEnv.platformType===l.PlatformType.wxMiniProgram){t.setDelegate(new s);t.setAttributes(e.scaffold.attributes)}else{t.setDelegate(new o);t.setAttributes(e.scaffold.attributes)}}if(t&&this.active){this.element.appendChild(t.htmlElement);n.setDOMStyle(t.htmlElement,{display:"contents"})}if(e.overlays&&e.overlays instanceof Array){this.setOverlays(e.overlays)}};e.prototype.onRefresh=function(){return t(this,void 0,void 0,function(){return u(this,function(e){switch(e.label){case 0:if(!(this.scaffoldView instanceof i.MPScaffold))return[3,2];return[4,this.scaffoldView.onRefresh()];case 1:e.sent();e.label=2;case 2:return[2]}})})};e.prototype.onReachBottom=function(){if(this.scaffoldView instanceof i.MPScaffold){this.scaffoldView.onReachBottom()}};e.prototype.setOverlays=function(e){var t=this;this.overlaysView.forEach(function(e){e.removeFromSuperview()});var n=e.map(function(e){return t.engine.componentFactory.create(e,t.document)}).filter(function(e){return e});n.forEach(function(e){t.document.body.appendChild(e.htmlElement)});this.overlaysView=n};Object.defineProperty(e.prototype,"active",{get:function(){return this._active},set:function(e){var t,n;this._active=e;if(!e){(t=this.scaffoldView)===null||t===void 0?void 0:t.htmlElement.remove()}else{if((n=this.scaffoldView)===null||n===void 0?void 0:n.htmlElement){this.element.appendChild(this.scaffoldView.htmlElement);this.scaffoldView.setAttributes(this.scaffoldView.attributes)}}},enumerable:false,configurable:true});return e}();p.Page=r;var o=function(){function e(){}e.prototype.setPageTitle=function(e){document.title=e};e.prototype.setPageBackgroundColor=function(e){document.body.style.backgroundColor=e};e.prototype.setAppBarColor=function(e,t){};return e}();p.BrowserPageScaffoldDelegate=o;var s=function(){function e(){}e.prototype.setPageTitle=function(e){wx.setNavigationBarTitle({title:e})};e.prototype.setPageBackgroundColor=function(e){wx.setBackgroundColor({backgroundColor:e})};e.prototype.setAppBarColor=function(e,t){wx.setNavigationBarColor({backgroundColor:e,frontColor:t})};return e}();p.WXPageScaffoldDelegate=s;p.WXPage=function(n,i,o){if(i===void 0){i="#vdom"}if(o===void 0){o=e.app}return{onLoad:function(){var e=this.selectComponent(i).miniDom.document;var t=this.options.route;this.mpPage=new r(e.body,o.engine,t?{route:t,params:{}}:n!==null&&n!==void 0?n:{route:"/"},e)},onUnload:function(){if(this.mpPage.viewId){o.router.disposeRoute(this.mpPage.viewId)}},onPullDownRefresh:function(){this.mpPage.onRefresh().then(function(e){wx.stopPullDownRefresh()})},onReachBottom:function(){this.mpPage.onReachBottom()}}}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./components/dom_utils":24,"./components/mpkit/scaffold":26,"./env":34,"./router":39}],39:[function(e,t,n){"use strict";var i=this&&this.__extends||function(){var i=function(e,t){i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n]};return i(e,t)};return function(e,t){i(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();var u=this&&this.__awaiter||function(e,s,n,a){function u(t){return t instanceof n?t:new n(function(e){e(t)})}return new(n||(n=Promise))(function(t,n){function i(e){try{r(a.next(e))}catch(e){n(e)}}function o(e){try{r(a["throw"](e))}catch(e){n(e)}}function r(e){e.done?t(e.value):u(e.value).then(i,o)}r((a=a.apply(e,s||[])).next())})};var l=this&&this.__generator||function(e,n){var i={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},o,r,s,t;return t={next:a(0),throw:a(1),return:a(2)},typeof Symbol==="function"&&(t[Symbol.iterator]=function(){return this}),t;function a(t){return function(e){return u([t,e])}}function u(t){if(o)throw new TypeError("Generator is already executing.");while(i)try{if(o=1,r&&(s=t[0]&2?r["return"]:t[0]?r["throw"]||((s=r["return"])&&s.call(r),0):r.next)&&!(s=s.call(r,t[1])).done)return s;if(r=0,s)t=[t[0]&2,s.value];switch(t[0]){case 0:case 1:s=t;break;case 4:i.label++;return{value:t[1],done:false};case 5:i.label++;r=t[1];t=[0];continue;case 7:t=i.ops.pop();i.trys.pop();continue;default:if(!(s=i.trys,s=s.length>0&&s[s.length-1])&&(t[0]===6||t[0]===2)){i=0;continue}if(t[0]===3&&(!s||t[1]>s[0]&&t[1]<s[3])){i.label=t[1];break}if(t[0]===6&&i.label<s[1]){i.label=s[1];s=t;break}if(s&&i.label<s[2]){i.label=s[2];i.ops.push(t);break}if(s[2])i.ops.pop();i.trys.pop();continue}t=n.call(e,i)}catch(e){t=[6,e];r=0}finally{o=s=0}if(t[0]&5)throw t[1];return{value:t[0]?t[1]:void 0,done:true}}};Object.defineProperty(n,"__esModule",{value:true});n.WXRouter=n.BrowserRouter=n.Router=void 0;var r=e("./page");var o=function(){function e(e){this.engine=e;this.routeResponseHandler={}}e.prototype.requestRoute=function(o,r,s,a){return u(this,void 0,void 0,function(){var t,n;var i=this;return l(this,function(e){if(this.thePushingRouteId){t=this.thePushingRouteId;this.thePushingRouteId=undefined;this.engine.sendMessage(JSON.stringify({type:"router",message:{event:"updateRoute",routeId:t,viewport:a}}));return[2,t]}n=Math.random().toString();return[2,new Promise(function(e){i.routeResponseHandler[n]=e;i.engine.sendMessage(JSON.stringify({type:"router",message:{event:"requestRoute",requestId:n,name:o,params:r!==null&&r!==void 0?r:{},viewport:a,root:s===true}}))})]})})};e.prototype.responseRoute=function(e){var t;var n=e.requestId;var i=e.routeId;(t=this.routeResponseHandler[n])===null||t===void 0?void 0:t.call(this,i)};e.prototype.disposeRoute=function(e){this.engine.sendMessage(JSON.stringify({type:"router",message:{event:"disposeRoute",routeId:e}}))};e.prototype.didReceivedRouteData=function(e){var t=e.event;if(t==="responseRoute"){this.responseRoute(e)}else if(t==="didPush"){this.didPush(e)}else if(t==="didReplace"){this.didReplace(e)}else if(t==="didPop"){this.didPop()}};e.prototype.didPush=function(e){throw"native implementation"};e.prototype.didReplace=function(e){throw"native implementation"};e.prototype.didPop=function(){throw"native implementation"};return e}();n.Router=o;var s=function(t){i(e,t);function e(e){var n=t.call(this,e)||this;n.history=[];n.doBacking=false;window.addEventListener("popstate",function(e){if(n.doBacking){return true}if(window.history.state&&window.history.state.routeId){var t=window.history.state.routeId;n.popHistory();n.engine.sendMessage(JSON.stringify({type:"router",message:{event:"popToRoute",routeId:t}}))}});return n}e.prototype.didSetupFirst=function(e,t){window.history.replaceState({routeId:e},"","?route="+encodeURIComponent(t))};e.prototype.didPush=function(e){var t=e.routeId;this.thePushingRouteId=t;var n=e.name;window.history.pushState({routeId:t},"","?route="+encodeURIComponent(n));var i=window.pageYOffset;var o=new r.Page(this.engine.app.rootElement,this.engine);this.pushHistory(o,i)};e.prototype.didReplace=function(e){var t=e.routeId;this.thePushingRouteId=t;var n=e.name;window.history.replaceState({routeId:t},"","?route="+encodeURIComponent(n));var i=new r.Page(this.engine.app.rootElement,this.engine);this.replaceHistory(i)};e.prototype.didPop=function(){var e=this;this.doBacking=true;window.history.back();this.popHistory();setTimeout(function(){e.doBacking=false},100)};e.prototype.pushHistory=function(e,t){this.history.forEach(function(e){return e.item.active=false});this.history.push({item:e,scrollPosition:t});window.scrollTo(0,0)};e.prototype.replaceHistory=function(e){this.history.forEach(function(e){return e.item.active=false});this.history[this.history.length-1]={item:e,scrollPosition:0};window.scrollTo(0,0)};e.prototype.popHistory=function(){if(this.history.length<=0)return;this.history.pop().item.active=false;this.history[this.history.length-1].item.active=true;window.scrollTo(0,this.history[this.history.length-1].scrollPosition)};return e}(o);n.BrowserRouter=s;var a=function(e){i(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.didPush=function(e){var t=this;var n=e.routeId;this.thePushingRouteId=n;var i=e.name;wx.navigateTo({url:i,fail:function(){var e=t.engine.app.indexPage+"?route="+encodeURIComponent(i);wx.navigateTo({url:e})}})};t.prototype.didReplace=function(e){var t=this;var n=e.routeId;this.thePushingRouteId=n;var i=e.name;wx.redirectTo({url:i,fail:function(){var e=t.engine.app.indexPage+"?route="+encodeURIComponent(i);wx.redirectTo({url:e})}})};t.prototype.didPop=function(){wx.navigateBack()};return t}(o);n.WXRouter=a},{"./page":38}],40:[function(e,t,n){"use strict";var u=this&&this.__awaiter||function(e,s,n,a){function u(t){return t instanceof n?t:new n(function(e){e(t)})}return new(n||(n=Promise))(function(t,n){function i(e){try{r(a.next(e))}catch(e){n(e)}}function o(e){try{r(a["throw"](e))}catch(e){n(e)}}function r(e){e.done?t(e.value):u(e.value).then(i,o)}r((a=a.apply(e,s||[])).next())})};var l=this&&this.__generator||function(e,n){var i={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},o,r,s,t;return t={next:a(0),throw:a(1),return:a(2)},typeof Symbol==="function"&&(t[Symbol.iterator]=function(){return this}),t;function a(t){return function(e){return u([t,e])}}function u(t){if(o)throw new TypeError("Generator is already executing.");while(i)try{if(o=1,r&&(s=t[0]&2?r["return"]:t[0]?r["throw"]||((s=r["return"])&&s.call(r),0):r.next)&&!(s=s.call(r,t[1])).done)return s;if(r=0,s)t=[t[0]&2,s.value];switch(t[0]){case 0:case 1:s=t;break;case 4:i.label++;return{value:t[1],done:false};case 5:i.label++;r=t[1];t=[0];continue;case 7:t=i.ops.pop();i.trys.pop();continue;default:if(!(s=i.trys,s=s.length>0&&s[s.length-1])&&(t[0]===6||t[0]===2)){i=0;continue}if(t[0]===3&&(!s||t[1]>s[0]&&t[1]<s[3])){i.label=t[1];break}if(t[0]===6&&i.label<s[1]){i.label=s[1];s=t;break}if(s&&i.label<s[2]){i.label=s[2];i.ops.push(t);break}if(s[2])i.ops.pop();i.trys.pop();continue}t=n.call(e,i)}catch(e){t=[6,e];r=0}finally{o=s=0}if(t[0]&5)throw t[1];return{value:t[0]?t[1]:void 0,done:true}}};Object.defineProperty(n,"__esModule",{value:true});n.View=void 0;var i=e("./components/dom_utils");var c=e("./router");var o=function(){function e(e,t,n,i){var o=this;if(i===void 0){i=self===null||self===void 0?void 0:self.document}this.element=e;this.engine=t;this.options=n;this.document=i;this.viewId=-1;this.requestRoute().then(function(e){o.viewId=e;t.managedViews[o.viewId]=o;t.pageMode=false;if(t.unmanagedViewFrameData[o.viewId]){t.unmanagedViewFrameData[o.viewId].forEach(function(e){o.didReceivedFrameData(e)});delete t.unmanagedViewFrameData[o.viewId]}})}e.prototype.requestRoute=function(){var i,o,r,s,a;return u(this,void 0,void 0,function(){var t,n;return l(this,function(e){switch(e.label){case 0:if(!this.engine.app){this.engine.router=new c.Router(this.engine)}t=(o=(i=this.engine.app)===null||i===void 0?void 0:i.router)!==null&&o!==void 0?o:(r=this.engine)===null||r===void 0?void 0:r.router;return[4,this.element.getBoundingClientRect()];case 1:n=e.sent();if(n.height<=0){return[2,-1]}return[2,t.requestRoute((a=(s=this.options)===null||s===void 0?void 0:s.route)!==null&&a!==void 0?a:"/",{},true,{width:n.width,height:n.height})]}})})};e.prototype.didReceivedFrameData=function(e){var t=this.engine.componentFactory.create(e.scaffold,this.document);if(t){this.element.appendChild(t.htmlElement);i.setDOMStyle(t.htmlElement,{width:"100%"})}};return e}();n.View=o},{"./components/dom_utils":24,"./router":39}],41:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:true});n.WindowInfo=void 0;var i=e("./env");var o=function(){function e(e){this.engine=e}e.prototype.updateWindowInfo=function(){if(i.MPEnv.platformType===i.PlatformType.wxMiniProgram){this.engine.sendMessage(JSON.stringify({type:"window_info",message:{window:{width:wx.getSystemInfoSync().screenWidth,height:wx.getSystemInfoSync().screenHeight,padding:{top:wx.getSystemInfoSync().statusBarHeight,bottom:wx.getSystemInfoSync().screenHeight-wx.getSystemInfoSync().safeArea.bottom}},devicePixelRatio:wx.getSystemInfoSync().pixelRatio}}))}else{this.engine.sendMessage(JSON.stringify({type:"window_info",message:{window:{width:document.body.clientWidth,height:window.innerHeight,padding:{top:0,bottom:0}},devicePixelRatio:devicePixelRatio}}))}};return e}();n.WindowInfo=o},{"./env":34}]},{},[35])(35)});
