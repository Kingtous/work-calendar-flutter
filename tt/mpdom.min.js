"use strict";var __extends=this&&this.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),__assign=this&&this.__assign||function(){return __assign=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},__assign.apply(this,arguments)},__awaiter=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(o,r){function s(e){try{l(i.next(e))}catch(e){r(e)}}function a(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))},__generator=this&&this.__generator||function(e,t){var n,i,o,r,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,i&&(o=2&r[0]?i.return:r[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,i=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){s=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){s.label=r[1];break}if(6===r[0]&&s.label<o[1]){s.label=o[1],o=r;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(r);break}o[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(e){r=[6,e],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}};!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).MPDOM=e()}}((function(){var define,module,exports;return function e(t,n,i){function o(s,a){if(!n[s]){if(!t[s]){var l="function"==typeof require&&require;if(!a&&l)return l(s,!0);if(r)return r(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var u=n[s]={exports:{}};t[s][0].call(u.exports,(function(e){return o(t[s][1][e]||e)}),u,u.exports,e,t,n,i)}return n[s].exports}for(var r="function"==typeof require&&require,s=0;s<i.length;s++)o(i[s]);return o}({1:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.BrowserApp=void 0;var i=e("./platform_channel/plugin_register"),o=e("./platform_channel/mp_method_channel"),r=e("./page"),s=e("./router"),a=function(){function e(e,t){this.rootElement=e,this.engine=t,this.router=new l(this.engine),t.app=this,this.setupPageScrollListener()}return e.prototype.setupPageScrollListener=function(){var e=this;document.addEventListener("scroll",(function(){var t;if(document.documentElement.scrollHeight>innerHeight&&window.pageYOffset+innerHeight>=document.documentElement.scrollHeight){var n=(null===(t=e.engine.app)||void 0===t?void 0:t.router).history;n[n.length-1].item.onReachBottom()}}))},e.prototype.getURLSearchParams=function(){try{for(var e={},t=new URL(window.location.href).searchParams,n=t.keys(),i=n.next();!i.done&&(e[i.value]=t.get(i.value),!(i=n.next()).done););return e}catch(e){return console.error(e),{}}},e.prototype.setupFirstPage=function(e,t){var n,i;return __awaiter(this,void 0,void 0,(function(){var o,s;return __generator(this,(function(a){switch(a.label){case 0:return e||(this.router.isPathRewriteEnabled?e={route:new URL(window.location.href).pathname||"/",params:this.getURLSearchParams()}:(delete(o=__assign({},this.getURLSearchParams())).route,e={route:new URL(window.location.href).searchParams.get("route")||"/",params:o})),(s=new r.Page(this.rootElement,this.engine,e)).isFirst=!0,t?(this.router.history.forEach((function(e){return e.item.active=!1})),this.router.history[0]={item:s,scrollPosition:0}):this.router.history.push({item:s,scrollPosition:0}),[4,s.ready()];case 1:return a.sent(),this.router.didSetupFirst(s.viewId,null!==(n=null==e?void 0:e.route)&&void 0!==n?n:"/",null!==(i=null==e?void 0:e.params)&&void 0!==i?i:{}),[2]}}))}))},e.prototype.enablePathRewrite=function(){this.router.isPathRewriteEnabled=!0},e}();n.BrowserApp=a;var l=function(e){function t(t){var n=e.call(this,t)||this;return n.history=[],n.isPathRewriteEnabled=!1,n.doBacking=!1,window.addEventListener("popstate",(function(e){if(n.doBacking)return!0;if(window.history.state&&window.history.state.routeId){var t=window.history.state.routeId;n.history.length>1?(n.popHistory(),n.engine.sendMessage(JSON.stringify({type:"router",message:{event:"popToRoute",routeId:t}}))):n.engine.app&&n.engine.app instanceof a&&n.engine.app.setupFirstPage(void 0,!0)}})),n}return __extends(t,e),t.prototype.encodePath=function(e,t){var n=[];if(t)for(var i in t)n.push("".concat(i,"=").concat(encodeURIComponent(t[i])));if(this.isPathRewriteEnabled)return n.length>0?"".concat(e,"?").concat(n.join("&")):"".concat(e);var o=e.indexOf("?")>=0?e.split("?")[0]:e,r=e.indexOf("?")>=0?e.substr(e.indexOf("?")):"";return n.length>0?"?route=".concat(encodeURI(o)).concat(encodeURIComponent(r),"&").concat(n.join("&")):"?route=".concat(encodeURI(o)).concat(encodeURIComponent(r))},t.prototype.didSetupFirst=function(e,t,n){window.history.replaceState({routeId:e},"",this.encodePath(t,n))},t.prototype.didPush=function(e){var t=e.routeId;this.thePushingRouteId=t;var n=e.name;window.history.pushState({routeId:t},"",this.encodePath(n,e.params));var i=window.pageYOffset,o=new r.Page(this.engine.app.rootElement,this.engine);this.pushHistory(o,i)},t.prototype.didReplace=function(e){var t=e.routeId;this.thePushingRouteId=t;var n=e.name;window.history.replaceState({routeId:t},"",this.encodePath(n,e.params));var i=new r.Page(this.engine.app.rootElement,this.engine);this.replaceHistory(i)},t.prototype.didPop=function(){var e=this;this.doBacking=!0,window.history.back(),this.popHistory(),setTimeout((function(){e.doBacking=!1}),100)},t.prototype.pushHistory=function(e,t){this.history.forEach((function(e){return e.item.active=!1})),this.history.push({item:e,scrollPosition:t}),window.scrollTo(0,0)},t.prototype.replaceHistory=function(e){this.history.forEach((function(e){return e.item.active=!1})),this.history[this.history.length-1]={item:e,scrollPosition:0},window.scrollTo(0,0)},t.prototype.popHistory=function(){this.history.length<=1||(this.history.pop().item.active=!1,this.history[this.history.length-1].item.active=!0,window.scrollTo(0,this.history[this.history.length-1].scrollPosition))},t}(s.Router),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onMethodCall=function(e,t){return __awaiter(this,void 0,void 0,(function(){var n;return __generator(this,(function(i){if("Clipboard.setData"===e)return n=document.createElement("input"),document.body.appendChild(n),n.value=t.text,n.select(),document.execCommand("Copy"),n.remove(),[2,null];if("Clipboard.getData"===e)throw"The operation of getData from clip board is not allow in browser.";if("RootBundle.getAssets"===e)return[2,new Promise((function(e,n){var i=new XMLHttpRequest;i.responseType="blob",i.open("GET","/assets/".concat(decodeURIComponent(t.uri))),i.onloadend=function(){var t=new FileReader;t.onloadend=function(){e(t.result.split("base64,")[1])},t.readAsDataURL(i.response)},i.onerror=function(){n(i.statusText)},i.send()}))];throw"NOTIMPLEMENTED"}))}))},t}(o.MPMethodChannel);i.PluginRegister.registerChannel("flutter/platform",c)},{"./page":50,"./platform_channel/mp_method_channel":52,"./platform_channel/plugin_register":54,"./router":55}],2:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.AbsorbPointer=void 0;var i=e("../component_view"),o=(e("./gesture_detector"),function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.didSetListener=!1,t}return __extends(t,e),t.prototype.elementType=function(){return"div"},t.prototype.setAttributes=function(t){e.prototype.setAttributes.call(this,t),this.didSetListener||(this.didSetListener=!0,this.htmlElement.addEventListener("click",(function(e){e.stopPropagation()})))},t}(i.ComponentView));n.AbsorbPointer=o},{"../component_view":28,"./gesture_detector":12}],3:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.ClipOval=void 0;var i=e("../component_view"),o=e("../dom_utils"),r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.setAttributes=function(t){e.prototype.setAttributes.call(this,t),(0,o.setDOMStyle)(this.htmlElement,{borderRadius:"50%",overflow:"hidden"})},t}(i.ComponentView);n.ClipOval=r},{"../component_view":28,"../dom_utils":30}],4:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.ClipRRectAncestor=n.ClipRRect=void 0;var i=e("../component_view"),o=e("../dom_utils"),r=e("../utils"),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.setAttributes=function(t){var n,i,s,a,l;e.prototype.setAttributes.call(this,t);var c=t.borderRadius?(0,r.cssBorderRadius)(t.borderRadius):{};c.borderRadius?(0,o.setDOMStyle)(this.htmlElement,{borderRadius:null!==(n=c.borderRadius)&&void 0!==n?n:"unset",overflow:"hidden"}):(0,o.setDOMStyle)(this.htmlElement,{borderTopLeftRadius:null!==(i=c.borderTopLeftRadius)&&void 0!==i?i:"unset",borderTopRightRadius:null!==(s=c.borderTopRightRadius)&&void 0!==s?s:"unset",borderBottomLeftRadius:null!==(a=c.borderBottomLeftRadius)&&void 0!==a?a:"unset",borderBottomRightRadius:null!==(l=c.borderBottomRightRadius)&&void 0!==l?l:"unset",overflow:"hidden"})},t}(i.ComponentView);n.ClipRRect=s;var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.setAttributes=function(t){var n,i,o,s,a;e.prototype.setAttributes.call(this,t),this.target.ancestorStyle.opacity||(this.target.ancestorStyle.opacity=1);var l=t.borderRadius?(0,r.cssBorderRadius)(t.borderRadius):{};l.borderRadius?(this.target.ancestorStyle.borderRadius=null!==(n=l.borderRadius)&&void 0!==n?n:"unset",this.target.ancestorStyle.overflow="hidden"):(this.target.ancestorStyle.borderTopLeftRadius=null!==(i=l.borderTopLeftRadius)&&void 0!==i?i:"unset",this.target.ancestorStyle.borderTopRightRadius=null!==(o=l.borderTopRightRadius)&&void 0!==o?o:"unset",this.target.ancestorStyle.borderBottomLeftRadius=null!==(s=l.borderBottomLeftRadius)&&void 0!==s?s:"unset",this.target.ancestorStyle.borderBottomRightRadius=null!==(a=l.borderBottomRightRadius)&&void 0!==a?a:"unset",this.target.ancestorStyle.overflow="hidden")},t}(i.AncestorView);n.ClipRRectAncestor=a},{"../component_view":28,"../dom_utils":30,"../utils":43}],5:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.CollectionViewLayout=n.CollectionView=void 0;var i=e("../../env"),o=e("../component_view"),r=e("../dom_utils"),s=e("../utils"),a=e("./sliver_persistent_header"),l=function(e){function t(t,n){var i=e.call(this,t,n)||this;return i.initialAttributes=n,i.classname="CollectionView",i.wrapperHtmlElement=i.document.createElement("div"),i.appBarPinnedViews=[],i.appBarPersistentHeight=0,i.appBarPinnedPlained=!1,i.enabledRestoration=!1,i.lastScrollX=0,i.lastScrollY=0,i.viewWidth=0,i.viewHeight=0,i.bottomBarHeight=0,i.bottomBarWithSafeArea=!1,i.didAddScrollListener=!1,i.didAddRefreshListener=!1,i.didAddScrollToLowerListener=!1,i.htmlElement.appendChild(i.wrapperHtmlElement),i}return __extends(t,e),t.prototype.elementType=function(){var e;return!0!==(null===(e=this.initialAttributes)||void 0===e?void 0:e.isRoot)?"wx-scroll-view":"div"},t.prototype.dispose=function(){var e;this.didAddScrollListener&&(null===(e=i.MPEnv.platformWindow(this.document))||void 0===e||e.removeEventListener("scroll",this.onWindowScrollEvent),this.htmlElement.removeEventListener("scroll",this.onScrollEvent))},t.prototype.onWindowScrollEvent=function(){var e;if((null===(e=i.MPEnv.platformWindow(this.document))||void 0===e?void 0:e.mpCurrentScrollView)===this){var t=i.MPEnv.platformWindow(this.document);t&&(t.scrollX===this.lastScrollX&&t.scrollY===this.lastScrollY||(this.lastScrollX=t.scrollX,this.lastScrollY=t.scrollY,this.attributes.onScroll&&this.engine.sendMessage(JSON.stringify({type:"scroll_view",message:{event:"onScroll",target:this.attributes.onScroll,scrollLeft:t.scrollX,scrollTop:t.scrollY,viewportDimension:t.innerHeight,scrollHeight:this.document.body.scrollHeight}}))))}},t.prototype.addWindowScrollListener=function(){var e;this.didAddScrollListener||(this.didAddScrollListener=!0,null===(e=i.MPEnv.platformWindow(this.document))||void 0===e||e.addEventListener("scroll",this.onWindowScrollEvent.bind(this)))},t.prototype.onScrollEvent=function(){var e,t;this.htmlElement.scrollLeft===this.lastScrollX&&this.htmlElement.scrollTop===this.lastScrollY||(this.lastScrollX=this.htmlElement.scrollLeft,this.lastScrollY=this.htmlElement.scrollTop,this.attributes.onScroll&&this.engine.sendMessage(JSON.stringify({type:"scroll_view",message:{event:"onScroll",target:this.attributes.onScroll,isRoot:this.attributes.isRoot,scrollLeft:this.htmlElement.scrollLeft,scrollTop:this.htmlElement.scrollTop,viewportDimension:null!==(t=null===(e=this.constraints)||void 0===e?void 0:e.h)&&void 0!==t?t:0,scrollHeight:this.htmlElement.scrollHeight}})),this.htmlElement.scrollTop+this.htmlElement.clientHeight>=this.htmlElement.scrollHeight&&this.onScrollToLowerEvent())},t.prototype.addScrollListener=function(){this.didAddScrollListener||(this.didAddScrollListener=!0,this.htmlElement.addEventListener("scroll",this.onScrollEvent.bind(this)))},t.prototype.onRefreshEvent=function(){return __awaiter(this,void 0,void 0,(function(){var e=this;return __generator(this,(function(t){switch(t.label){case 0:return[4,new Promise((function(t){e.refreshEndResolver=t,e.engine.sendMessage(JSON.stringify({type:"scroll_view",message:{event:"onRefresh",target:e.hashCode,isRoot:e.attributes.isRoot}}))}))];case 1:return t.sent(),this.htmlElement.setAttribute("refresher-triggered","false"),[2]}}))}))},t.prototype.addRefreshListener=function(){this.didAddRefreshListener||(this.didAddRefreshListener=!0,this.htmlElement.addEventListener("refresherrefresh",this.onRefreshEvent.bind(this)))},t.prototype.onScrollToLowerEvent=function(){this.engine.sendMessage(JSON.stringify({type:"scroll_view",message:{event:"onScrollToLower",target:this.hashCode,isRoot:this.attributes.isRoot}}))},t.prototype.jumpTo=function(e){this.attributes.isRoot?i.MPEnv.platformGlobal().pageScrollTo({scrollTop:e}):"Axis.horizontal"===this.attributes.scrollDirection?this.htmlElement.setAttribute("scroll-left",e.toString()):this.htmlElement.setAttribute("scroll-top",e.toString())},t.prototype.addScrollToLowerListener=function(){this.didAddScrollToLowerListener||(this.didAddScrollToLowerListener=!0,this.htmlElement.addEventListener("scrolltolower",this.onScrollToLowerEvent.bind(this)))},t.prototype.didMoveToWindow=function(){e.prototype.didMoveToWindow.call(this),this.enabledRestoration,this.enabledRestoration},t.prototype.setConstraints=function(t){e.prototype.setConstraints.call(this,t),this.viewWidth===t.w&&this.viewHeight===t.h||(this.viewWidth=t.w,this.viewHeight=t.h,this.reloadLayouts())},t.prototype.reloadLayouts=function(){var e,t,n,i,o,s,l,c;this.layout.prepareLayout();for(var u=this.appBarPinnedPlained?0:-this.appBarPersistentHeight,d=this.appBarPersistentHeight,h=0;h<this.subviews.length;h++){var p=this.subviews[h],m=this.layout.layoutAttributesForItemAtIndex(h);m&&(p.collectionViewConstraints={top:m.y.toFixed(1)+"px",left:m.x.toFixed(1)+"px"},(0,r.setDOMStyle)(p.htmlElement,{position:"absolute",top:m.y.toFixed(1)+"px",left:m.x.toFixed(1)+"px",width:m.width.toFixed(1)+"px",height:m.height.toFixed(1)+"px"}),p instanceof a.SliverPersistentHeader&&p.pinned?(p.y=m.y-u,p.h=d,u+=p.y+(null!==(t=null===(e=p.constraints)||void 0===e?void 0:e.h)&&void 0!==t?t:0),d+=null!==(i=null===(n=p.constraints)||void 0===n?void 0:n.h)&&void 0!==i?i:0,p.updateLayout()):p instanceof a.SliverPersistentHeader&&p.lazying&&(p.y=m.y-u,p.h=d,u+=p.y+(null!==(s=null===(o=p.constraints)||void 0===o?void 0:o.h)&&void 0!==s?s:0),d+=null!==(c=null===(l=p.constraints)||void 0===l?void 0:l.h)&&void 0!==c?c:0,p.updateLayout()))}var f=this.layout.collectionViewContentSize();(0,r.setDOMStyle)(this.wrapperHtmlElement,{position:"absolute",top:"0px",left:"0px",width:f.width+"px",height:this.bottomBarWithSafeArea?"calc(".concat(f.height+("div"===this.elementType()?this.bottomBarHeight:0),"px + env(safe-area-inset-bottom))"):f.height+("div"===this.elementType()?this.bottomBarHeight:0)+"px"})},t.prototype.setAttributes=function(t){var n,o;e.prototype.setAttributes.call(this,t);var s="scroll";if(t.scrollDisabled?s="hidden":t.isRoot&&(s="unset"),(0,r.setDOMStyle)(this.htmlElement,{overflow:s}),this.bottomBarHeight=null!==(n=t.bottomBarHeight)&&void 0!==n?n:0,this.bottomBarWithSafeArea=null!==(o=t.bottomBarWithSafeArea)&&void 0!==o&&o,t.restorationId,t.restorationId,this.htmlElement.setAttribute("scroll-x","Axis.horizontal"===this.attributes.scrollDirection?"true":"false"),this.htmlElement.setAttribute("scroll-y","Axis.horizontal"!==this.attributes.scrollDirection?"true":"false"),t.isRoot&&"div"===this.elementType()){var a=i.MPEnv.platformWindow(this.document);a&&(a.mpCurrentScrollView=this),this.addWindowScrollListener()}else this.addScrollListener(),this.addRefreshListener(),this.addScrollToLowerListener(),this.htmlElement.setAttribute("refresher-enabled",t.onRefresh?"true":"false")},t.prototype.addSubview=function(e){e.superview&&e.removeFromSuperview(),this.subviews.push(e),e.superview=this,this.wrapperHtmlElement.appendChild(e.htmlElement),e.didMoveToWindow()},t.prototype.setPinnedAppBar=function(e){var t,n,i=this;if(e.appBarPinnedPlained){var o=this.factory.create(e.appBarPinned,this.document);return this.appBarPersistentHeight=(0,s.cssSizeFromMPElement)(o).height,void(this.appBarPinnedPlained=!0)}this.appBarPinnedPlained=!1;var a=this.factory.create(e.appBarPinned,this.document);if(a){a.collectionViewFixed=!0;var l=null!==(n=null===(t=a.constraints)||void 0===t?void 0:t.h)&&void 0!==n?n:0,c=0,u=1===(null==a?void 0:a.subviews.length)?0:1;null==a||a.subviews.slice().forEach((function(e,t){var n,o,d,h,p,m,f,v;t===u-1&&(c+=null!==(o=null===(n=e.constraints)||void 0===n?void 0:n.h)&&void 0!==o?o:0),t===u?((0,r.setDOMStyle)(e.htmlElement,{marginTop:-(l-c)+"px",top:"0px",position:"sticky",zIndex:"9999",backgroundColor:(null!==(h=null===(d=a.attributes)||void 0===d?void 0:d.color)&&void 0!==h?h:null===(p=a.attributes)||void 0===p?void 0:p.backgroundColor)?(0,s.cssColor)(null!==(f=null===(m=a.attributes)||void 0===m?void 0:m.color)&&void 0!==f?f:null===(v=a.attributes)||void 0===v?void 0:v.backgroundColor):"unset"}),i.appBarPersistentHeight=(0,s.cssSizeFromMPElement)(e).height):(0,r.setDOMStyle)(e.htmlElement,{marginTop:-l+"px"}),i.appBarPinnedViews.push(e)})),this.appBarPinnedViews.reverse().forEach((function(e){return i.addSubviewForPinnedAppBar(e)})),(0,r.setDOMStyle)(a.htmlElement,{pointerEvents:"none",display:"none"})}},t.prototype.addSubviewForPinnedAppBar=function(e){e.superview&&e.removeFromSuperview(),e.superview=this,this.wrapperHtmlElement.firstChild?this.wrapperHtmlElement.insertBefore(e.htmlElement,this.wrapperHtmlElement.firstChild):this.wrapperHtmlElement.appendChild(e.htmlElement),e.didMoveToWindow()},t}(o.ComponentView);n.CollectionView=l;var c=function(){function e(e){this.collectionView=e}return e.prototype.prepareLayout=function(){},e.prototype.layoutAttributesForItemAtIndex=function(e){throw""},e.prototype.collectionViewContentSize=function(){throw""},e}();n.CollectionViewLayout=c},{"../../env":46,"../component_view":28,"../dom_utils":30,"../utils":43,"./sliver_persistent_header":23}],6:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.ColoredBox=void 0;var i=e("../component_view"),o=e("../dom_utils"),r=e("../utils"),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.setAttributes=function(t){e.prototype.setAttributes.call(this,t),(0,o.setDOMStyle)(this.htmlElement,{backgroundColor:t.color?(0,r.cssColor)(t.color):"unset"})},t}(i.ComponentView);n.ColoredBox=s},{"../component_view":28,"../dom_utils":30,"../utils":43}],7:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.CustomPaint=n.MPDrawable=void 0;var i=e("../../env"),o=e("../component_view"),r=e("../dom_utils"),s=e("../utils"),a=function(){function e(e){this.engine=e,this.decodedDrawables={}}return e.prototype.decodeDrawable=function(t){return __awaiter(this,void 0,void 0,(function(){var n,o;return __generator(this,(function(r){switch(r.label){case 0:e.offscreenCanvas||(e.offscreenCanvas=i.MPEnv.platformScope.createOffscreenCanvas()),r.label=1;case 1:return r.trys.push([1,9,,10]),"networkImage"!==t.type?[3,3]:[4,this.decodeNetworkImage(t.url,t.target)];case 2:return n=r.sent(),this.engine.sendMessage(JSON.stringify({type:"decode_drawable",message:{event:"onDecode",target:t.target,width:n.width,height:n.height}})),[3,8];case 3:return"memoryImage"!==t.type?[3,5]:[4,this.decodeMemoryImage(t.data,t.imageType,t.target)];case 4:return n=r.sent(),this.engine.sendMessage(JSON.stringify({type:"decode_drawable",message:{event:"onDecode",target:t.target,width:n.width,height:n.height}})),[3,8];case 5:return"assetImage"!==t.type?[3,7]:[4,this.decodeAssetImage(t.assetName,t.assetPkg,t.target)];case 6:return n=r.sent(),this.engine.sendMessage(JSON.stringify({type:"decode_drawable",message:{event:"onDecode",target:t.target,width:n.width,height:n.height}})),[3,8];case 7:if("dispose"!==t.type)throw new Error("Unknown drawable type.");delete this.decodedDrawables[t.target],r.label=8;case 8:return[3,10];case 9:return o=r.sent(),this.engine.sendMessage(JSON.stringify({type:"decode_drawable",message:{event:"onError",target:t.target,error:null==o?void 0:o.toString()}})),[3,10];case 10:return[2]}}))}))},e.prototype.decodeNetworkImage=function(t,n){return __awaiter(this,void 0,void 0,(function(){var i=this;return __generator(this,(function(o){return[2,new Promise((function(o,r){var s=e.offscreenCanvas.createImage();s.onload=function(){i.decodedDrawables[n]=s,o({width:s.width,height:s.height})},s.onerror=function(){r("")},s.src=t}))]}))}))},e.prototype.decodeMemoryImage=function(t,n,i){return __awaiter(this,void 0,void 0,(function(){var o=this;return __generator(this,(function(r){return[2,new Promise((function(r,s){var a=e.offscreenCanvas.createImage();a.onload=function(){o.decodedDrawables[i]=a,r({width:a.width,height:a.height})},a.onerror=function(){s("")},a.src="data:image/".concat(null!=n?n:"png",";base64,").concat(t)}))]}))}))},e.prototype.decodeAssetImage=function(t,n,i){return __awaiter(this,void 0,void 0,(function(){var o=this;return __generator(this,(function(r){return[2,new Promise((function(r,s){var a=e.offscreenCanvas.createImage();if(a.onload=function(){o.decodedDrawables[i]=a,r({width:a.width,height:a.height})},a.onerror=function(){s("")},o.engine.debugger){var l=n?"http://".concat(o.engine.debugger.serverAddr,"/assets/packages/").concat(n,"/").concat(t):"http://".concat(o.engine.debugger.serverAddr,"/assets/").concat(t);a.src=l}else{l="/"+(l=n?"assets/packages/".concat(n,"/").concat(t):"assets/".concat(t)),a.src=l}}))]}))}))},e}();n.MPDrawable=a;var l=function(e){function t(t){var n=e.call(this,t)||this;return n.document=t,n.canvasWidth=0,n.canvasHeight=0,n.htmlElement.setAttribute("type","2d"),n}return __extends(t,e),t.didReceivedCustomPaintMessage=function(e,t){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(n){return"fetchImage"===e.event?this.fetchImage(e,t):"asyncPaint"===e.event&&this.asyncPaint(e,t),[2]}))}))},t.fetchImage=function(e,t){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(n){switch(n.label){case 0:return t.componentFactory.cachedView[e.target],[3,1];case 1:return[3,3];case 2:n.sent().fields({node:!0},(function(n){var i=n.node.toDataURL().split("base64,")[1];t.sendMessage(JSON.stringify({type:"custom_paint",message:{event:"onFetchImageResult",seqId:e.seqId,data:i}}))})).exec(),n.label=3;case 3:return[2]}}))}))},t.asyncPaint=function(e,n){return __awaiter(this,void 0,void 0,(function(){var i,o;return __generator(this,(function(r){switch(r.label){case 0:return(i=n.componentFactory.cachedView[e.target])instanceof t?[4,i.createContext()]:[3,2];case 1:o=r.sent(),e.commands&&i.drawWithCommands(e.commands,o),r.label=2;case 2:return[2]}}))}))},t.prototype.elementType=function(){return"canvas"},t.prototype.setConstraints=function(e){if(e){var t=e.x,n=e.y,i=e.w,o=e.h;"number"==typeof t&&"number"==typeof n&&"number"==typeof i&&"number"==typeof o&&((0,r.setDOMStyle)(this.htmlElement,{left:t+"px",top:n+"px",width:i+"px",height:o+"px"}),this.canvasWidth===i&&this.canvasHeight==o||(this.canvasWidth=i,this.canvasHeight=o))}},t.prototype.createContext=function(){return __awaiter(this,void 0,void 0,(function(){var e=this;return __generator(this,(function(t){return[2,new Promise((function(t){setTimeout((function(){return __awaiter(e,void 0,void 0,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,this.htmlElement.$$getNodesRef()];case 1:return e.sent().fields({node:!0,size:!0},(function(e){var n=e.node,o=n.getContext("2d"),r=i.MPEnv.platformScope.getSystemInfoSync().pixelRatio;n.width=e.width*r,n.height=e.height*r,o.scale(r,r),t(o)})).exec(),[2]}}))}))}),16)}))]}))}))},t.prototype.drawWithCommands=function(e,t){var n=this;t.save(),e.forEach((function(e){"drawRect"===e.action?n.drawRect(t,e):"drawPath"===e.action?n.drawPath(t,e):"drawDRRect"===e.action?n.drawDRRect(t,e):"clipPath"===e.action?n.drawPath(t,e):"drawColor"===e.action?n.drawColor(t,e):"drawImage"===e.action?n.drawImage(t,e):"drawImageRect"===e.action?n.drawImageRect(t,e):"drawText"===e.action?n.drawText(t,e):"restore"===e.action?t.restore():"rotate"===e.action?t.rotate(e.radians):"save"===e.action?t.save():"scale"===e.action?t.scale(e.sx,e.sy):"skew"===e.action?t.transform(1,e.sy,e.sx,1,0,0):"transform"===e.action?t.transform(e.a,e.b,e.c,e.d,e.tx,e.ty):"translate"===e.action&&t.translate(e.dx,e.dy)})),t.restore()},t.prototype.setAttributes=function(t){var n;return __awaiter(this,void 0,void 0,(function(){var i,o;return __generator(this,(function(r){switch(r.label){case 0:return e.prototype.setAttributes.call(this,t),null===(n=this.ctx)||void 0===n?[3,1]:(o=n,[3,3]);case 1:return[4,this.createContext()];case 2:o=r.sent(),r.label=3;case 3:return(i=o)?(this.ctx||(this.ctx=i),t.commands&&this.drawWithCommands(t.commands,i),[2]):[2]}}))}))},t.prototype.drawRect=function(e,t){this.setPaint(e,t.paint),"PaintingStyle.fill"===t.paint.style?e.fillRect(t.x,t.y,t.width,t.height):e.strokeRect(t.x,t.y,t.width,t.height)},t.prototype.drawPath=function(e,t){this.setPaint(e,t.paint),this.drawRealPath(e,t.path),"clipPath"===t.action?e.clip():"PaintingStyle.fill"===t.paint.style?e.fill():e.stroke()},t.prototype.drawDRRect=function(e,t){var n=document.createElement("canvas");n.width=e.canvas.width,n.height=e.canvas.height;var i=n.getContext("2d");this.setPaint(i,t.paint),this.drawRealPath(i,t.outer),"PaintingStyle.fill"===t.paint.style?i.fill():i.stroke(),i.save(),i.fillStyle="white",i.globalCompositeOperation="xor",this.drawRealPath(i,t.inner),i.fill(),i.restore(),e.drawImage(n,0,0)},t.prototype.drawRealPath=function(e,t){e.beginPath(),t.commands.forEach((function(t){"moveTo"===t.action?e.moveTo(t.x,t.y):"lineTo"===t.action?e.lineTo(t.x,t.y):"quadraticBezierTo"===t.action?e.quadraticCurveTo(t.x1,t.y1,t.x2,t.y2):"cubicTo"===t.action?e.bezierCurveTo(t.x1,t.y1,t.x2,t.y2,t.x3,t.y3):"arcTo"===t.action?e.ellipse(t.x,t.y,t.width/2,t.height/2,0,t.startAngle,t.startAngle+t.sweepAngle,t.sweepAngle<0):"arcToPoint"===t.action?e.arcTo(t.arcControlX,t.arcControlY,t.arcEndX,t.arcEndY,t.radiusX):"close"===t.action&&e.closePath()}))},t.prototype.drawColor=function(e,t){"BlendMode.clear"===t.blendMode?e.clearRect(0,0,e.canvas.width,e.canvas.height):(e.fillStyle=(0,s.cssColor)(t.color),e.fillRect(0,0,e.canvas.width,e.canvas.height))},t.prototype.drawImage=function(e,t){this.setPaint(e,t.paint);var n=this.engine.drawable.decodedDrawables[t.drawable];n&&e.drawImage(n,t.dx,t.dy)},t.prototype.drawImageRect=function(e,t){this.setPaint(e,t.paint);var n=this.engine.drawable.decodedDrawables[t.drawable];n&&e.drawImage(n,t.srcX,t.srcY,t.srcW,t.srcH,t.dstX,t.dstY,t.dstW,t.dstH)},t.prototype.drawText=function(e,t){var n=t.text,i=t.style,o=t.offset;this.setTextStyle(e,i),this.setPaint(e,t.paint),"PaintingStyle.fill"===t.paint.style?e.fillText(n,o.x,o.y):e.strokeText(n,o.x,o.y)},t.prototype.setTextStyle=function(e,t){var n,i,o,r="".concat((null!==(n=t.fontSize)&&void 0!==n?n:14).toString(),"px ").concat(null!==(i=t.fontFamily)&&void 0!==i?i:"system-ui"),a=(0,s.getFontWeightStyle)(t);a&&(r=a+" "+r);var l=(0,s.getFontStyleStyle)(t);l&&(r=l+" "+r),e.font=r,e.textBaseline=null!==(o=(0,s.getBaselineStyle)(t))&&void 0!==o?o:"middle"},t.prototype.setPaint=function(e,t){var n;t&&(e.lineWidth=t.strokeWidth,e.miterLimit=t.strokeMiterLimit,e.lineCap=t.strokeCap.replace("StrokeCap.",""),e.lineJoin=t.strokeJoin.replace("StrokeJoin.",""),"PaintingStyle.fill"===t.style?(e.fillStyle=(0,s.cssColor)(t.color),e.strokeStyle="transparent"):(e.fillStyle="transparent",e.strokeStyle=(0,s.cssColor)(t.color)),e.globalAlpha=null!==(n=t.alpha)&&void 0!==n?n:1)},t}(o.ComponentView);n.CustomPaint=l},{"../../env":46,"../component_view":28,"../dom_utils":30,"../utils":43}],8:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.CustomScrollView=void 0;var i=e("../utils"),o=e("./collection_view"),r=e("./grid_list_layout"),s=function(e){function t(t,n){var i=e.call(this,t,n)||this;return i.initialAttributes=n,i.listChildren=[],i.layout=new a(i),i}return __extends(t,e),t.prototype.setChildren=function(t){var n=this;if(t){var i=[],o={},r={};t.forEach((function(e,t){var s,a,l,c,u,d,h,p;"sliver_list"===e.name&&e.children?(o[i.length]=e.attributes,n.factory.fetchCachedChildren(e.children).forEach((function(e){i.push(e)})),r[i.length-1]=!0):"sliver_list"===(null===(a=null===(s=e.children)||void 0===s?void 0:s[0])||void 0===a?void 0:a.name)&&(null===(c=null===(l=e.children)||void 0===l?void 0:l[0])||void 0===c?void 0:c.children)?(o[i.length]=e.children[0].attributes,n.factory.fetchCachedChildren(e.children[0].children).forEach((function(e,t){i.push(e)})),r[i.length-1]=!0):"sliver_grid"===e.name&&e.children?(o[i.length]=e.attributes,n.factory.fetchCachedChildren(e.children).forEach((function(e){i.push(e)})),r[i.length-1]=!0):"sliver_grid"===(null===(d=null===(u=e.children)||void 0===u?void 0:u[0])||void 0===d?void 0:d.name)&&(null===(p=null===(h=e.children)||void 0===h?void 0:h[0])||void 0===p?void 0:p.children)?(o[i.length]=e.children[0].attributes,n.factory.fetchCachedChildren(e.children[0].children).forEach((function(e){i.push(e)})),r[i.length-1]=!0):i.push(e)})),this.listChildren=i,this.layout.items=i,this.layout.sliverGridAttributes=o,this.layout.sliverGridEndIndex=r,e.prototype.setChildren.call(this,i),this.reloadLayouts()}},t.prototype.setAttributes=function(t){e.prototype.setAttributes.call(this,t),this.layout.isHorizontalScroll="Axis.horizontal"===t.scrollDirection,t.appBarPinned?this.setPinnedAppBar(t):this.appBarPinnedViews.length&&(this.appBarPinnedViews.forEach((function(e){return e.removeFromSuperview()})),this.appBarPinnedViews=[],this.appBarPersistentHeight=0)},t}(o.CollectionView);n.CustomScrollView=s;var a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isHorizontalScroll=!1,t.items=[],t.maxVLength=0,t.itemLayouts=[],t.sliverGridAttributes={},t.sliverGridEndIndex={},t}return __extends(t,e),t.prototype.prepareLayout=function(){var e=this,t=this.collectionView.viewWidth,n=this.collectionView.viewHeight;if(!(this.isHorizontalScroll&&n<=.01)&&(this.isHorizontalScroll||!(t<=.01))){var o,s=[],a=0,l=0;this.items.forEach((function(c,u){var d,h,p,m;if(e.sliverGridAttributes[u]){l=0,(o=new r.GridListLayout(e.collectionView)).isHorizontalScroll=e.isHorizontalScroll;for(var f=[],v=u;v<e.items.length&&(f.push(e.items[v]),!e.sliverGridEndIndex[v]);v++);o.clientWidth=e.collectionView.viewWidth,o.clientHeight=e.collectionView.viewHeight;var g=e.sliverGridAttributes[u].gridDelegate;if(g&&(o.isPlain="SliverWaterfallDelegate"!==g.classname,o.crossAxisCount=g.crossAxisCount,o.mainAxisSpacing=g.mainAxisSpacing,o.crossAxisSpacing=g.crossAxisSpacing),e.sliverGridAttributes[u].padding){var y=(0,i.cssPadding)(e.sliverGridAttributes[u].padding);o.padding.top=parseFloat(null!==(d=y.paddingTop)&&void 0!==d?d:"0.0"),o.padding.left=parseFloat(null!==(h=y.paddingLeft)&&void 0!==h?h:"0.0"),o.padding.bottom=parseFloat(null!==(p=y.paddingBottom)&&void 0!==p?p:"0.0"),o.padding.right=parseFloat(null!==(m=y.paddingRight)&&void 0!==m?m:"0.0")}o.items=f,o.prepareLayout()}if(o){if(l<o.itemLayouts.length){var b=__assign({},o.itemLayouts[l]);e.isHorizontalScroll?b.x+=a:b.y+=a,s.push(b)}else s.push({x:0,y:0,width:0,height:0});l++}if(e.sliverGridEndIndex[u]&&o)return e.isHorizontalScroll?a+=o.collectionViewContentSize().width:a+=o.collectionViewContentSize().height,e.maxVLength=a,void(o=void 0);if(!o){var w,_=(0,i.cssSizeFromMPElement)(c);e.isHorizontalScroll?(w={x:a,y:0,width:_.width,height:n},a+=_.width):(w={x:0,y:a,width:t,height:_.height},"sliver_persistent_header"===c.name&&c.attributes.lazying||(a+=_.height)),e.maxVLength=a,s.push(w)}})),this.itemLayouts=s}},t.prototype.collectionViewContentSize=function(){return this.isHorizontalScroll?{width:this.maxVLength,height:this.collectionView.viewHeight}:{width:this.collectionView.viewWidth,height:this.maxVLength}},t.prototype.layoutAttributesForItemAtIndex=function(e){return this.itemLayouts[e]},t}(o.CollectionViewLayout)},{"../utils":43,"./collection_view":5,"./grid_list_layout":13}],9:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.DecoratedBox=void 0;var i=e("../component_view"),o=e("../dom_utils"),r=e("../utils"),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.setAttributes=function(t,n,i){var s,a,l,c,u,d,h,p,m,f=this;void 0===n&&(n={}),void 0===i&&(i=this.htmlElement),e.prototype.setAttributes.call(this,t);var v=null!=n?n:{};if(t.color?v.backgroundColor=(0,r.cssColor)(t.color):t.image?(v.backgroundImage='url("'.concat(t.image.src?t.image.src:t.image.assetName?f.engine.debugger?t.image.assetPkg?"http://".concat(f.engine.debugger.serverAddr,"/assets/packages/").concat(t.image.assetPkg,"/").concat(t.image.assetName):"http://".concat(f.engine.debugger.serverAddr,"/assets/").concat(t.image.assetName):"/"+(t.image.assetPkg?"assets/packages/".concat(t.image.assetPkg,"/").concat(t.assetName):"assets/".concat(t.image.assetName)):void 0,'")'),"BoxFit.cover"===t.image.fit?v.backgroundSize="cover":v.backgroundSize="contain",v.backgroundRepeat="no-repeat"):(null===(s=t.decoration)||void 0===s?void 0:s.gradient)?v.backgroundImage?v.backgroundImage=(0,r.cssGradient)(t.decoration.gradient)+","+v.backgroundImage:v.background=(0,r.cssGradient)(t.decoration.gradient):(v.backgroundImage="unset",v.background="unset"),null===(l=null===(a=t.decoration)||void 0===a?void 0:a.boxShadow)||void 0===l?void 0:l[0]){var g=null===(u=null===(c=t.decoration)||void 0===c?void 0:c.boxShadow)||void 0===u?void 0:u[0];v.boxShadow="".concat(null===(d=(0,r.cssOffset)(g.offset))||void 0===d?void 0:d.dx,"px ").concat(null===(h=(0,r.cssOffset)(g.offset))||void 0===h?void 0:h.dy,"px ").concat(g.blurRadius,"px ").concat(g.spreadRadius,"px ").concat((0,r.cssColor)(g.color))}if(null===(p=t.decoration)||void 0===p?void 0:p.borderRadius){var y=(0,r.cssBorderRadius)(t.decoration.borderRadius);for(var b in y)v[b]=y[b]}else v.borderRadius="0px";if(null===(m=t.decoration)||void 0===m?void 0:m.border){y=(0,r.cssBorder)(t.decoration.border);for(var b in y.boxSizing="border-box",y)v[b]=y[b]}else v.border="none";(0,o.setDOMStyle)(i,v)},t}(i.ComponentView);n.DecoratedBox=s},{"../component_view":28,"../dom_utils":30,"../utils":43}],10:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.EditableText=void 0;var i=e("../component_view"),o=e("../dom_utils"),r=e("../utils"),s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.contentElementType="",t.didSetListener=!1,t}return __extends(t,e),t.prototype.setAttributes=function(t){var n,i,s=this;e.prototype.setAttributes.call(this,t);var a=t.maxLines;if(a>1&&"textarea"!==this.contentElementType?(null===(n=this.contentElement)||void 0===n||n.remove(),this.contentElement=this.document.createElement("textarea"),this.didSetListener=!1,this.contentElementType="textarea",(0,o.setDOMStyle)(this.contentElement,{width:"100%",height:"100%",backgroundColor:"transparent",border:"none",resize:"none"}),this.htmlElement.appendChild(this.contentElement)):a<=1&&"input"!==this.contentElementType&&(null===(i=this.contentElement)||void 0===i||i.remove(),this.contentElement=this.document.createElement("input"),this.didSetListener=!1,this.contentElementType="input",(0,o.setDOMStyle)(this.contentElement,{width:"100%",height:"100%",backgroundColor:"transparent",border:"none"}),this.htmlElement.appendChild(this.contentElement)),this.contentElement){if(t.placeholderStyle){var l="";t.placeholderStyle.color&&(l+="color: ".concat((0,r.cssColor)(t.placeholderStyle.color),";")),(0,o.setDOMAttribute)(this.contentElement,"placeholder-style",l)}if(this.contentElement.onkeyup=function(e){"Enter"!==e.key&&13!==e.keyCode||s._onSubmitted(e.target,e.target.value)},this.didSetListener||(this.didSetListener=!0,this.contentElement.addEventListener("submit",(function(e){var t,n;s._onSubmitted(e.target,null!==(n=null===(t=e.detail)||void 0===t?void 0:t.value)&&void 0!==n?n:e.target.value)})),this.contentElement.addEventListener("confirm",(function(e){var t,n;s._onSubmitted(e.target,null!==(n=null===(t=e.detail)||void 0===t?void 0:t.value)&&void 0!==n?n:e.target.value)})),this.contentElement.addEventListener("input",(function(e){var t,n;s._onChanged(e.target,null!==(n=null===(t=e.detail)||void 0===t?void 0:t.value)&&void 0!==n?n:e.target.value)})),this.contentElement.addEventListener("focus",(function(){s.engine.sendMessage(JSON.stringify({type:"editable_text",message:{event:"onFocus",target:s.hashCode}}))})),this.contentElement.addEventListener("blur",(function(){s.engine.sendMessage(JSON.stringify({type:"editable_text",message:{event:"onBlur",target:s.hashCode}}))}))),this.contentElement.onchange=function(e){var t,n;s._onChanged(e.target,null!==(n=null===(t=e.detail)||void 0===t?void 0:t.value)&&void 0!==n?n:e.target.value)},t.style){var c=(0,r.cssTextStyle)(t.style);delete c.userSelect,delete c.WebkitUserSelect,(0,o.setDOMStyle)(this.contentElement,__assign(__assign({},c),{textAlign:(0,r.cssTextAlign)(t.textAlign),boxSizing:"border-box"}))}(0,o.setDOMAttribute)(this.contentElement,"type",t.obscureText?"password":this._keyboardType(t.keyboardType));this._keyboardPattern(t.keyboardType);0,"string"==typeof t.value&&(0,o.setDOMAttribute)(this.contentElement,"value",t.value),t.autofocus&&(0,o.setDOMAttribute)(this.contentElement,"auto-focus",t.autofocus),t.autoCorrect&&(0,o.setDOMAttribute)(this.contentElement,"auto-correct",t.autoCorrect),t.placeholder&&(0,o.setDOMAttribute)(this.contentElement,"placeholder",t.placeholder),t.maxLength&&(0,o.setDOMAttribute)(this.contentElement,"maxlength",t.maxLength),(0,o.setDOMAttribute)(this.contentElement,"disabled",t.readOnly?"true":void 0),(0,o.setDOMAttribute)(this.contentElement,"confirm-type",this._textInputAction(t.textInputAction))}},t.prototype.setChildren=function(){},t.prototype._keyboardType=function(e){return(null==e?void 0:e.indexOf("TextInputType.number"))>=0?"number":"text"},t.prototype._keyboardPattern=function(e){if((null==e?void 0:e.indexOf("TextInputType.number"))>=0){var t=e.indexOf("signed: true")>=0,n=e.indexOf("decimal: true")>=0;if(t&&n)return"[0-9+-.]*";if(t&&!n)return"[0-9+-]*";if(!t&&!n)return"[0-9]*";if(!t&&n)return"[0-9+.]*"}return""},t.prototype._textInputAction=function(e){return e.replace("TextInputAction.","")},t.prototype._onSubmitted=function(e,t){this.attributes.onSubmitted&&(this.engine.sendMessage(JSON.stringify({type:"editable_text",message:{event:"onSubmitted",target:this.attributes.onSubmitted,data:t}})),e.blur())},t.prototype._onChanged=function(e,t){this.attributes.onChanged&&this.engine.sendMessage(JSON.stringify({type:"editable_text",message:{event:"onChanged",target:this.attributes.onChanged,data:t}}))},t}(i.ComponentView);n.EditableText=s},{"../component_view":28,"../dom_utils":30,"../utils":43}],11:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.ForegroundDecoratedBox=void 0;var i=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.decorateElement=t.document.createElement("div"),t}return __extends(t,e),t.prototype.setChildren=function(t){e.prototype.setChildren.call(this,t),this.decorateElement.remove(),this.htmlElement.appendChild(this.decorateElement)},t.prototype.setAttributes=function(t){e.prototype.setAttributes.call(this,t,{position:"absolute",top:"0px",left:"0px",width:"100%",height:"100%"},this.decorateElement)},t}(e("./decorated_box").DecoratedBox);n.ForegroundDecoratedBox=i},{"./decorated_box":9}],12:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.GestureDetector=void 0;var i=e("../../env"),o=function(e){function t(t){var n=e.call(this,t)||this;return n.document=t,n.classname="GestureDetector",n.didSetOnClicked=!1,n.didSetOnLongPressOrPan=!1,n.longPressing=!1,n.htmlElement.isGestureDetector=!0,n.setupCursor(),n}return __extends(t,e),t.prototype.setupCursor=function(){i.MPEnv.platformPC()&&(this.htmlElement.style.cursor="pointer")},t.prototype.elementType=function(){return"div"},t.prototype.setAttributes=function(t){var n=this;e.prototype.setAttributes.call(this,t),t.onTap&&(this.didSetOnClicked||(this.didSetOnClicked=!0,this.htmlElement.addEventListener("click",(function(e){n.engine.sendMessage(JSON.stringify({type:"gesture_detector",message:{event:"onTap",target:t.onTap}})),e.stopPropagation()})))),(t.onLongPress||t.onLongPressStart||t.onLongPressMoveUpdate||t.onLongPressEnd||t.onPanStart||t.onPanUpdate||t.onPanEnd)&&(this.didSetOnLongPressOrPan||(this.didSetOnLongPressOrPan=!0,this.setupLongPressOrPanCatcher()))},t.prototype.findGestureDetectorElement=function(e){for(var t=0;t<e.length;t++){var n=e[t];if(n.isGestureDetector)return n}},t.prototype.setupLongPressOrPanCatcher=function(){var e=this;this.htmlElement.addEventListener("touchstart",(function(t){e._onTouchStart(t)}),!0),this.htmlElement.addEventListener("touchmove",(function(t){e._onTouchMove(t)}),!0),this.htmlElement.addEventListener("touchend",(function(t){e._onTouchEnd(t)}),!0),this.htmlElement.addEventListener("touchcancel",(function(t){e.longPressTimer&&(clearTimeout(e.longPressTimer),e.longPressTimer=void 0),e.longPressing=!1}),!0)},t.prototype._onTouchStart=function(e){var t;return __awaiter(this,void 0,void 0,(function(){var n,i,o,r=this;return __generator(this,(function(s){switch(s.label){case 0:return"CANVAS"===(null===(t=e.target)||void 0===t?void 0:t.tagName)?[2]:[4,this.htmlElement.getBoundingClientRect()];case 1:return i=s.sent(),[3,3];case 2:i=this.htmlElement.getBoundingClientRect(),s.label=3;case 3:return n=i,this.targetOriginInPage={x:n.left,y:n.top},o=this.attributes.onPanStart||this.attributes.onPanUpdate||this.attributes.onPanEnd,(this.attributes.onLongPress||this.attributes.onLongPressStart||this.attributes.onLongPressEnd||this.attributes.onLongPressMoveUpdate||o)&&(this.touchStartPosition={x:e.touches[0].clientX,y:e.touches[0].clientY},this.longPressTimer=setTimeout((function(){r.longPressTimer&&(r.longPressing=!0,r.attributes.onLongPress&&r.engine.sendMessage(JSON.stringify({type:"gesture_detector",message:{event:"onLongPress",target:r.attributes.onLongPress}})),(r.attributes.onLongPressStart||r.attributes.onPanStart)&&r.engine.sendMessage(JSON.stringify({type:"gesture_detector",message:{event:r.attributes.onPanStart?"onPanStart":"onLongPressStart",target:r.attributes.onPanStart?r.attributes.onPanStart:r.attributes.onLongPressStart,globalX:e.touches[0].clientX,globalY:e.touches[0].clientY,localX:e.touches[0].clientX-r.targetOriginInPage.x,localY:e.touches[0].clientY-r.targetOriginInPage.y}})),r.longPressTimer=void 0)}),o?0:300),o&&e.preventDefault()),[2]}}))}))},t.prototype._onTouchMove=function(e){var t;if("CANVAS"!==(null===(t=e.target)||void 0===t?void 0:t.tagName))if(this.longPressing&&(this.attributes.onLongPressMoveUpdate||this.attributes.onPanUpdate))this.engine.sendMessage(JSON.stringify({type:"gesture_detector",message:{event:this.attributes.onPanUpdate?"onPanUpdate":"onLongPressMoveUpdate",target:this.attributes.onPanUpdate?this.attributes.onPanUpdate:this.attributes.onLongPressMoveUpdate,globalX:e.touches[0].clientX,globalY:e.touches[0].clientY,localX:e.touches[0].clientX-this.targetOriginInPage.x,localY:e.touches[0].clientY-this.targetOriginInPage.y}})),e.preventDefault();else if(this.longPressTimer&&this.touchStartPosition){var n={x:e.touches[0].clientX,y:e.touches[0].clientY},i=Math.abs(n.x-this.touchStartPosition.x),o=Math.abs(n.y-this.touchStartPosition.y);(i>8||o>8)&&(clearTimeout(this.longPressTimer),this.longPressTimer=void 0)}},t.prototype._onTouchEnd=function(e){var t;"CANVAS"!==(null===(t=e.target)||void 0===t?void 0:t.tagName)&&(this.longPressing&&(this.attributes.onLongPressEnd||this.attributes.onPanEnd)?(this.engine.sendMessage(JSON.stringify({type:"gesture_detector",message:{event:this.attributes.onPanEnd?"onPanEnd":"onLongPressEnd",target:this.attributes.onPanEnd?this.attributes.onPanEnd:this.attributes.onLongPressEnd}})),e.preventDefault()):this.longPressTimer&&(clearTimeout(this.longPressTimer),this.longPressTimer=void 0),this.longPressing=!1)},t}(e("../component_view").ComponentView);n.GestureDetector=o},{"../../env":46,"../component_view":28}],13:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.GridListLayout=void 0;var i=e("../utils"),o=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isPlain=!0,t.isHorizontalScroll=!1,t.padding={top:0,left:0,bottom:0,right:0},t.clientWidth=0,t.clientHeight=0,t.crossAxisCount=0,t.crossAxisSpacing=0,t.mainAxisSpacing=0,t.items=[],t.maxVLength=0,t.itemLayouts=[],t}return __extends(t,e),t.prototype.prepareLayout=function(){this.isPlain?this.preparePlainLayout():this.prepareWaterfallLayout()},t.prototype.preparePlainLayout=function(){var e=this,t=(this.clientWidth>0?this.clientWidth:this.collectionView.viewWidth)-this.padding.right,n=(this.clientHeight>0?this.clientHeight:this.collectionView.viewHeight)-this.padding.bottom,o=[],r=this.padding.left,s=this.padding.top,a=0;this.items.forEach((function(l,c){var u=(0,i.cssSizeFromMPElement)(l),d=u.width,h=u.height;if(e.isHorizontalScroll){var p={x:r,y:s,width:d,height:h};s+=h+e.crossAxisSpacing,a=Math.max(r+d,a),s+h-n>.1&&(s=e.padding.top,c+1<e.items.length&&(r+=d+e.mainAxisSpacing)),o.push(p)}else{p={x:r,y:s,width:d,height:h};r+=d+e.crossAxisSpacing,a=Math.max(s+h,a),r+d-t>.1&&(r=e.padding.left,c+1<e.items.length&&(s+=h+e.mainAxisSpacing)),o.push(p)}})),this.isHorizontalScroll?a+=this.padding.right:a+=this.padding.bottom,this.itemLayouts=o,this.maxVLength=a},t.prototype.prepareWaterfallLayout=function(){var e=this;if(this.crossAxisCount<=0)this.itemLayouts=[];else{var t=0,n={},o=[],r=0;this.items.forEach((function(s,a){var l=(0,i.cssSizeFromMPElement)(s),c=l.width,u=l.height,d=e.isHorizontalScroll?e.padding.left:e.padding.top,h=t,p=h+1>=e.crossAxisCount?0:h+1;if(n[h]&&n[p]){var m=n[h],f=n[p];t=e.isHorizontalScroll?f.x+f.width<m.x+m.width?p:h:f.y+f.height<m.y+m.height?p:h}else t=h;if(n[t]){m=n[t];e.isHorizontalScroll?(d=m.x+m.width,a>=e.crossAxisCount&&(d+=e.mainAxisSpacing)):(d=m.y+m.height,a>=e.crossAxisCount&&(d+=e.mainAxisSpacing))}else d=e.isHorizontalScroll?e.padding.left:e.padding.top;if(e.isHorizontalScroll){var v={x:d,y:e.padding.top+u*t+t*e.crossAxisSpacing,width:c,height:u};n[t]=v,t=(t+1)%e.crossAxisCount,r=Math.max(d+c,r),o.push(v)}else{v={x:e.padding.left+c*t+t*e.crossAxisSpacing,y:d,width:c,height:u};n[t]=v,t=(t+1)%e.crossAxisCount,r=Math.max(d+u,r),o.push(v)}})),this.isHorizontalScroll?r+=this.padding.right:r+=this.padding.bottom,this.itemLayouts=o,this.maxVLength=r}},t.prototype.collectionViewContentSize=function(){return this.isHorizontalScroll?{width:this.maxVLength,height:this.collectionView.viewHeight-this.padding.top-this.padding.bottom}:{width:this.collectionView.viewWidth-this.padding.left-this.padding.right,height:this.maxVLength}},t.prototype.layoutAttributesForItemAtIndex=function(e){return this.itemLayouts[e]},t}(e("./collection_view").CollectionViewLayout);n.GridListLayout=o},{"../utils":43,"./collection_view":5}],14:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.GridView=void 0;var i=e("../utils"),o=e("./collection_view"),r=e("./grid_list_layout"),s=function(e){function t(t,n){var i=e.call(this,t,n)||this;return i.initialAttributes=n,i.listChildren=[],i.layout=new r.GridListLayout(i),i}return __extends(t,e),t.prototype.setChildren=function(t){var n=this;if(e.prototype.setChildren.call(this,t),t){var i=[];this.factory.fetchCachedChildren(t).forEach((function(e){i.push(e),n.factory.create(e,n.document)})),this.layout.items=i,this.listChildren=i,this.reloadLayouts()}},t.prototype.setAttributes=function(t){var n,o,r,s;e.prototype.setAttributes.call(this,t),this.layout.isHorizontalScroll="Axis.horizontal"===t.scrollDirection;var a=t.gridDelegate;if(a&&(this.layout.isPlain="SliverWaterfallDelegate"!==a.classname,this.layout.crossAxisCount=a.crossAxisCount,this.layout.mainAxisSpacing=a.mainAxisSpacing,this.layout.crossAxisSpacing=a.crossAxisSpacing),t.padding){var l=(0,i.cssPadding)(this.attributes.padding);this.layout.padding.top=parseFloat(null!==(n=l.paddingTop)&&void 0!==n?n:"0.0"),this.layout.padding.left=parseFloat(null!==(o=l.paddingLeft)&&void 0!==o?o:"0.0"),this.layout.padding.bottom=parseFloat(null!==(r=l.paddingBottom)&&void 0!==r?r:"0.0"),this.layout.padding.right=parseFloat(null!==(s=l.paddingRight)&&void 0!==s?s:"0.0")}t.appBarPinned?this.setPinnedAppBar(t):this.appBarPinnedViews.length&&(this.appBarPinnedViews.forEach((function(e){return e.removeFromSuperview()})),this.appBarPinnedViews=[],this.appBarPersistentHeight=0),this.reloadLayouts()},t}(o.CollectionView);n.GridView=s},{"../utils":43,"./collection_view":5,"./grid_list_layout":13}],15:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.IgnorePointer=void 0;var i=e("../component_view"),o=e("../dom_utils"),r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.setAttributes=function(t){e.prototype.setAttributes.call(this,t),(0,o.setDOMStyle)(this.htmlElement,{pointerEvents:"none"})},t}(i.ComponentView);n.IgnorePointer=r},{"../component_view":28,"../dom_utils":30}],16:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Image=void 0;var i=e("../component_view"),o=e("../dom_utils"),r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.elementType=function(){return"img"},t.prototype.updateLayout=function(){var t,n,i,r,s,a;(null===(t=this.attributes)||void 0===t?void 0:t.width)&&(null===(n=this.attributes)||void 0===n?void 0:n.height)||(null===(i=this.constraints)||void 0===i?void 0:i.w)&&(null===(r=this.constraints)||void 0===r?void 0:r.h)?e.prototype.updateLayout.call(this):(0,o.setDOMStyle)(this.htmlElement,{position:null!==(a=null===(s=this.additionalConstraints)||void 0===s?void 0:s.position)&&void 0!==a?a:"absolute",left:"0px",top:"0px",width:"100%",height:"100%"})},t.prototype.setAttributes=function(t){var n,i=this;if(e.prototype.setAttributes.call(this,t),(0,o.setDOMStyle)(this.htmlElement,{objectFit:function(){if(!t.fit)return"cover";switch(t.fit){case"BoxFit.fill":return"fill";case"BoxFit.contain":default:return"contain";case"BoxFit.cover":return"cover";case"BoxFit.fitWidth":case"BoxFit.fitHeight":return"scale-down";case"BoxFit.none":return"none"}}()}),t.fit&&(0,o.setDOMAttribute)(this.htmlElement,"mode",function(){if(!t.fit)return"cover";switch(t.fit){case"BoxFit.fill":return"scaleToFill";case"BoxFit.contain":default:return"aspectFit";case"BoxFit.cover":return"aspectFill";case"BoxFit.fitWidth":return"widthFix";case"BoxFit.fitHeight":return"heightFix"}}()),t.src)t.lazyLoad?((0,o.setDOMAttribute)(this.htmlElement,"lazyLoad","true"),(0,o.setDOMAttribute)(this.htmlElement,"src",t.src)):(0,o.setDOMAttribute)(this.htmlElement,"src",t.src);else if(t.base64)(0,o.setDOMAttribute)(this.htmlElement,"src","data:image/".concat(null!==(n=t.imageType)&&void 0!==n?n:"png",";base64,").concat(t.base64));else if(t.assetName)if(this.engine.debugger){var r=t.assetPkg?"http://".concat(i.engine.debugger.serverAddr,"/assets/packages/").concat(t.assetPkg,"/").concat(t.assetName):"http://".concat(i.engine.debugger.serverAddr,"/assets/").concat(t.assetName);(0,o.setDOMAttribute)(this.htmlElement,"src",r)}else{r="/"+(r=t.assetPkg?"assets/packages/".concat(t.assetPkg,"/").concat(t.assetName):"assets/".concat(t.assetName)),(0,o.setDOMAttribute)(this.htmlElement,"src",r)}this.updateLayout()},t}(i.ComponentView);n.Image=r},{"../component_view":28,"../dom_utils":30}],17:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.ListView=void 0;var i=e("../utils"),o=e("./collection_view"),r=e("./grid_list_layout"),s=function(e){function t(t,n){var i=e.call(this,t,n)||this;return i.initialAttributes=n,i.listChildren=[],i.layout=new r.GridListLayout(i),i}return __extends(t,e),t.prototype.setChildren=function(t){var n=this;if(e.prototype.setChildren.call(this,t),t){var i=[];this.factory.fetchCachedChildren(t).forEach((function(e){i.push(e),n.factory.create(e,n.document)})),this.layout.items=i,this.listChildren=i,this.reloadLayouts()}},t.prototype.setAttributes=function(t){var n,o,r,s;if(e.prototype.setAttributes.call(this,t),this.layout.isHorizontalScroll="Axis.horizontal"===t.scrollDirection,t.padding){var a=(0,i.cssPadding)(this.attributes.padding);this.layout.padding.top=parseFloat(null!==(n=a.paddingTop)&&void 0!==n?n:"0.0"),this.layout.padding.left=parseFloat(null!==(o=a.paddingLeft)&&void 0!==o?o:"0.0"),this.layout.padding.bottom=parseFloat(null!==(r=a.paddingBottom)&&void 0!==r?r:"0.0"),this.layout.padding.right=parseFloat(null!==(s=a.paddingRight)&&void 0!==s?s:"0.0")}t.appBarPinned?this.setPinnedAppBar(t):this.appBarPinnedViews.length&&(this.appBarPinnedViews.forEach((function(e){return e.removeFromSuperview()})),this.appBarPinnedViews=[],this.appBarPersistentHeight=0),this.reloadLayouts()},t}(o.CollectionView);n.ListView=s},{"../utils":43,"./collection_view":5,"./grid_list_layout":13}],18:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.MouseRegion=void 0;var i=e("../component_view"),o=e("../dom_utils"),r=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.eventListened=!1,t}return __extends(t,e),t.prototype.setAttributes=function(t){var n=this;e.prototype.setAttributes.call(this,t),this.eventListened||(this.eventListened=!0,this.htmlElement.addEventListener("mouseenter",(function(){n.engine.sendMessage(JSON.stringify({type:"mouse_region",message:{event:"onEnter",target:n.hashCode}}))})),this.htmlElement.addEventListener("mouseleave",(function(){n.engine.sendMessage(JSON.stringify({type:"mouse_region",message:{event:"onExit",target:n.hashCode}}))}))),(0,o.setDOMStyle)(this.htmlElement,{cursor:this.cursor(t.cursor)})},t.prototype.cursor=function(e){switch(e.replace("SystemMouseCursor","")){case"(click)":return"pointer";case"(none)":return"none";case"(basic)":return"default";case"(wait)":return"wait";case"(progress)":return"progress";case"(contextMenu)":return"context-menu";case"(help)":return"help";case"(text)":return"text";case"(verticalText)":return"vertical-text";case"(cell)":return"cell";case"(precise)":return"crosshair";case"(move)":return"move";case"(grab)":return"grab";case"(grabbing)":return"grabbing";case"(noDrop)":return"no-drop";case"(alias)":return"alias";case"(copy)":return"copy";case"(allScroll)":return"all-scroll";case"(resizeLeftRight)":return"ew-resize";case"(resizeUpDown)":return"ns-resize";case"(resizeUpLeftDownRight)":return"nwse-resize";case"(resizeUpRightDownLeft)":return"nesw-resize";case"(resizeUp)":return"n-resize";case"(resizeDown)":return"s-resize";case"(resizeLeft)":return"w-resize";case"(resizeRight)":return"e-resize";case"(resizeUpLeft)":return"nw-resize";case"(resizeUpRight)":return"ne-resize";case"(resizeDownLeft)":return"sw-resize";case"(resizeDownRight)":return"se-resize";case"(resizeColumn)":return"col-resize";case"(resizeRow)":return"row-resize";case"(zoomIn)":return"zoom-in";case"(zoomOut)":return"zoom-out";default:return"auto"}},t}(i.ComponentView);n.MouseRegion=r},{"../component_view":28,"../dom_utils":30}],19:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Offstage=void 0;var i=e("../component_view"),o=e("../dom_utils"),r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.setAttributes=function(t){e.prototype.setAttributes.call(this,t),(0,o.setDOMStyle)(this.htmlElement,{display:t.offstage?"none":"unset"})},t}(i.ComponentView);n.Offstage=r},{"../component_view":28,"../dom_utils":30}],20:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.OpacityAncestor=n.Opacity=void 0;var i=e("../component_view"),o=e("../dom_utils"),r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.setAttributes=function(t){e.prototype.setAttributes.call(this,t),(0,o.setDOMStyle)(this.htmlElement,{opacity:t.opacity.toString()})},t}(i.ComponentView);n.Opacity=r;var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.setAttributes=function(t){e.prototype.setAttributes.call(this,t),this.target.ancestorStyle.opacity||(this.target.ancestorStyle.opacity=1),this.target.ancestorStyle.opacity*=t.opacity},t}(i.AncestorView);n.OpacityAncestor=s},{"../component_view":28,"../dom_utils":30}],21:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Overlay=void 0;e("../../env");var i=e("../component_view"),o=e("../dom_utils"),r=function(e){function t(t,n){var i=e.call(this,t,n)||this;return i.initialAttributes=n,i.didSetListener=!1,i.additionalConstraints={position:"fixed"},(0,o.setDOMStyle)(i.htmlElement,{position:"fixed",zIndex:"10000",left:"0px",top:"0px",right:"0px",bottom:"0px",touchAction:"none"}),i}return __extends(t,e),t.prototype.supportPageContainer=function(){return!1},t.prototype.elementType=function(){return this.supportPageContainer()?"wx-page-container":"div"},t.prototype.removeFromSuperview=function(){var t,n=this;if(this.supportPageContainer()){if((0,o.setDOMAttribute)(this.htmlElement,"show",!1),!this.superview)return;var i=this.superview.subviews.indexOf(this);return i>=0&&(this.superview.subviews[i].htmlElement.remove(),null===(t=this.superview)||void 0===t||t.subviews.splice(i,1)),void setTimeout((function(){n.htmlElement.remove()}),300)}e.prototype.removeFromSuperview.call(this),this.htmlElement.remove()},t.prototype.setAttributes=function(t){var n=this;e.prototype.setAttributes.call(this,t),this.supportPageContainer()&&((0,o.setDOMAttribute)(this.htmlElement,"show",!0),(0,o.setDOMAttribute)(this.htmlElement,"position","center"),(0,o.setDOMAttribute)(this.htmlElement,"duration","0"),(0,o.setDOMAttribute)(this.htmlElement,"custom-style","position:fixed;z-index:10000;left:0px;top:0px;right:0px;bottom:0px;background-color:transparent;"),(0,o.setDOMAttribute)(this.htmlElement,"overlay-style","background-color:transparent;")),t.onBackgroundTap&&!this.didSetListener&&(this.didSetListener=!0,this.htmlElement.addEventListener("click",(function(e){t.onBackgroundTap&&(!0===t.barrierDismissible&&((0,o.setDOMAttribute)(n.htmlElement,"show",!1),n.htmlElement.remove()),n.engine.sendMessage(JSON.stringify({type:"overlay",message:{event:"onBackgroundTap",target:t.onBackgroundTap}})),e.stopPropagation())})),this.supportPageContainer()&&this.htmlElement.addEventListener("afterleave",(function(){n.engine.sendMessage(JSON.stringify({type:"overlay",message:{event:"forceClose",target:n.hashCode}}))})))},t}(i.ComponentView);n.Overlay=r},{"../../env":46,"../component_view":28,"../dom_utils":30}],22:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.WidgetSpan=n.TextSpan=n.RichText=void 0;var i=e("../component_view"),o=e("../dom_utils"),r=e("../utils"),s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.measuring=!1,t.didSetOnClicked=!1,t.canMeasureResultCache=!1,t.textCache="",t.textCacheSize=0,t}return __extends(t,e),t.prototype.elementType=function(){return"div"},t.prototype.setConstraints=function(e){this.measuring||e&&(this.constraints=e,this.updateLayout(),(0,o.setDOMStyle)(this.htmlElement,{position:"absolute",opacity:"1"}))},t.prototype.setAttributes=function(t){var n;e.prototype.setAttributes.call(this,t),this.htmlElement.classList.add("mp_text");var i=t.maxWidth;this.maxWidth="string"==typeof i?parseFloat(i):void 0;var s=t.maxHeight;this.maxHeight="string"==typeof s?parseFloat(s):void 0,(0,o.setDOMStyle)(this.htmlElement,{overflow:"hidden",textOverflow:"ellipsis",textAlign:(0,r.cssTextAlign)(t.textAlign),display:"-webkit-box",fontSize:"11px",fontFamily:"sans-serif",lineHeight:null===(n=t.height)||void 0===n?void 0:n.toString(),overflowWrap:"anywhere",wordBreak:"break-all",wordWrap:"break-word",whiteSpace:"pre-line",webkitBoxOrient:"vertical",webkitLineClamp:t.maxLines?t.maxLines.toString():"99999"}),this.measureId=t.measureId},t.prototype.setSingleTextSpan=function(e){return __awaiter(this,void 0,void 0,(function(){var t,n,i,s,a=this;return __generator(this,(function(l){if(t={},e[0].attributes.style)for(i in n=(0,r.cssTextStyle)(e[0].attributes.style),this.attributes.selectable&&(delete n.userSelect,delete n.WebkitUserSelect),n)t[i]=n[i];return e[0].attributes.text&&(s=e[0].attributes.text,this.htmlElement.innerText=s,t.letterSpacing||t.wordSpacing||t.height||!1!==/[^㐀-𫠚]/g.test(s)||(this.canMeasureResultCache=!0,this.textCache=s,this.textCacheSize=parseInt(t.fontSize))),e[0].attributes.onTap_el&&e[0].attributes.onTap_span&&!this.didSetOnClicked&&(this.didSetOnClicked=!0,this.htmlElement.addEventListener("click",(function(t){a.onClick(e[0].attributes.onTap_el,e[0].attributes.onTap_span),t&&t.stopPropagation()}))),(0,o.setDOMStyle)(this.htmlElement,t),[2]}))}))},t.prototype.setChildren=function(t){var n;return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(i){return t&&1===t.length&&"text_span"===t[0].name&&(null===(n=t[0].attributes)||void 0===n?void 0:n.text)?this.setSingleTextSpan(t):e.prototype.setChildren.call(this,t),[2]}))}))},t.prototype.onClick=function(e,t){this.engine.sendMessage(JSON.stringify({type:"rich_text",message:{event:"onTap",target:e,subTarget:t}}))},t}(i.ComponentView);n.RichText=s;var a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.didSetOnClicked=!1,t}return __extends(t,e),t.prototype.elementType=function(){return"div"},t.prototype.setChildren=function(t){t instanceof Array&&t.length>0&&e.prototype.setChildren.call(this,t)},t.prototype.setAttributes=function(t){var n=this;e.prototype.setAttributes.call(this,t);var i={position:"unset",display:"inline"};if(t.style){var s=(0,r.cssTextStyle)(t.style);for(var a in t.selectable&&(delete s.userSelect,delete s.WebkitUserSelect),s)i[a]=s[a]}t.text&&(this.htmlElement.innerText=t.text,(0,o.setDOMAttribute)(this.htmlElement,"innerText",t.text)),t.onTap_el&&t.onTap_span&&!this.didSetOnClicked&&(this.didSetOnClicked=!0,this.htmlElement.addEventListener("click",(function(e){n.onClick(),e&&e.stopPropagation()}))),(0,o.setDOMStyle)(this.htmlElement,i)},t.prototype.onClick=function(){this.attributes.onTap_el&&this.attributes.onTap_span&&this.engine.sendMessage(JSON.stringify({type:"rich_text",message:{event:"onTap",target:this.attributes.onTap_el,subTarget:this.attributes.onTap_span}}))},t}(i.ComponentView);n.TextSpan=a;var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.elementType=function(){return"div"},t.prototype.setChildren=function(t){e.prototype.setChildren.call(this,t),this.subviews[0]&&(this.subviews[0].additionalConstraints={position:"relative"},(0,o.setDOMStyle)(this.subviews[0].htmlElement,{position:"relative",display:"inline-flex"}))},t.prototype.setAttributes=function(t){e.prototype.setAttributes.call(this,t),(0,o.setDOMStyle)(this.htmlElement,{display:"contents"})},t}(i.ComponentView);n.WidgetSpan=l},{"../component_view":28,"../dom_utils":30,"../utils":43}],23:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.SliverPersistentHeader=void 0;var i=e("../component_view"),o=e("../dom_utils"),r=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.pinned=!0,t.lazying=!1,t.observingScroller=!1,t.lazyOffset=0,t.y=0,t.h=0,t}return __extends(t,e),t.prototype.setAttributes=function(e){this.attributes=e,this.pinned=e.pinned,this.lazying=e.lazying,this.lazyOffset=e.lazyOffset,this.updateLayout(),this.lazying&&!this.observingScroller&&(this.observeScroller(),this.updateLazyState(0))},t.prototype.observeScroller=function(){var e,t=this;this.lazying&&!this.observingScroller&&(this.observingScroller=!0,e=function(e){t.updateLazyState(t.document.window.scrollY)},this.document.window.addEventListener("scroll",e))},t.prototype.updateLazyState=function(e){this.lazying&&(0,o.setDOMStyle)(this.htmlElement,{opacity:e>this.lazyOffset?"1.0":"0.0"})},t.prototype.updateLayout=function(){var e,t,n,i,r,s;if(this.constraints){var a=this.constraints.x,l=this.y,c=this.constraints.w,u=this.constraints.h;this.ancestors.forEach((function(e){e.constraints&&(a+=e.constraints.x,l+=e.constraints.y)})),(0,o.setDOMStyle)(this.htmlElement,{position:"sticky",left:null!==(t=null===(e=this.additionalConstraints)||void 0===e?void 0:e.left)&&void 0!==t?t:a+"px",top:this.pinned?this.h+"px":"unset",marginTop:this.pinned?l+"px":"unset",width:null!==(i=null===(n=this.additionalConstraints)||void 0===n?void 0:n.width)&&void 0!==i?i:c+"px",height:null!==(s=null===(r=this.additionalConstraints)||void 0===r?void 0:r.height)&&void 0!==s?s:u+"px",zIndex:"99"})}},t}(i.ComponentView);n.SliverPersistentHeader=r},{"../component_view":28,"../dom_utils":30}],24:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Transform=void 0;var i=e("../component_view"),o=e("../dom_utils"),r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.setAttributes=function(t){e.prototype.setAttributes.call(this,t),(0,o.setDOMStyle)(this.htmlElement,{transform:t.transform})},t}(i.ComponentView);n.Transform=r},{"../component_view":28,"../dom_utils":30}],25:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Visibility=void 0;var i=e("../component_view"),o=e("../dom_utils"),r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.setAttributes=function(t){e.prototype.setAttributes.call(this,t),(0,o.setDOMStyle)(this.htmlElement,{display:t.visible?"contents":"none"})},t}(i.ComponentView);n.Visibility=r},{"../component_view":28,"../dom_utils":30}],26:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.WebDialogs=void 0;var i=e("../../env"),o=function(){function e(){}return e.receivedWebDialogsMessage=function(e,t){this.wxMiniProgramReceivedWebDialogsMessage(e,t)},e.wxMiniProgramReceivedWebDialogsMessage=function(e,t){var n,o;if("alert"===t.params.dialogType)i.MPEnv.platformScope.showModal({content:t.params.message,showCancel:!1,confirmText:"确定",success:function(){e.sendMessage(JSON.stringify({type:"action",message:{event:"callback",id:t.id}}))}});else if("confirm"===t.params.dialogType)i.MPEnv.platformScope.showModal({content:t.params.message,cancelText:"取消",confirmText:"确认",success:function(n){e.sendMessage(JSON.stringify({type:"action",message:{event:"callback",id:t.id,data:1==n.confirm}}))}});else if("prompt"===t.params.dialogType)i.MPEnv.platformScope.showModal({title:t.params.message,content:null!==(n=t.params.defaultValue)&&void 0!==n?n:"",editable:!0,cancelText:"取消",confirmText:"确认",success:function(n){e.sendMessage(JSON.stringify({type:"action",message:{event:"callback",id:t.id,data:n.content}}))},fail:function(){e.sendMessage(JSON.stringify({type:"action",message:{event:"callback",id:t.id,data:null}}))}});else if("actionSheet"===t.params.dialogType)i.MPEnv.platformScope.showActionSheet({itemList:t.params.items,success:function(n){e.sendMessage(JSON.stringify({type:"action",message:{event:"callback",id:t.id,data:n.tapIndex}}))},fail:function(){e.sendMessage(JSON.stringify({type:"action",message:{event:"callback",id:t.id,data:null}}))}});else if("showToast"===t.params.dialogType){var r={};t.params.title&&(r.title=t.params.title),t.params.icon&&(r.icon=null===(o=t.params.icon)||void 0===o?void 0:o.replace("ToastIcon.","")),t.params.duration&&(r.duration=t.params.duration),t.params.mask&&(r.mask=t.params.mask),i.MPEnv.platformScope.showToast(r)}else"hideToast"===t.params.dialogType&&i.MPEnv.platformScope.hideToast()},e.browserMiniProgramReceivedWebDialogsMessage=function(e,t){},e}();n.WebDialogs=o},{"../../env":46}],27:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.ComponentFactory=void 0;var i=e("./basic/absorb_pointer"),o=e("./basic/clip_oval"),r=e("./basic/clip_r_rect"),s=e("./basic/colored_box"),a=e("./basic/decorated_box"),l=e("./basic/gesture_detector"),c=e("./basic/ignore_pointer"),u=e("./basic/offstage"),d=e("./basic/opacity"),h=e("./basic/transform"),p=e("./basic/image"),m=e("./component_view"),f=e("./mpkit/scaffold"),v=e("./basic/rich_text"),g=e("./basic/list_view"),y=e("./basic/grid_view"),b=e("./basic/custom_scroll_view"),w=e("./basic/custom_paint"),_=e("./mpkit/icon"),P=e("./mpkit/video_view"),S=e("./mpkit/web_view"),M=e("./mpkit/page_view"),x=e("./mpkit/miniprogram_view"),E=e("./basic/overlay"),C=e("./basic/visibility"),R=e("./basic/sliver_persistent_header"),O=e("./basic/editable_text"),A=e("./mpkit/platform_view"),k=e("./basic/foreground_decorated_box"),T=e("../env"),D=e("./mpkit/switch"),I=e("./mpkit/slider"),L=e("./mpkit/picker"),V=e("./mpkit/date_picker"),B=e("./mpkit/circular_progress_indicator"),F=e("./basic/mouse_region"),j=function(){function e(e){this.engine=e,this.cachedView={},this.cachedAncestor={},this.cachedElement={},this.textMeasureResults=[],this.markedNeedsFlushTextMeasureResult=!1}return e.prototype.create=function(t,n){var i;if(t){var o=t["^"],r=t.name,s=t.hashCode;if(1==o&&"number"==typeof s)return this.cachedView[s];if(r&&s){o||(this.cachedElement[s]=t);var a=!e.disableCache&&this.cachedView[s];if(a)return n=a.document,t.ancestors&&a.setAncestors(t.ancestors),t.constraints&&a.setConstraints(t.constraints),t.attributes&&a.setAttributes(t.attributes),t.children&&a.setChildren(this.fetchCachedChildren(t.children)),a;if(n){var l=e.components[r];l||(l=m.ComponentView);var c=new l(n,t.attributes);return(null===(i=T.MPEnv.platformGlobal())||void 0===i?void 0:i.mpDEBUG)&&c.htmlElement.setAttribute("mp-component",r),c.factory=this,c.engine=this.engine,c.hashCode=s,t.ancestors&&c.setAncestors(t.ancestors),t.constraints&&c.setConstraints(t.constraints),t.attributes&&c.setAttributes(t.attributes),t.children&&(e.disableCache?c.setChildren(t.children):c.setChildren(this.fetchCachedChildren(t.children))),e.disableCache||(this.cachedView[s]=c),c}}}},e.prototype.createAncestors=function(t,n){var i=t["^"],o=t.name,r=t.hashCode;if(1==i&&"number"==typeof r)return this.cachedAncestor[r];if(o&&r){i||(this.cachedElement[r]=t);var s=this.cachedAncestor[r];if(s){if(s.target&&s.target!==n){var a=s.target.ancestors.indexOf(s);a>=0&&s.target.ancestors.splice(a,1)}return s.target=n,t.attributes&&s.setAttributes(t.attributes),t.constraints&&s.setConstraints(t.constraints),s}if(n){var l=e.ancestors[o];if(l){var c=new l(n);return t.attributes&&c.setAttributes(t.attributes),t.constraints&&c.setConstraints(t.constraints),this.cachedAncestor[r]=c,c}}}},e.prototype.fetchCachedChildren=function(e){var t=this;return e.map((function(e){var n=e["^"],i=e.hashCode;return n&&t.cachedElement[i]?t.cachedElement[i]:e}))},e.prototype.callbackTextMeasureResult=function(e,t){var n=this;this.textMeasureResults.push({measureId:e,size:t}),this.markedNeedsFlushTextMeasureResult||(this.markedNeedsFlushTextMeasureResult=!0,setTimeout((function(){n.flushTextMeasureResult(),n.markedNeedsFlushTextMeasureResult=!1}),50))},e.prototype.callbackTextPainterMeasureResult=function(e,t){this.engine.sendMessage(JSON.stringify({type:"rich_text",message:{event:"onTextPainterMeasured",data:{seqId:e,size:t}}}))},e.prototype.flushTextMeasureResult=function(){this.textMeasureResults.length>0&&(this.engine.sendMessage(JSON.stringify({type:"rich_text",message:{event:"onMeasured",data:this.textMeasureResults}})),this.textMeasureResults=[])},e.components={absorb_pointer:i.AbsorbPointer,clip_oval:o.ClipOval,clip_r_rect:r.ClipRRect,colored_box:s.ColoredBox,custom_paint:w.CustomPaint,custom_scroll_view:b.CustomScrollView,decorated_box:a.DecoratedBox,foreground_decorated_box:k.ForegroundDecoratedBox,editable_text:O.EditableText,gesture_detector:l.GestureDetector,grid_view:y.GridView,ignore_pointer:c.IgnorePointer,image:p.Image,list_view:g.ListView,mouse_region:F.MouseRegion,offstage:u.Offstage,opacity:d.Opacity,overlay:E.Overlay,rich_text:v.RichText,text_span:v.TextSpan,widget_span:v.WidgetSpan,sliver_persistent_header:R.SliverPersistentHeader,transform:h.Transform,visibility:C.Visibility,mp_icon:_.MPIcon,mp_scaffold:f.MPScaffold,mp_video_view:P.MPVideoView,mp_web_view:S.MPWebView,mp_page_view:M.MPPageView,mp_platform_view:A.MPPlatformView,mp_switch:D.MPSwitch,mp_slider:I.MPSlider,mp_picker:L.MPPicker,mp_date_picker:V.MPDatePicker,mp_mini_program_view:x.MPMiniProgramView,mp_circular_progress_indicator:B.MPCircularProgressIndicator},e.ancestors={opacity:d.OpacityAncestor,clip_r_rect:r.ClipRRectAncestor},e.disableCache=!1,e}();n.ComponentFactory=j},{"../env":46,"./basic/absorb_pointer":2,"./basic/clip_oval":3,"./basic/clip_r_rect":4,"./basic/colored_box":6,"./basic/custom_paint":7,"./basic/custom_scroll_view":8,"./basic/decorated_box":9,"./basic/editable_text":10,"./basic/foreground_decorated_box":11,"./basic/gesture_detector":12,"./basic/grid_view":14,"./basic/ignore_pointer":15,"./basic/image":16,"./basic/list_view":17,"./basic/mouse_region":18,"./basic/offstage":19,"./basic/opacity":20,"./basic/overlay":21,"./basic/rich_text":22,"./basic/sliver_persistent_header":23,"./basic/transform":24,"./basic/visibility":25,"./component_view":28,"./mpkit/circular_progress_indicator":31,"./mpkit/date_picker":32,"./mpkit/icon":33,"./mpkit/miniprogram_view":34,"./mpkit/page_view":35,"./mpkit/picker":36,"./mpkit/platform_view":37,"./mpkit/scaffold":38,"./mpkit/slider":39,"./mpkit/switch":40,"./mpkit/video_view":41,"./mpkit/web_view":42}],28:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.AncestorView=n.ComponentView=void 0;var i=e("./dom_utils"),o=function(){function e(e,t){this.document=e,this.initialAttributes=t,this.classname="",this.subviews=[],this.disposed=!1,this.ancestors=[],this.ancestorStyle={},this.htmlElement=e.createElement(this.elementType())}return e.prototype.dispose=function(){this.disposed=!0},e.prototype.elementType=function(){return"div"},e.prototype.setConstraints=function(e){e&&(this.constraints=e,this.updateLayout())},e.prototype.updateLayout=function(){var e,t,n,o,r;if(this.constraints){var s=this.constraints.x,a=this.constraints.y,l=this.constraints.w,c=this.constraints.h;this.ancestors.forEach((function(e){e.constraints&&(s+=e.constraints.x,a+=e.constraints.y)}));var u=this.additionalConstraints;this.collectionViewConstraints&&this.superview&&"CollectionView"===this.superview.classname&&(u=this.collectionViewConstraints),(0,i.setDOMStyle)(this.htmlElement,{position:null!==(e=null==u?void 0:u.position)&&void 0!==e?e:"absolute",left:null!==(t=null==u?void 0:u.left)&&void 0!==t?t:s+"px",top:null!==(n=null==u?void 0:u.top)&&void 0!==n?n:a+"px",width:null!==(o=null==u?void 0:u.width)&&void 0!==o?o:l+"px",height:null!==(r=null==u?void 0:u.height)&&void 0!==r?r:c+"px"})}},e.prototype.setAttributes=function(e){this.attributes=e},e.prototype.setChildren=function(e){var t=this;if(e instanceof Array){var n=e.map((function(e){return t.factory.create(e,t.document)})).filter((function(e){return e})),i=!1,o=-1;if(n.length!==this.subviews.length){i=!0;for(var r=0;r<n.length;r++)if(n[r]!==this.subviews[r]){o=r;break}}else{n.every((function(e,n){return e===t.subviews[n]&&e.superview===t}))||(i=!0)}if(i)if(o>0){var s=[];for(r=o;r<this.subviews.length;r++)s.push(this.subviews[r]);s.forEach((function(e){return e.removeFromSuperview()}));for(r=o;r<n.length;r++)this.addSubview(n[r])}else this.removeAllSubviews(),n.forEach((function(e){return t.addSubview(e)}))}},e.prototype.resetAncestorStyle=function(){this.ancestorStyle.opacity&&(this.ancestorStyle.opacity=1),this.ancestorStyle.borderRadius&&(this.ancestorStyle.borderRadius="unset"),this.ancestorStyle.overflow&&(this.ancestorStyle.overflow="unset"),this.ancestorStyle.borderTopLeftRadius&&(this.ancestorStyle.borderTopLeftRadius="unset"),this.ancestorStyle.borderTopRightRadius&&(this.ancestorStyle.borderTopRightRadius="unset"),this.ancestorStyle.borderBottomLeftRadius&&(this.ancestorStyle.borderBottomLeftRadius="unset"),this.ancestorStyle.borderBottomRightRadius&&(this.ancestorStyle.borderBottomRightRadius="unset")},e.prototype.setAncestors=function(e){var t=this;!(e instanceof Array)&&this.ancestors.length>0?(this.resetAncestorStyle(),this.ancestors=[],(0,i.setDOMStyle)(this.htmlElement,this.ancestorStyle)):(this.resetAncestorStyle(),this.ancestors=e.map((function(e){return t.factory.createAncestors(e,t)})).filter((function(e){return e})),(0,i.setDOMStyle)(this.htmlElement,this.ancestorStyle))},e.prototype.removeAllSubviews=function(){this.subviews.forEach((function(e){e.superview=void 0,e.htmlElement.remove()})),this.subviews=[]},e.prototype.removeFromSuperview=function(){var e;if(this.superview){var t=this.superview.subviews.indexOf(this);t>=0&&(this.superview.subviews[t].htmlElement.remove(),null===(e=this.superview)||void 0===e||e.subviews.splice(t,1)),this.htmlElement.remove()}},e.prototype.addSubview=function(e){e.superview&&e.removeFromSuperview(),this.subviews.push(e),e.superview=this,this.htmlElement.appendChild(e.htmlElement),e.didMoveToWindow()},e.prototype.didMoveToWindow=function(){this.subviews.forEach((function(e){return e.didMoveToWindow()}))},e}();n.ComponentView=o;var r=function(){function e(e){this.target=e}return e.prototype.setConstraints=function(e){e&&(this.constraints=e,this.target.updateLayout())},e.prototype.setAttributes=function(e){},e}();n.AncestorView=r},{"./dom_utils":30}],29:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.wrapDartObject=void 0;n.wrapDartObject=function(e){return null==e||"string"==typeof e||"number"==typeof e||"boolean"==typeof e?e:e instanceof Array?e.map((function(e){return(0,n.wrapDartObject)(e)})):(e.o&&(e=e.o),new Proxy(e,{get:function(e,t){var i,o,r,s,a,l,c,u,d,h,p,m;if("__keys__"===t){var f=[];return(null==e?void 0:e.b)&&f.push.apply(f,Object.keys(e.b)),(null==e?void 0:e.c)&&f.push.apply(f,Object.keys(e.c)),(null==e?void 0:e._nums)&&f.push.apply(f,Object.keys(e._nums)),(null==e?void 0:e._strings)&&f.push.apply(f,Object.keys(e._strings)),f}var v=null!==(m=null!==(d=null!==(l=null!==(r=null===(o=null===(i=null==e?void 0:e.b)||void 0===i?void 0:i[t])||void 0===o?void 0:o.b)&&void 0!==r?r:null===(a=null===(s=null==e?void 0:e.c)||void 0===s?void 0:s[t])||void 0===a?void 0:a.b)&&void 0!==l?l:null===(u=null===(c=null==e?void 0:e._nums)||void 0===c?void 0:c[t])||void 0===u?void 0:u.hashMapCellValue)&&void 0!==d?d:null===(p=null===(h=null==e?void 0:e._strings)||void 0===h?void 0:h[t])||void 0===p?void 0:p.hashMapCellValue)&&void 0!==m?m:e[t];return(0,n.wrapDartObject)(v)}}))}},{}],30:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.setDOMAttribute=n.setDOMStyle=void 0;n.setDOMStyle=function(e,t){if(0!==Object.keys(t).length){for(var n in t){var i=t[n];"string"==typeof i&&i.indexOf(".0px")>0&&(t[n]=i.replace(".0px","px"))}for(var n in t)e.style[n]=t[n]}};n.setDOMAttribute=function(e,t,n){void 0===n?e.removeAttribute(t):e.setAttribute(t,n)}},{}],31:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.MPCircularProgressIndicator=void 0;var i=e("../component_view"),o=e("../dom_utils"),r=e("../utils"),s="https://dist.mpflutter.com/res/spinner.svg",a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.setChildren=function(){},t.prototype.setAttributes=function(t){var n;e.prototype.setAttributes.call(this,t);var i=null!==(n=t.size)&&void 0!==n?n:36;(0,o.setDOMStyle)(this.htmlElement,{backgroundColor:(0,r.cssColor)(t.color),mask:"url(".concat(s,") no-repeat center"),webkitMask:"url(".concat(s,") no-repeat center"),WebkitMask:"url(".concat(s,") no-repeat center"),width:"65px",height:"65px",transform:"scale(".concat(i/65,", ").concat(i/65,")"),transformOrigin:"top left"})},t}(i.ComponentView);n.MPCircularProgressIndicator=a},{"../component_view":28,"../dom_utils":30,"../utils":43}],32:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.MPDatePicker=void 0;var i=e("../dom_utils"),o=function(e){function t(t){var n=e.call(this,t)||this;return n.htmlElement.addEventListener("change",(function(e){n.invokeMethod("callbackResult",{value:e.detail.value.split("-").map((function(e){return parseInt(e)}))})})),n}return __extends(t,e),t.prototype.elementType=function(){return"wx-picker"},t.prototype.setAttributes=function(t){e.prototype.setAttributes.call(this,t),(0,i.setDOMAttribute)(this.htmlElement,"header-text",t.headerText),(0,i.setDOMAttribute)(this.htmlElement,"mode","date"),(0,i.setDOMAttribute)(this.htmlElement,"start",t.start),(0,i.setDOMAttribute)(this.htmlElement,"end",t.end),(0,i.setDOMAttribute)(this.htmlElement,"value",t.defaultValue)},t.prototype.showDatePicker=function(e){var t=this;window.weui.datePicker({start:this.attributes.start,end:this.attributes.end,defaultValue:this.attributes.defaultValue.split("-").map((function(e){return parseInt(e)})),onConfirm:function(e){t.invokeMethod("callbackResult",{value:null==e?void 0:e.map((function(e){return e.value}))})},onClose:function(){e.remove()},container:e})},t}(e("../mpkit/platform_view").MPPlatformView);n.MPDatePicker=o},{"../dom_utils":30,"../mpkit/platform_view":37}],33:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.MPIcon=void 0;var i=e("../component_view"),o=e("../dom_utils"),r=e("../utils"),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.setChildren=function(){},t.prototype.setAttributes=function(t){e.prototype.setAttributes.call(this,t),(0,o.setDOMStyle)(this.htmlElement,{backgroundColor:(0,r.cssColor)(t.color),mask:"url(".concat(t.iconUrl,") no-repeat center"),webkitMask:"url(".concat(t.iconUrl,") no-repeat center"),WebkitMask:"url(".concat(t.iconUrl,") no-repeat center"),width:"24px",height:"24px",transform:"scale(".concat(t.size/24,", ").concat(t.size/24,")"),transformOrigin:"top left"})},t}(i.ComponentView);n.MPIcon=s},{"../component_view":28,"../dom_utils":30,"../utils":43}],34:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.MPMiniProgramView=void 0;var i=e("../../components/mpkit/platform_view"),o=e("../dom_utils"),r=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.eventListened={},t}return __extends(t,e),t.prototype.elementType=function(){var e;return"wx-"+(null===(e=this.initialAttributes)||void 0===e?void 0:e.tag)},t.prototype.setAttributes=function(t){for(var n in e.prototype.setAttributes.call(this,t),t)"style"===n?(0,o.setDOMStyle)(this.htmlElement,t[n]):0===n.indexOf("on.")?this.addEventListener(n,t[n]):(0,o.setDOMAttribute)(this.htmlElement,n,t[n])},t.prototype.addEventListener=function(e,t){var n=this;this.eventListened[e]?this.eventListened[e]=t:(this.eventListened[e]=t,this.htmlElement.addEventListener(e.replace("on.",""),(function(t){var i=n.eventListened[e];if(0!==i.length){var o={};i.forEach((function(e){var n;o[e]=null===(n=t.detail)||void 0===n?void 0:n[e]})),n.invokeMethod(e,o)}else n.invokeMethod(e,t.detail)})))},t}(i.MPPlatformView);n.MPMiniProgramView=r},{"../../components/mpkit/platform_view":37,"../dom_utils":30}],35:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.MPPageView=void 0;var i=e("../mpkit/platform_view"),o=e("../dom_utils"),r=(function(e){function t(t,n){var i=e.call(this,t,n)||this;return i.initialAttributes=n,i.wrapperHtmlElement=i.document.createElement("div"),i.direction="horizontal",i.loop=!1,i.autoplay=!1,i.wrapperHtmlElement.className="swiper-wrapper",i.htmlElement.appendChild(i.wrapperHtmlElement),i}__extends(t,e),t.prototype.setChildren=function(t){e.prototype.setChildren.call(this,t),this.htmlElement.className="swiper-container",this.htmlElement.id="d_"+this.hashCode,this.subviews.forEach((function(e){e.htmlElement.className="swiper-slide",e.htmlElement.style.position="relative"})),this.setupSwiperInstance()},t.prototype.setAttributes=function(t){e.prototype.setAttributes.call(this,t),this.direction="Axis.vertical"===t.scrollDirection?"vertical":"horizontal",this.loop=t.loop,this.autoplay=t.autoplay,this.wrapperHtmlElement.style.flexDirection="Axis.vertical"===t.scrollDirection?"column":"row",this.setupSwiperInstance()},t.prototype.setupSwiperInstance=function(){var e=this;setTimeout((function(){e.swiperInstance?(e.swiperInstance.changeDirection(e.direction),e.swiperInstance.update()):(e.swiperInstance=new window.Swiper("#d_"+e.hashCode,{direction:e.direction,loop:e.loop,autoplay:e.autoplay,initialSlide:e.attributes.initialPage}),e.swiperInstance.on("activeIndexChange",(function(){e.invokeMethod("onPageChanged",{index:e.swiperInstance.realIndex})})))}),16)},t.prototype.onMethodCall=function(e,t){"animateToPage"===e?this.swiperInstance.slideToLoop(t.page,"number"==typeof t.duration?t.duration:500):"jumpToPage"===e?this.swiperInstance.slideToLoop(t.page,0):"nextPage"===e?this.swiperInstance.slideNext("number"==typeof t.duration?t.duration:500):"previousPage"===e&&this.swiperInstance.slidePrev("number"==typeof t.duration?t.duration:500)},t.prototype.addSubview=function(e){e.superview&&e.removeFromSuperview(),this.subviews.push(e),e.superview=this,this.wrapperHtmlElement.appendChild(e.htmlElement),e.didMoveToWindow()}}(i.MPPlatformView),function(e){function t(t,n){var i,o=this;return(o=e.call(this,t,n)||this).document=t,o.initialAttributes=n,o.maxPage=0,o.currentPage=0,o.currentPage=null!==(i=n.initialPage)&&void 0!==i?i:0,o.htmlElement.addEventListener("change",(function(e){o.currentPage=e.detail.current,o.invokeMethod("onPageChanged",{index:e.detail.current})})),n.initialPage&&o.htmlElement.setAttribute("current",n.initialPage),o}return __extends(t,e),t.prototype.elementType=function(){return"wx-swiper"},t.prototype.setChildren=function(t){e.prototype.setChildren.call(this,t),this.maxPage=t.length-1},t.prototype.setAttributes=function(t){e.prototype.setAttributes.call(this,t),(0,o.setDOMAttribute)(this.htmlElement,"vertical","Axis.vertical"===t.scrollDirection),(0,o.setDOMAttribute)(this.htmlElement,"circular",!!t.loop),(0,o.setDOMAttribute)(this.htmlElement,"autoplay",!!t.autoplay)},t.prototype.addSubview=function(e){e.superview&&e.removeFromSuperview(),this.subviews.push(e),e.superview=this;var t=this.document.createElement("wx-swiper-item");t.appendChild(e.htmlElement),this.htmlElement.appendChild(t),e.didMoveToWindow()},t.prototype.onMethodCall=function(e,t){var n=this,i=function(){n.htmlElement.setAttribute("duration","number"==typeof t.duration?t.duration:500),setTimeout((function(){n.htmlElement.setAttribute("current",n.currentPage),n.htmlElement.setAttribute("duration","500")}),16)};"animateToPage"===e?(this.currentPage=t.page,i()):"jumpToPage"===e?(this.currentPage=t.page,t.duration=1,i()):"nextPage"===e?(this.currentPage=this.currentPage+1>this.maxPage?0:this.currentPage+1,i()):"previousPage"===e&&(this.currentPage=this.currentPage-1<0?this.maxPage:this.currentPage-1,i())},t}(i.MPPlatformView));n.MPPageView=r},{"../dom_utils":30,"../mpkit/platform_view":37}],36:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.MPPicker=n.PickerItem=void 0;var i=e("../dom_utils"),o=e("../mpkit/platform_view"),r=function(e,t,n){this.label=e,this.disabled=t,this.subItems=n};n.PickerItem=r;var s=function(e){function t(t,n){var o,r=this;return(r=e.call(this,t,n)||this).initialAttributes=n,r.multiIndex=null!==(o=null==n?void 0:n.defaultValue)&&void 0!==o?o:[0,0,0],r.htmlElement.addEventListener("change",(function(e){r.invokeMethod("callbackResult",{value:"string"==typeof e.detail.value?[parseInt(e.detail.value)]:e.detail.value})})),r.htmlElement.addEventListener("columnchange",(function(e){r.updatePickerItem(e.detail.column,e.detail.value),(0,i.setDOMAttribute)(r.htmlElement,"range",r.getPickerItem())})),r}return __extends(t,e),t.prototype.elementType=function(){return"wx-picker"},t.prototype.setAttributes=function(t){e.prototype.setAttributes.call(this,t),(0,i.setDOMAttribute)(this.htmlElement,"header-text",t.headerText),(0,i.setDOMAttribute)(this.htmlElement,"mode",t.column>1?"multiSelector":"selector"),(0,i.setDOMAttribute)(this.htmlElement,"disabled",t.disabled),(0,i.setDOMAttribute)(this.htmlElement,"range",this.getPickerItem()),(0,i.setDOMAttribute)(this.htmlElement,"value",this.multiIndex)},t.prototype.getPickerItem=function(){var e=this.attributes.items,t=[];if(1===this.attributes.column)t=e.map((function(e){return e.label}));else{if(t.push(e.map((function(e){return e.label}))),this.attributes.column>=2)try{t.push(e[this.multiIndex[0]].subItems.map((function(e){return e.label})))}catch(e){t.push([])}if(this.attributes.column>=3)try{t.push(e[this.multiIndex[0]].subItems[this.multiIndex[1]].subItems.map((function(e){return e.label})))}catch(e){t.push([])}}return t},t.prototype.updatePickerItem=function(e,t){this.multiIndex[e]=t},t.prototype.showPicker=function(e){},t}(o.MPPlatformView);n.MPPicker=s},{"../dom_utils":30,"../mpkit/platform_view":37}],37:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.MPPlatformView=void 0;var i=function(e){function t(t,n){var i=e.call(this,t,n)||this;return i.document=t,i.initialAttributes=n,i.classname="PlatformView",i.elementType().indexOf("."),null==n||n.tag,i}return __extends(t,e),t.handleInvokeMethodCallback=function(e,t){this._invokeMethodCompleter[e]&&(this._invokeMethodCompleter[e](t),delete this._invokeMethodCompleter[e])},t.prototype.elementType=function(){return"div"},t.prototype.setSize=function(e){this._currentSize&&this._currentSize.width===e.width&&this._currentSize.height===e.height||(this._currentSize=e,this.engine.sendMessage(JSON.stringify({type:"platform_view",message:{event:"setSize",hashCode:this.hashCode,size:e}})))},t.prototype.createFromWebTemplate=function(){return null},t.prototype.setAttributes=function(t){e.prototype.setAttributes.call(this,t)},t.prototype.onMethodCall=function(e,t){},t.prototype.invokeMethod=function(e,n,i){void 0===i&&(i=!1);var o="".concat(this.hashCode,"_").concat(Math.random());if(this.engine.sendMessage(JSON.stringify({type:"platform_view",message:{event:"methodCall",hashCode:this.hashCode,method:e,params:n,seqId:o,requireResult:i}})),i)return new Promise((function(e){t._invokeMethodCompleter[o]=e}))},t._invokeMethodCompleter={},t}(e("../component_view").ComponentView);n.MPPlatformView=i},{"../component_view":28}],38:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.MPScaffold=void 0;var i=e("../component_view"),o=e("../dom_utils"),r=e("../utils"),s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.attached=!1,t}return __extends(t,e),t.prototype.setAppBar=function(e){this.appBar===e&&!0!==(null==e?void 0:e.collectionViewFixed)||(this.removeAllSubviews(),this.appBar=e,e&&(e.collectionViewFixed=!1,(0,o.setDOMStyle)(e.htmlElement,{pointerEvents:"unset",display:"unset"}),e.subviews.forEach((function(e){(0,o.setDOMStyle)(e.htmlElement,{position:"absolute",marginTop:"0px"})}))),e&&this.engine.pageMode&&(e.additionalConstraints={position:"fixed"},(0,o.setDOMStyle)(e.htmlElement,{position:"fixed",zIndex:"9999"})),this.readdSubviews())},t.prototype.setBody=function(e){this.body!==e&&(this.removeAllSubviews(),this.body=e,this.readdSubviews())},t.prototype.setBottomBar=function(e,t,n){this.bottomBar!==e&&(this.removeAllSubviews(),this.bottomBar=e,e&&this.engine.pageMode&&(e.additionalConstraints={position:"fixed",top:"unset"},(0,o.setDOMStyle)(e.htmlElement,{position:"fixed",top:"unset",bottom:"0px",zIndex:"9999",paddingBottom:!0===t?"env(safe-area-inset-bottom)":"",backgroundColor:n?(0,r.cssColor)(n):void 0})),this.readdSubviews())},t.prototype.setFloatingBody=function(e){this.floatingBody!==e&&(this.removeAllSubviews(),this.floatingBody=e,e&&this.engine.pageMode&&(e.additionalConstraints={position:"fixed",zIndex:"9999"},(0,o.setDOMStyle)(e.htmlElement,{position:"fixed",zIndex:"9999"})),this.readdSubviews())},t.prototype.readdSubviews=function(){this.body&&this.addSubview(this.body),this.appBar&&this.addSubview(this.appBar),this.bottomBar&&this.addSubview(this.bottomBar),this.floatingBody&&this.addSubview(this.floatingBody)},t.prototype.setAttributes=function(t){var n,i,s,a,l;e.prototype.setAttributes.call(this,t),this.setAppBar(t.appBar?this.factory.create(t.appBar,this.document):void 0),this.setBody(t.body?this.factory.create(t.body,this.document):void 0),this.setBottomBar(t.bottomBar?this.factory.create(t.bottomBar,this.document):void 0,t.bottomBarWithSafeArea,t.bottomBarSafeAreaColor),this.setFloatingBody(t.floatingBody?this.factory.create(t.floatingBody,this.document):void 0),t.name?null===(n=this.delegate)||void 0===n||n.setPageTitle(t.name):null===(i=this.delegate)||void 0===i||i.setPageTitle(""),this.delegate?t.backgroundColor?null===(s=this.delegate)||void 0===s||s.setPageBackgroundColor((0,r.cssColorHex)(t.backgroundColor)):null===(a=this.delegate)||void 0===a||a.setPageBackgroundColor("transparent"):(0,o.setDOMStyle)(this.htmlElement,{backgroundColor:t.backgroundColor?(0,r.cssColor)(t.backgroundColor):"unset"}),t.appBarColor&&(null===(l=this.delegate)||void 0===l||l.setAppBarColor((0,r.cssColorHex)(t.appBarColor),t.appBarTintColor?(0,r.cssColorHex)(t.appBarTintColor):"#000000")),this.body&&(this.body.htmlElement.style.touchAction=t.hasRootScroller?"unset":"none")},t.prototype.setDelegate=function(e){this.delegate=e},t.prototype.onRefresh=function(){var e=this;return new Promise((function(t){e.refreshEndResolver=t,e.engine.sendMessage(JSON.stringify({type:"scaffold",message:{event:"onRefresh",target:e.hashCode}}))}))},t.prototype.onWechatMiniProgramShareAppMessage=function(e){var t=this;return new Promise((function(n){t.onWechatMiniProgramShareAppMessageResolver=n,t.engine.sendMessage(JSON.stringify({type:"scaffold",message:{event:"onWechatMiniProgramShareAppMessage",target:t.hashCode,from:null==e?void 0:e.from,webViewUrl:null==e?void 0:e.webViewUrl}}))}))},t.prototype.onReachBottom=function(){this.engine.sendMessage(JSON.stringify({type:"scaffold",message:{event:"onReachBottom",target:this.hashCode}}))},t.prototype.onPageScroll=function(e){this.attributes.onPageScroll&&this.engine.sendMessage(JSON.stringify({type:"scaffold",message:{event:"onPageScroll",target:this.hashCode,scrollTop:e}}))},t.prototype.setChildren=function(){},t}(i.ComponentView);n.MPScaffold=s},{"../component_view":28,"../dom_utils":30,"../utils":43}],39:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.MPSlider=void 0;var i=e("../dom_utils"),o=function(e){function t(t){var n=e.call(this,t)||this;return n.firstSetup=!0,n.htmlElement.addEventListener("change",(function(e){n.invokeMethod("onValueChanged",{value:e.detail.value})})),n.htmlElement.addEventListener("changing",(function(e){n.invokeMethod("onValueChanged",{value:e.detail.value})})),(0,i.setDOMStyle)(n.htmlElement,{margin:"0",marginTop:"8px"}),n}return __extends(t,e),t.prototype.elementType=function(){return"wx-slider"},t.prototype.setAttributes=function(t){e.prototype.setAttributes.call(this,t),(0,i.setDOMAttribute)(this.htmlElement,"min",t.min),(0,i.setDOMAttribute)(this.htmlElement,"max",t.max),(0,i.setDOMAttribute)(this.htmlElement,"step",t.step),(0,i.setDOMAttribute)(this.htmlElement,"disabled",t.disabled),this.firstSetup&&(0,i.setDOMAttribute)(this.htmlElement,"value",t.defaultValue),this.firstSetup=!1},t.prototype.resetSliderValue=function(e){},t.prototype.onMethodCall=function(e,t){if("setValue"===e){var n=null==t?void 0:t.value;"number"==typeof n&&this.htmlElement.setAttribute("value",n)}},t}(e("../mpkit/platform_view").MPPlatformView);n.MPSlider=o},{"../dom_utils":30,"../mpkit/platform_view":37}],40:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.MPSwitch=void 0;var i=e("../dom_utils"),o=function(e){function t(t,n){var i=e.call(this,t,n)||this;return i.initialAttributes=n,i.firstSetted=!1,i.htmlElement.addEventListener("change",(function(e){i.invokeMethod("onValueChanged",{value:e.detail.value})})),i}return __extends(t,e),t.prototype.elementType=function(){return"wx-switch"},t.prototype.setAttributes=function(t){e.prototype.setAttributes.call(this,t),this.firstSetted||(this.firstSetted=!0,(0,i.setDOMAttribute)(this.htmlElement,"checked",t.defaultValue)),(0,i.setDOMAttribute)(this.htmlElement,"disabled",t.disabled),(0,i.setDOMAttribute)(this.htmlElement,"type",t.type),(0,i.setDOMAttribute)(this.htmlElement,"color",t.color)},t.prototype.onMethodCall=function(e,t){"setValue"===e&&(0,i.setDOMAttribute)(this.htmlElement,"checked",t.value)},t}(e("../mpkit/platform_view").MPPlatformView);n.MPSwitch=o},{"../dom_utils":30,"../mpkit/platform_view":37}],41:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.MPVideoView=void 0;var i=e("../dom_utils"),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.elementType=function(){return"video"},t.prototype.onMethodCall=function(e,t){return __awaiter(this,void 0,void 0,(function(){var n;return __generator(this,(function(i){switch(i.label){case 0:return[3,1];case 1:return this.videoContext?[3,3]:(n=this,[4,this.htmlElement.$$getContext()]);case 2:n.videoContext=i.sent(),i.label=3;case 3:this.videoContext&&this.onMiniProgramMethodCall(e,t),i.label=4;case 4:return[2]}}))}))},t.prototype.onBrowserMethodCall=function(e,t){},t.prototype.onMiniProgramMethodCall=function(e,t){"play"===e?this.videoContext.play():"pause"===e?this.videoContext.pause():"setVolume"===e||"volumeUp"===e||"volumeDown"===e||("setMuted"===e?this.videoContext.muted=t.muted:"fullscreen"===e?this.videoContext.requestFullScreen():"setPlaybackRate"===e?this.videoContext.playbackRate(t.playbackRate):"seekTo"===e&&this.videoContext.seek(t.seekTo))},t.prototype.setAttributes=function(t){e.prototype.setAttributes.call(this,t),(0,i.setDOMAttribute)(this.htmlElement,"src",t.url),t.controls&&(0,i.setDOMAttribute)(this.htmlElement,"controls",t.controls),t.autoplay&&(0,i.setDOMAttribute)(this.htmlElement,"autoplay",t.autoplay),t.loop&&(0,i.setDOMAttribute)(this.htmlElement,"loop",t.loop),t.muted&&(0,i.setDOMAttribute)(this.htmlElement,"muted",t.muted),t.poster&&(0,i.setDOMAttribute)(this.htmlElement,"poster",t.poster)},t.prototype.setChildren=function(){},t}(e("./platform_view").MPPlatformView);n.MPVideoView=o},{"../dom_utils":30,"./platform_view":37}],42:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.MPWebView=void 0;var i=e("../dom_utils"),o=function(e){function t(t,n){var i=e.call(this,t,n)||this;return i.document=t,i.initialAttributes=n,i.htmlElement.addEventListener("message",(function(e){var t;(null===(t=null==e?void 0:e.detail)||void 0===t?void 0:t.data)instanceof Array&&i.invokeMethod("mini_program_message",{data:e.detail.data})})),i}return __extends(t,e),t.prototype.elementType=function(){return"wx-web-view"},t.prototype.onMethodCall=function(e,t){"reload"===e?((0,i.setDOMAttribute)(this.htmlElement,"src",""),(0,i.setDOMAttribute)(this.htmlElement,"src",this.attributes.url)):"loadUrl"===e&&(null==t?void 0:t.url)&&((0,i.setDOMAttribute)(this.htmlElement,"src",""),(0,i.setDOMAttribute)(this.htmlElement,"src",t.url))},t.prototype.setAttributes=function(t){e.prototype.setAttributes.call(this,t),(0,i.setDOMAttribute)(this.htmlElement,"src",t.url),(0,i.setDOMStyle)(this.htmlElement,{border:"none"})},t.prototype.setChildren=function(){},t}(e("./platform_view").MPPlatformView);n.MPWebView=o},{"../dom_utils":30,"./platform_view":37}],43:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.cssSizeFromMPElement=n.cssPadding=n.cssTextStyle=n.getBaselineStyle=n.getFontStyleStyle=n.getFontWeightStyle=n.cssTextAlign=n.cssBorder=n.cssOffset=n.cssGradient=n.cssBorderRadius=n.cssColorHex=n.cssColor=void 0;n.cssColor=function(e){var t=parseInt(e),n=(t>>16&255).toString(16);n.length<2&&(n="0"+n);var i=(t>>8&255).toString(16);i.length<2&&(i="0"+i);var o=(t>>0&255).toString(16);o.length<2&&(o="0"+o);var r=(t>>24&255).toString(16);return"ff"===r?"#".concat(n).concat(i).concat(o):(r.length<2&&(r="0"+r),"rgba(".concat(t>>16&255,",").concat(t>>8&255,",").concat(t>>0&255,",").concat((t>>24&255)/255,")"))};n.cssColorHex=function(e){var t=parseInt(e),n=(t>>16&255).toString(16);n.length<2&&(n="0"+n);var i=(t>>8&255).toString(16);i.length<2&&(i="0"+i);var o=(t>>0&255).toString(16);return o.length<2&&(o="0"+o),"#".concat(n).concat(i).concat(o)};n.cssBorderRadius=function(e){var t,n,i,o,r,s,a,l;if(0===e.indexOf("BorderRadius.circular("))return{borderRadius:(c=e.replace("BorderRadius.circular(","").replace(")",""))+"px"};if(0===e.indexOf("BorderRadius.all("))return{borderRadius:(c=e.replace("BorderRadius.all(","").replace(")",""))+"px"};if(0===e.indexOf("BorderRadius.only(")){var c,u=null!==(n=null===(t=(c=e.replace("BorderRadius.only(","").replace(/\)/gi,"").replace(/Radius.circular\(/gi,"")).match(/topLeft: ([0-9|.]+)/))||void 0===t?void 0:t[1])&&void 0!==n?n:0,d=null!==(o=null===(i=c.match(/topRight: ([0-9|.]+)/))||void 0===i?void 0:i[1])&&void 0!==o?o:0,h=null!==(s=null===(r=c.match(/bottomLeft: ([0-9|.]+)/))||void 0===r?void 0:r[1])&&void 0!==s?s:0,p=null!==(l=null===(a=c.match(/bottomRight: ([0-9|.]+)/))||void 0===a?void 0:a[1])&&void 0!==l?l:0;return{borderTopLeftRadius:"".concat(u,"px"),borderTopRightRadius:"".concat(d,"px"),borderBottomLeftRadius:"".concat(h,"px"),borderBottomRightRadius:"".concat(p,"px")}}return{borderRadius:"0px"}};n.cssGradient=function(e){if(!e)return"";if("LinearGradient"===e.classname){var t=function(){switch(e.end){case"centerRight":return"to right";case"centerLeft":return"to left";case"topRight":return"to top right";case"bottomRight":return"to bottom right";case"topLeft":return"to top left";case"bottomLeft":return"to bottom left";case"topCenter":return"to top";case"bottomCenter":return"to bottom"}}(),i=[];return i=e.stops&&e.stops.length?e.colors.map((function(t,i){return void 0!==e.stops[i]?"".concat((0,n.cssColor)(t)," ").concat((100*e.stops[i]).toFixed(0),"%"):(0,n.cssColor)(t)})):e.colors.map((function(e){return(0,n.cssColor)(e)})),"linear-gradient(".concat(t,", ").concat(i.join(", "),")")}return""};n.cssOffset=function(e){if(0===e.indexOf("Offset(")){var t=e.replace("Offset(","").replace(")","").split(",").map((function(e){return e.trim()}));return{dx:t[0],dy:t[1]}}};n.cssBorder=function(e){var t={};return"BorderStyle.none"!==e.topStyle&&(t.borderTopWidth=0===e.topWidth?"".concat((1/window.devicePixelRatio).toFixed(2),"px"):e.topWidth+"px",t.borderTopColor=(0,n.cssColor)(e.topColor),t.borderTopStyle="solid"),"BorderStyle.none"!==e.leftStyle&&(t.borderLeftWidth=0===e.leftWidth?"".concat((1/window.devicePixelRatio).toFixed(2),"px"):e.leftWidth+"px",t.borderLeftColor=(0,n.cssColor)(e.leftColor),t.borderLeftStyle="solid"),"BorderStyle.none"!==e.bottomStyle&&(t.borderBottomWidth=0===e.bottomWidth?"".concat((1/window.devicePixelRatio).toFixed(2),"px"):e.bottomWidth+"px",t.borderBottomColor=(0,n.cssColor)(e.bottomColor),t.borderBottomStyle="solid"),"BorderStyle.none"!==e.rightStyle&&(t.borderRightWidth=0===e.rightWidth?"".concat((1/window.devicePixelRatio).toFixed(2),"px"):e.rightWidth+"px",t.borderRightColor=(0,n.cssColor)(e.rightColor),t.borderRightStyle="solid"),t};function i(e){if(e.fontWeight)return e.fontWeight.replace("FontWeight.w","")}function o(e){if("FontStyle.italic"===e.fontStyle)return"italic"}function r(e){return"TextBaseline.alphabetic"===e.textBaseline?"alphabetic":"TextBaseline.ideographic"===e.textBaseline?"ideographic":"TextBaseline.top"===e.textBaseline?"top":"TextBaseline.middle"===e.textBaseline?"middle":"TextBaseline.bottom"===e.textBaseline?"bottom":void 0}n.cssTextAlign=function(e){var t=null==e?void 0:e.replace("TextAlign.","");return"start"===t?"left":"end"===t?"right":t},n.getFontWeightStyle=i,n.getFontStyleStyle=o,n.getBaselineStyle=r,n.cssTextStyle=function(e){var t,s={userSelect:"none",WebkitUserSelect:"none"};return null!=e&&(e.fontFamily&&(s.fontFamily=e.fontFamily),null!=e.fontSize&&(s.fontSize="".concat((null!==(t=e.fontSize)&&void 0!==t?t:14).toString(),"px")),null!=e.color&&(s.color=(0,n.cssColor)(e.color)),e.fontWeight&&(s.fontWeight=i(e)),e.fontStyle&&(s.fontStyle=o(e)),e.letterSpacing&&(s.letterSpacing=e.letterSpacing),e.wordSpacing&&(s.wordSpacing=e.wordSpacing),e.textBaseline&&(s.alignmentBaseline=r(e)),e.height&&(s.lineHeight=e.height),null!=e.backgroundColor&&(s.backgroundColor=(0,n.cssColor)(e.backgroundColor)),e.decoration&&("TextDecoration.lineThrough"===e.decoration?s.textDecoration="line-through":"TextDecoration.underline"===e.decoration&&(s.textDecoration="underline"))),s};n.cssPadding=function(e){if(!e)return{};if(0===e.indexOf("EdgeInsets.zero"))return{};if(0===e.indexOf("EdgeInsets.all("))return{paddingLeft:(t=e.replace("EdgeInsets.all(","").replace(")",""))+"px",paddingTop:t+"px",paddingRight:t+"px",paddingBottom:t+"px"};if(0===e.indexOf("EdgeInsets(")){var t,n=(t=e.replace("EdgeInsets(","").replace(")","")).split(",").map((function(e){return e.trim()}));return{paddingLeft:n[0]+"px",paddingTop:n[1]+"px",paddingRight:n[2]+"px",paddingBottom:n[3]+"px"}}return{}};n.cssSizeFromMPElement=function(e){if(!e)return{width:0,height:0};var t=0,i=0;if(e.constraints&&"number"==typeof e.constraints.w&&"number"==typeof e.constraints.h&&e.constraints.w>0&&e.constraints.h>0)t=e.constraints.w,i=e.constraints.h;else if(e.children instanceof Array&&1===e.children.length)return(0,n.cssSizeFromMPElement)(e.children[0]);return{width:t,height:i}}},{}],44:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.createDebugger=void 0;var i=e("../env");n.createDebugger=function(e,t){return new r(e,t)};var o=function(){switch(i.MPEnv.platformType){case i.PlatformType.browser:return"browser";case i.PlatformType.wxMiniProgram:return"wechatMiniProgram";case i.PlatformType.swanMiniProgram:return"swanMiniProgram";case i.PlatformType.ttMiniProgram:return"ttMiniProgram";default:return"unknown"}},r=function(){function e(e,t){this.serverAddr=e,this.engine=t,this.messageQueue=[],this.connected=!1}return e.prototype.start=function(){var e=this;this.socket=i.MPEnv.platformScope.connectSocket({url:"ws://".concat(this.serverAddr,"/ws?clientType=").concat(o())}),this.socket.onOpen((function(){e.connected=!0,e.socketDidConnect()})),this.socket.onMessage((function(t){"string"==typeof t.data&&e.socketDidReceiveMessage(t.data)})),this.socket.onClose((function(){e.connected&&(e.engine.componentFactory.cachedElement={},e.engine.componentFactory.cachedView={},i.MPEnv.platformScope.reLaunch({url:function(){try{return"/"+i.MPEnv.platformScope.getLaunchOptionsSync().path+"?"+e.encodePathParams(i.MPEnv.platformScope.getLaunchOptionsSync().query)}catch(e){return"/pages/index/index"}}()})),e.connected=!1,e.socketDidDisconnect()}))},e.prototype.encodePathParams=function(e){var t=[];if(e)for(var n in e)t.push("".concat(n,"=").concat(encodeURIComponent(e[n])));return t.join("&")},e.prototype.socketDidConnect=function(){var e=this;this.messageQueue.forEach((function(t){var n;null===(n=e.socket)||void 0===n||n.send({data:t})})),this.messageQueue=[]},e.prototype.socketDidDisconnect=function(){var e=this;setTimeout((function(){e.start()}),1e3)},e.prototype.socketDidReceiveMessage=function(e){this.engine.didReceivedMessage(e)},e.prototype.sendMessage=function(e){this.socket&&this.connected?this.socket.send({data:e}):this.messageQueue.push(e)},e}();!function(){function e(e,t){this.serverAddr=e,this.engine=t,this.messageQueue=[],this.connected=!1,this.needReload=!1}e.prototype.start=function(){var e=this,t="ws";"https:"===new URL(location.href).protocol&&(t="wss"),this.socket=new WebSocket("".concat(t,"://").concat(this.serverAddr,"/ws?clientType=").concat(o())),this.socket.onopen=function(){e.needReload?location.href="?":(e.socketDidConnect(),e.connected=!0)},this.socket.onmessage=function(t){"string"==typeof t.data&&e.socketDidReceiveMessage(t.data)},this.socket.onclose=function(){e.needReload=!0,e.socketDidDisconnect()}},e.prototype.socketDidConnect=function(){var e=this;this.messageQueue.forEach((function(t){var n;null===(n=e.socket)||void 0===n||n.send(t)})),this.messageQueue=[]},e.prototype.socketDidDisconnect=function(){var e=this;setTimeout((function(){e.start()}),1e3)},e.prototype.socketDidReceiveMessage=function(e){this.engine.didReceivedMessage(e)},e.prototype.sendMessage=function(e){this.socket&&1==this.socket.readyState?this.socket.send(e):this.messageQueue.push(e)}}()},{"../env":46}],45:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:!0}),exports.Engine=void 0;var custom_paint_1=require("./components/basic/custom_paint"),web_dialogs_1=require("./components/basic/web_dialogs"),component_factory_1=require("./components/component_factory"),platform_view_1=require("./components/mpkit/platform_view"),debugger_1=require("./debugger/debugger"),env_1=require("./env"),platform_channel_io_1=require("./platform_channel/platform_channel_io"),mpjs_1=require("./mpjs/mpjs"),text_measurer_1=require("./text_measurer"),window_info_1=require("./window_info"),dart_object_1=require("./components/dart_object"),Engine=function(){function Engine(){this.started=!1,this.messageQueue=[],this.managedViews={},this.unmanagedViewFrameData={},this.mpJS=new mpjs_1.MPJS(this),this.windowInfo=new window_info_1.WindowInfo(this),this.pageMode=!1,this.componentFactory=new component_factory_1.ComponentFactory(this),this.drawable=new custom_paint_1.MPDrawable(this),this.platformChannelIO=new platform_channel_io_1.PlatformChannelIO(this),this.installWeChatComponentContextGetter()}return Engine.prototype.installWeChatComponentContextGetter=function(){},Engine.codeBlockWithCodePath=function(codePath){return new Promise((function(res,rej){var httpRequest=new XMLHttpRequest;httpRequest.onload=function(){res((function(){eval(httpRequest.response)}))},httpRequest.onerror=function(e){rej(e)},httpRequest.open("GET",codePath),httpRequest.send()}))},Engine.codeBlockWithFile=function(e){return function(){require(e).main()}},Engine.registerPlatformView=function(e,t){component_factory_1.ComponentFactory.components[e]=t},Engine.prototype.initWithDebuggerServerAddr=function(e){this.debugger=(0,debugger_1.createDebugger)(e,this)},Engine.prototype.initWithCodeBlock=function(e){this.codeBlock=e},Engine.prototype.start=function(){var e=this;this.started||(this.codeBlock||this.debugger)&&(this.windowInfo.updateWindowInfo(),this.listenViewport(),env_1.MPEnv.platformGlobal(),env_1.MPEnv.platformGlobal().JSON=JSON,env_1.MPEnv.platformGlobal().setTimeout=function(e,t){var n=setTimeout(e,t);return parseInt(n)},env_1.MPEnv.platformGlobal().setInterval=function(e,t){var n=setInterval(e,t);return parseInt(n)},env_1.MPEnv.platformGlobal().clearTimeout=function(e){clearTimeout(e)},env_1.MPEnv.platformGlobal().clearInterval=function(e){clearInterval(e)},env_1.MPEnv.platformGlobal().engineScope=this.mpJS.engineScope,env_1.MPEnv.platformGlobal().Object=Object,"undefined"!=typeof wx&&(env_1.MPEnv.platformGlobal().wx=wx,env_1.MPEnv.platformGlobal().uni=wx),"undefined"!=typeof swan&&(env_1.MPEnv.platformGlobal().swan=swan,env_1.MPEnv.platformGlobal().uni=swan),"undefined"!=typeof tt&&(env_1.MPEnv.platformGlobal().tt=tt,env_1.MPEnv.platformGlobal().uni=tt),this.debugger&&this.debugger.start(),this.codeBlock&&(this.mpJS.engineScope.onMessage=function(t){e.didReceivedMessage(t)},this.mpJS.engineScope.onMapMessage=function(t){e.didReceivedMessage(t,!0)},e.codeBlock(),this.flushQueueMessage()),this.started=!0)},Engine.prototype.sendMessage=function(e){var t;(null===(t=env_1.MPEnv.platformGlobal())||void 0===t?void 0:t.mpDEBUG)&&console.log((new Date).getTime(),"out",JSON.parse(e)),this.debugger?this.debugger.sendMessage(e):this.mpJS.engineScope.postMessage?this.mpJS.engineScope.postMessage(e):this.messageQueue.push(e)},Engine.prototype.flushQueueMessage=function(){var e=this;this.debugger||this.mpJS.engineScope.postMessage&&this.messageQueue.forEach((function(t){e.mpJS.engineScope.postMessage(t)}))},Engine.prototype.didReceivedMessage=function(e,t){var n,i,o,r,s,a;void 0===t&&(t=!1);var l=t?(0,dart_object_1.wrapDartObject)(e):JSON.parse(e);l&&((null===(n=env_1.MPEnv.platformGlobal())||void 0===n?void 0:n.mpDEBUG)&&console.log((new Date).getTime(),"in",l),"frame_data"===l.type?this.didReceivedFrameData(l.message):"diff_data"===l.type?this.didReceivedDiffData(l.message):"element_gc"===l.type?l.message instanceof Array&&this.didReceivedElementGC(l.message):"decode_drawable"===l.type?this.drawable.decodeDrawable(l.message):"custom_paint"===l.type?custom_paint_1.CustomPaint.didReceivedCustomPaintMessage(l.message,this):"route"===l.type?null===(r=null!==(o=null===(i=this.app)||void 0===i?void 0:i.router)&&void 0!==o?o:this.router)||void 0===r||r.didReceivedRouteData(l.message):"mpjs"===l.type?this.didReceivedMPJS(l):"action:web_dialogs"===l.type?web_dialogs_1.WebDialogs.receivedWebDialogsMessage(this,l.message):"scaffold"===l.type?this.didReceivedScaffold(l.message):"scroll_view"===l.type?this.didReceivedScrollView(l.message):"editable_text"===l.type?this.didReceivedEditableText(l.message):"rich_text"===l.type&&"doMeasure"===(null===(s=l.message)||void 0===s?void 0:s.event)?text_measurer_1.TextMeasurer.didReceivedDoMeasureData(this,l.message):"rich_text"===l.type&&"doMeasureTextPainter"===(null===(a=l.message)||void 0===a?void 0:a.event)?text_measurer_1.TextMeasurer.didReceivedDoMeasureTextPainter(this,l.message):"platform_view"===l.type?this.didReceivedPlatformView(l.message):"platform_channel"===l.type&&this.platformChannelIO.didReceivedPlatformChannel(l.message))},Engine.prototype.didReceivedFrameData=function(e){var t;if(e){var n=e.routeId;if(void 0===this.managedViews[n])return this.unmanagedViewFrameData[n]||(this.unmanagedViewFrameData[n]=[]),void this.unmanagedViewFrameData[n].push(e);"number"==typeof n&&(null===(t=this.managedViews[n])||void 0===t||t.didReceivedFrameData(e))}},Engine.prototype.didReceivedDiffData=function(e){var t=this;e&&e.diffs.forEach((function(e){t.componentFactory.create(e,void 0),t.componentFactory.createAncestors(e,void 0)}))},Engine.prototype.didReceivedElementGC=function(e){var t=this;e.forEach((function(e){var n;null===(n=t.componentFactory.cachedView[e])||void 0===n||n.dispose(),delete t.componentFactory.cachedElement[e],delete t.componentFactory.cachedView[e]}))},Engine.prototype.didReceivedScaffold=function(e){var t,n;if("onRefreshEnd"===e.event)(i=this.componentFactory.cachedView[e.target])&&(null===(t=i.refreshEndResolver)||void 0===t||t.call(i,void 0),i.refreshEndResolver=void 0);else if("onWechatMiniProgramShareAppMessageResolve"===e.event){var i;(i=this.componentFactory.cachedView[e.target])&&(null===(n=i.onWechatMiniProgramShareAppMessageResolver)||void 0===n||n.call(i,e.params),i.onWechatMiniProgramShareAppMessageResolver=void 0)}},Engine.prototype.didReceivedScrollView=function(e){var t;if("onRefreshEnd"===e.event)(n=this.componentFactory.cachedView[e.target])&&(null===(t=n.refreshEndResolver)||void 0===t||t.call(n,void 0),n.refreshEndResolver=void 0);else if("jumpTo"===e.event){var n;(n=this.componentFactory.cachedView[e.target])&&n.jumpTo(e.value)}},Engine.prototype.didReceivedEditableText=function(e){var t,n;if("unfocus"===e.event)(i=this.componentFactory.cachedView[e.target])&&(null===(t=i.contentElement)||void 0===t||t.blur());else if("focus"===e.event){var i;(i=this.componentFactory.cachedView[e.target])&&(null===(n=i.contentElement)||void 0===n||n.focus())}},Engine.prototype.didReceivedMPJS=function(e){var t=this;this.mpJS.handleMessage(e.message,(function(n){t.sendMessage(JSON.stringify({type:"mpjs",message:{requestId:e.message.requestId,result:n}}))}),(function(e,n){t.sendMessage(JSON.stringify({type:"mpjs",message:{funcId:e,arguments:n}}))}))},Engine.prototype.didReceivedPlatformView=function(e){return __awaiter(this,void 0,void 0,(function(){var t,n,i;return __generator(this,(function(o){switch(o.label){case 0:return"methodCall"!==e.event?[3,3]:(t=this.componentFactory.cachedView[e.hashCode])?[4,t.onMethodCall(e.method,e.params)]:[3,2];case 1:n=o.sent(),e.requireResult&&this.sendMessage(JSON.stringify({type:"platform_view",message:{event:"methodCallCallback",seqId:e.seqId,result:n}})),o.label=2;case 2:return[3,4];case 3:"methodCallCallback"===e.event&&"string"==typeof(i=e.seqId)&&platform_view_1.MPPlatformView.handleInvokeMethodCallback(i,e.result),o.label=4;case 4:return[2]}}))}))},Engine.prototype.listenViewport=function(){},Engine.prototype.sendViewportChangeEvent=function(){var e=this;this.sendViewportHandler&&clearTimeout(this.sendViewportHandler),this.sendViewportHandler=setTimeout((function(){var t,n;e.windowInfo.updateWindowInfo(),null===(n=null===(t=e.app)||void 0===t?void 0:t.router)||void 0===n||n.history.forEach((function(e){e.item.viewportChanged()})),e.sendViewportHandler=void 0}),32)},Engine}();exports.Engine=Engine},{"./components/basic/custom_paint":7,"./components/basic/web_dialogs":26,"./components/component_factory":27,"./components/dart_object":29,"./components/mpkit/platform_view":37,"./debugger/debugger":44,"./env":46,"./mpjs/mpjs":49,"./platform_channel/platform_channel_io":53,"./text_measurer":56,"./window_info":57}],46:[function(e,t,n){(function(e){(function(){var t;Object.defineProperty(n,"__esModule",{value:!0}),n.MPEnv=n.PlatformType=void 0,function(e){e[e.unknown=0]="unknown",e[e.browser=1]="browser",e[e.wxMiniProgram=2]="wxMiniProgram",e[e.swanMiniProgram=3]="swanMiniProgram",e[e.ttMiniProgram=4]="ttMiniProgram"}(t=n.PlatformType||(n.PlatformType={}));var i={};n.MPEnv={platformType:"undefined"!=typeof swan&&"function"==typeof swan.getSystemInfoSync?t.swanMiniProgram:"undefined"!=typeof tt&&"function"==typeof tt.getSystemInfoSync?t.ttMiniProgram:"undefined"!=typeof wx&&"function"==typeof wx.getSystemInfoSync?t.wxMiniProgram:t.browser,platformScope:"undefined"!=typeof swan&&"function"==typeof swan.getSystemInfoSync?swan:"undefined"!=typeof tt&&"function"==typeof tt.getSystemInfoSync?tt:"undefined"!=typeof wx&&"function"==typeof wx.getSystemInfoSync?wx:void 0,platformAppInstance:void 0,platformGlobal:function(){return n.MPEnv.platformAppInstance?n.MPEnv.platformAppInstance:"function"==typeof getApp?getApp():"undefined"!=typeof window?window:void 0!==e?e:i},platformPC:function(){return!1},platformWindow:function(e){return e&&e.window?e.window:"undefined"!=typeof window?window:void 0}}}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],47:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.MPEnv=n.ComponentFactory=n.setDOMStyle=n.setDOMAttribute=n.PluginRegister=n.MPEventChannel=n.MPMethodChannel=n.MPPlatformView=n.BrowserApp=n.Page=n.Engine=void 0;var i=e("./engine");Object.defineProperty(n,"Engine",{enumerable:!0,get:function(){return i.Engine}});var o=e("./page");Object.defineProperty(n,"Page",{enumerable:!0,get:function(){return o.Page}});var r=e("./browser_app");Object.defineProperty(n,"BrowserApp",{enumerable:!0,get:function(){return r.BrowserApp}});var s=e("./components/mpkit/platform_view");Object.defineProperty(n,"MPPlatformView",{enumerable:!0,get:function(){return s.MPPlatformView}});var a=e("./platform_channel/mp_method_channel");Object.defineProperty(n,"MPMethodChannel",{enumerable:!0,get:function(){return a.MPMethodChannel}});var l=e("./platform_channel/mp_event_channel");Object.defineProperty(n,"MPEventChannel",{enumerable:!0,get:function(){return l.MPEventChannel}});var c=e("./platform_channel/plugin_register");Object.defineProperty(n,"PluginRegister",{enumerable:!0,get:function(){return c.PluginRegister}});var u=e("./components/dom_utils");Object.defineProperty(n,"setDOMAttribute",{enumerable:!0,get:function(){return u.setDOMAttribute}}),Object.defineProperty(n,"setDOMStyle",{enumerable:!0,get:function(){return u.setDOMStyle}});var d=e("./components/component_factory");Object.defineProperty(n,"ComponentFactory",{enumerable:!0,get:function(){return d.ComponentFactory}});var h=e("./env");Object.defineProperty(n,"MPEnv",{enumerable:!0,get:function(){return h.MPEnv}})},{"./browser_app":1,"./components/component_factory":27,"./components/dom_utils":30,"./components/mpkit/platform_view":37,"./engine":45,"./env":46,"./page":50,"./platform_channel/mp_event_channel":51,"./platform_channel/mp_method_channel":52,"./platform_channel/plugin_register":54}],48:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.MPEnv=n.ComponentFactory=n.setDOMStyle=n.setDOMAttribute=n.PluginRegister=n.MPEventChannel=n.MPMethodChannel=n.MPPlatformView=n.WXPage=n.WXApp=n.Page=n.Engine=void 0;var i=e("./engine");Object.defineProperty(n,"Engine",{enumerable:!0,get:function(){return i.Engine}});var o=e("./page");Object.defineProperty(n,"Page",{enumerable:!0,get:function(){return o.Page}});var r=e("./wx_app");Object.defineProperty(n,"WXApp",{enumerable:!0,get:function(){return r.WXApp}}),Object.defineProperty(n,"WXPage",{enumerable:!0,get:function(){return r.WXPage}});var s=e("./components/mpkit/platform_view");Object.defineProperty(n,"MPPlatformView",{enumerable:!0,get:function(){return s.MPPlatformView}});var a=e("./platform_channel/mp_method_channel");Object.defineProperty(n,"MPMethodChannel",{enumerable:!0,get:function(){return a.MPMethodChannel}});var l=e("./platform_channel/mp_event_channel");Object.defineProperty(n,"MPEventChannel",{enumerable:!0,get:function(){return l.MPEventChannel}});var c=e("./platform_channel/plugin_register");Object.defineProperty(n,"PluginRegister",{enumerable:!0,get:function(){return c.PluginRegister}});var u=e("./components/dom_utils");Object.defineProperty(n,"setDOMAttribute",{enumerable:!0,get:function(){return u.setDOMAttribute}}),Object.defineProperty(n,"setDOMStyle",{enumerable:!0,get:function(){return u.setDOMStyle}});var d=e("./components/component_factory");Object.defineProperty(n,"ComponentFactory",{enumerable:!0,get:function(){return d.ComponentFactory}});var h=e("./env");Object.defineProperty(n,"MPEnv",{enumerable:!0,get:function(){return h.MPEnv}})},{"./components/component_factory":27,"./components/dom_utils":30,"./components/mpkit/platform_view":37,"./engine":45,"./env":46,"./page":50,"./platform_channel/mp_event_channel":51,"./platform_channel/mp_method_channel":52,"./platform_channel/plugin_register":54,"./wx_app":58}],49:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.MPJS=void 0;var i=e("../env"),o=function(){function e(e){this.engine=e,this.engineScope={},this.objectRefs={},this.funcRefs={}}return e.prototype.handleMessage=function(e,t,n){"callMethod"===e.event?this.callMethod(e,t,n):"getValue"===e.event?this.getValue(e,t):"setValue"===e.event?this.setValue(e,t):"hasProperty"===e.event?this.hasProperty(e,t):"deleteProperty"===e.event&&this.deleteProperty(e,t)},e.prototype.callMethod=function(e,t,n){var i;return __awaiter(this,void 0,void 0,(function(){var o,r,s,a,l=this;return __generator(this,(function(c){switch(c.label){case 0:if(o=e.params,"object"!=typeof(r=this.getCallee(o.objectHandler,o.callChain))&&"function"!=typeof r)return[3,5];c.label=1;case 1:return c.trys.push([1,4,,5]),(s=r[o.method].apply(r,null===(i=o.args)||void 0===i?void 0:i.map((function(e){return l.wrapArgument(e,n)}))))instanceof Promise?[4,s]:[3,3];case 2:s=c.sent(),c.label=3;case 3:return t(this.wrapResult(s)),[3,5];case 4:return a=c.sent(),console.error(a),[3,5];case 5:return[2]}}))}))},e.prototype.getValue=function(e,t){return __awaiter(this,void 0,void 0,(function(){var n,i,o;return __generator(this,(function(r){switch(r.label){case 0:return n=e.params,i=this.getCallee(n.objectHandler,n.callChain),(o=i[n.key])instanceof Promise?[4,o]:[3,2];case 1:o=r.sent(),r.label=2;case 2:return t(this.wrapResult(o)),[2]}}))}))},e.prototype.setValue=function(e,t){var n=e.params;this.getCallee(n.objectHandler,n.callChain)[n.key]=n.value,t(void 0)},e.prototype.hasProperty=function(e,t){var n=e.params,i=this.getCallee(n.objectHandler,n.callChain);t(this.wrapResult(i&&i.hasOwnProperty(n.key)))},e.prototype.deleteProperty=function(e,t){var n=e.params,i=this.getCallee(n.objectHandler,n.callChain);i&&delete i[n.key],t(1)},e.prototype.getCallee=function(e,t){var n,o,r,s,a=null!==(n=this.objectRefs[e])&&void 0!==n?n:i.MPEnv.platformGlobal();"engineScope"===t[0]&&(a=this.engineScope,t.shift());for(var l=0;l<t.length;l++){var c=t[l];if(a=a[c],"document"===c&&0===l&&void 0===a&&(a=null===(s=null===(r=null===(o=this.engine)||void 0===o?void 0:o.managedViews)||void 0===r?void 0:r[0])||void 0===s?void 0:s.document),null==a)break}return a},e.prototype.wrapArgument=function(e,t){var n,i=this;if(console.log(e),"string"==typeof e&&0===e.indexOf("func:")){var o=e,r=this,s=null!==(n=this.funcRefs[e])&&void 0!==n?n:function(){for(var e=[],n=0;n<arguments.length;n++){var i=arguments[n];e.push(r.wrapResult(i))}t(o,e)};return this.funcRefs[e]=s,s}if("string"==typeof e&&0===e.indexOf("obj:"))return this.objectRefs[e.replace("obj:","")];if("object"==typeof e&&e instanceof Array)return e.map((function(e){return i.wrapArgument(e,t)}));if("object"==typeof e){var a={};for(var l in e)a[l]=this.wrapArgument(e[l],t);return a}return e},e.prototype.wrapResult=function(e){var t=this;if("string"==typeof e||"number"==typeof e||"boolean"==typeof e||"bigint"==typeof e)return e;if("object"==typeof e&&e instanceof Array)return e.map((function(e){return t.wrapResult(e)}));var n=Math.random().toString();return this.objectRefs[n]=e,{objectHandler:n}},e}();n.MPJS=o},{"../env":46}],50:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Page=void 0;var i=e("./components/dom_utils"),o=e("./components/mpkit/scaffold"),r=e("./env"),s=e("./router"),a=function(){function e(e,t,n,i){void 0===i&&(i=null===self||void 0===self?void 0:self.document);var o=this;this.element=e,this.engine=t,this.options=n,this.document=i,this._active=!0,this.viewId=-1,this.overlaysView=[],this.isFirst=!1,this.bodyElement=i.createElement("wx-view"),this.overlayElement=i.createElement("wx-view"),this.bodyElement===e&&this.overlayElement===e||(this.element.appendChild(this.bodyElement),this.element.appendChild(this.overlayElement)),this.requestRoute().then((function(e){var n;o.viewId=e,t.managedViews[o.viewId]=o,t.pageMode=!0,t.unmanagedViewFrameData[o.viewId]&&(t.unmanagedViewFrameData[o.viewId].forEach((function(e){o.didReceivedFrameData(e)})),delete t.unmanagedViewFrameData[o.viewId]),null===(n=o.readyCallback)||void 0===n||n.call(o,void 0)}))}return e.prototype.ready=function(){return __awaiter(this,void 0,void 0,(function(){var e=this;return __generator(this,(function(t){return[2,new Promise((function(t){e.readyCallback=t}))]}))}))},e.prototype.requestRoute=function(){var e,t,n,i,o,r;return __awaiter(this,void 0,void 0,(function(){var a,l;return __generator(this,(function(c){switch(c.label){case 0:return this.engine.app||(this.engine.router=new s.Router(this.engine)),a=null!==(t=null===(e=this.engine.app)||void 0===e?void 0:e.router)&&void 0!==t?t:null===(n=this.engine)||void 0===n?void 0:n.router,[4,this.delay()];case 1:return c.sent(),[4,this.fetchViewport()];case 2:return l=c.sent(),[2,a.requestRoute(null!==(o=null===(i=this.options)||void 0===i?void 0:i.route)&&void 0!==o?o:"/",null===(r=this.options)||void 0===r?void 0:r.params,this.isFirst||void 0===this.engine.app,{width:l.width,height:l.height})]}}))}))},e.prototype.delay=function(){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(e){return[2,new Promise((function(e){setTimeout((function(){e(null)}),1e3)}))]}))}))},e.prototype.fetchViewport=function(){return __awaiter(this,void 0,void 0,(function(){var e,t;return __generator(this,(function(n){switch(n.label){case 0:return[2,{width:r.MPEnv.platformScope.getSystemInfoSync().windowWidth,height:r.MPEnv.platformScope.getSystemInfoSync().windowHeight}];case 1:return(!(e=__assign.apply(void 0,t.concat([n.sent()]))).width||e.width<=.1)&&(e.width=r.MPEnv.platformScope.getSystemInfoSync().windowWidth),(!e.height||e.height<=.1)&&(e.height=r.MPEnv.platformScope.getSystemInfoSync().windowHeight),[2,e]}}))}))},e.prototype.dispose=function(){delete this.engine.managedViews[this.viewId]},e.prototype.viewportChanged=function(){var e,t,n;return __awaiter(this,void 0,void 0,(function(){var i,o;return __generator(this,(function(r){switch(r.label){case 0:return(i=null!==(t=null===(e=this.engine.app)||void 0===e?void 0:e.router)&&void 0!==t?t:null===(n=this.engine)||void 0===n?void 0:n.router)?[4,this.fetchViewport()]:[3,2];case 1:o=r.sent(),i.updateRoute(this.viewId,{width:o.width,height:o.height}),r.label=2;case 2:return[2]}}))}))},e.prototype.didReceivedFrameData=function(e){return __awaiter(this,void 0,void 0,(function(){var t;return __generator(this,(function(n){switch(n.label){case 0:return(!e.overlays||e.overlays&&e.overlays instanceof Array&&0===e.overlays.length)&&this.overlaysView.length>0?(this.overlaysView.forEach((function(e){e.htmlElement.style.visibility="hidden"})),[4,this.removeOverlays()]):[3,2];case 1:n.sent(),n.label=2;case 2:if(!0!==e.ignoreScaffold){if(!((t=this.engine.componentFactory.create(e.scaffold,this.document))instanceof o.MPScaffold))return[2];this.scaffoldView!==t&&(this.scaffoldView&&(this.scaffoldView.attached=!1,this.scaffoldView.htmlElement.remove(),this.scaffoldView.removeFromSuperview()),this.scaffoldView=t,t instanceof o.MPScaffold&&!t.delegate&&(t.setDelegate(new l(this.document,this.miniProgramPage)),t.setAttributes(e.scaffold.attributes))),this.scaffoldView&&this.active&&!this.scaffoldView.attached&&(this.scaffoldView.attached=!0,this.bodyElement.appendChild(this.scaffoldView.htmlElement),(0,i.setDOMStyle)(this.scaffoldView.htmlElement,{display:"contents"}))}return e.overlays&&e.overlays instanceof Array&&this.setOverlays(e.overlays),[2]}}))}))},e.prototype.onRefresh=function(){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(e){switch(e.label){case 0:return this.scaffoldView instanceof o.MPScaffold?[4,this.scaffoldView.onRefresh()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))},e.prototype.onWechatMiniProgramShareAppMessage=function(e){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(t){switch(t.label){case 0:return this.scaffoldView instanceof o.MPScaffold?[4,this.scaffoldView.onWechatMiniProgramShareAppMessage(e)]:[3,2];case 1:return[2,t.sent()];case 2:return[2]}}))}))},e.prototype.onReachBottom=function(){this.scaffoldView instanceof o.MPScaffold&&this.scaffoldView.onReachBottom()},e.prototype.onPageScroll=function(e){this.scaffoldView instanceof o.MPScaffold&&this.scaffoldView.onPageScroll(e)},e.prototype.removeOverlays=function(){return __awaiter(this,void 0,void 0,(function(){var e=this;return __generator(this,(function(t){return[2,new Promise((function(t){e.overlaysView.forEach((function(e){e.removeFromSuperview(),setTimeout((function(){e.htmlElement.remove()}),300)})),e.overlaysView=[],setTimeout((function(){t(null)}),100)}))]}))}))},e.prototype.setOverlays=function(e){var t=this,n=e.map((function(e){return t.engine.componentFactory.create(e,t.document)})).filter((function(e){return e}));n.length===this.overlaysView.length&&n.every((function(e,i){return n[i]===t.overlaysView[i]}))||(this.overlaysView.forEach((function(e){e.removeFromSuperview(),setTimeout((function(){e.htmlElement.remove()}),300)})),n.forEach((function(e){t.overlayElement.appendChild(e.htmlElement)})),this.overlaysView=n)},Object.defineProperty(e.prototype,"active",{get:function(){return this._active},set:function(e){var t;this._active=e,e?(null===(t=this.scaffoldView)||void 0===t?void 0:t.htmlElement)&&(this.element.appendChild(this.scaffoldView.htmlElement),this.scaffoldView.setAttributes(this.scaffoldView.attributes)):this.scaffoldView&&(this.scaffoldView.attached=!1,this.scaffoldView.htmlElement.remove())},enumerable:!1,configurable:!0}),e}();n.Page=a;!function(){function e(e,t){this.document=e,this.scaffoldView=t,this.observingScroller=!1,this.installPageScrollListener()}e.prototype.setPageTitle=function(e){this.document.title=e},e.prototype.setPageBackgroundColor=function(e){this.document.body.style.backgroundColor=e},e.prototype.setAppBarColor=function(e,t){},e.prototype.installPageScrollListener=function(){var e,t=this;e=function(n){if(!t.scaffoldView.htmlElement.isConnected)return t.observingScroller=!1,void window.removeEventListener("scroll",e);t.scaffoldView.onPageScroll(window.scrollY)},this.observingScroller||(this.observingScroller=!0,window.addEventListener("scroll",e))}}();var l=function(){function e(e,t){this.document=e,this.miniProgramPage=t,this.backgroundElement=this.document.createElement("div"),this.backgroundElementAttached=!1}return e.prototype.setPageTitle=function(e){r.MPEnv.platformScope.setNavigationBarTitle({title:e})},e.prototype.setPageBackgroundColor=function(e){if("transparent"===e)return this.backgroundElement.remove(),void(this.backgroundElementAttached=!1);(0,i.setDOMStyle)(this.backgroundElement,{position:"fixed",width:"100vw",height:"100vh",zIndex:"-1",backgroundColor:e}),this.backgroundElementAttached||(this.document.body.appendChild(this.backgroundElement),this.backgroundElementAttached=!0)},e.prototype.setAppBarColor=function(e,t){r.MPEnv.platformPC()&&r.MPEnv.platformScope.setNavigationBarColor({frontColor:t,backgroundColor:e}),this.miniProgramPage.setData({"pageMeta.naviBar.backgroundColor":e,"pageMeta.naviBar.frontColor":t})},e}()},{"./components/dom_utils":30,"./components/mpkit/scaffold":38,"./env":46,"./router":55}],51:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.MPEventChannel=void 0;var i=function(){function e(){}return e.prototype.onListen=function(e,t){},e.prototype.onCancel=function(e){},e}();n.MPEventChannel=i},{}],52:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.MPMethodChannel=void 0;var i=0;var o=function(){function e(){}return e.prototype.onMethodCall=function(e,t){throw"NOTIMPLEMENTED"},e.prototype.invokeMethod=function(e,t){return __awaiter(this,void 0,void 0,(function(){var n=this;return __generator(this,(function(o){return[2,new Promise((function(o,r){if(n.channelName&&n.engine){var s=++i;n.engine.sendMessage(JSON.stringify({type:"platform_channel",message:{event:"invokeMethod",method:n.channelName,beInvokeMethod:e,beInvokeParams:t,seqId:s}})),n.engine.platformChannelIO.responseCallbacks[s]=[o,r]}}))]}))}))},e}();n.MPMethodChannel=o},{}],53:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.PlatformChannelIO=void 0;var i=e(".."),o=e("./plugin_register"),r=function(){function e(e){for(var t in this.engine=e,this.pluginInstances={},this.responseCallbacks={},o.PluginRegister.registedChannels)if(Object.prototype.hasOwnProperty.call(o.PluginRegister.registedChannels,t)){var n=o.PluginRegister.registedChannels[t];try{this.pluginInstances[t]=new n,this.pluginInstances[t].channelName=t,this.pluginInstances[t].engine=e}catch(e){console.error(e)}}}return e.prototype.didReceivedPlatformChannel=function(e){return __awaiter(this,void 0,void 0,(function(){var t,n,o,r,s,a,l,c,u,d=this;return __generator(this,(function(h){switch(h.label){case 0:if("invokeMethod"!==e.event)return[3,7];if(t=e.method,n=e.beInvokeMethod,o=e.beInvokeParams,r=e.seqId,!((s=this.pluginInstances[t])instanceof i.MPMethodChannel))return[3,5];h.label=1;case 1:return h.trys.push([1,3,,4]),[4,s.onMethodCall(n,o)];case 2:return c=h.sent(),this.engine.sendMessage(JSON.stringify({type:"platform_channel",message:{event:"callbackResult",result:c,seqId:r}})),[3,4];case 3:return a=h.sent(),this.engine.sendMessage(JSON.stringify({type:"platform_channel",message:{event:"callbackResult",result:"ERROR:"+a,seqId:r}})),[3,4];case 4:return[3,6];case 5:s instanceof i.MPEventChannel&&("listen"===n?s.onListen(o,(function(e){d.engine.sendMessage(JSON.stringify({type:"platform_channel",message:{event:"callbackEventSink",method:t,result:e,seqId:r}}))})):"cancel"===n&&s.onCancel(o)),h.label=6;case 6:return[3,8];case 7:"callbackResult"===e.event&&(l=e.seqId,c=e.result,void 0!==(u=this.responseCallbacks[l])&&("NOTIMPLEMENTED"===c||"string"==typeof c&&0===c.indexOf("ERROR:")?u[1](c):u[0](c)),delete this.responseCallbacks[l]),h.label=8;case 8:return[2]}}))}))},e}();n.PlatformChannelIO=r},{"..":47,"./plugin_register":54}],54:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.PluginRegister=void 0;var i=e("../components/component_factory"),o=function(){function e(){}return e.registerChannel=function(e,t){this.registedChannels[e]=t},e.registerPlatformView=function(e,t){i.ComponentFactory.components[e]=t},e.registedChannels={},e}();n.PluginRegister=o},{"../components/component_factory":27}],55:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Router=void 0;var i=function(){function e(e){this.engine=e,this.routeResponseHandler={}}return e.clearBeingPushTimeout=function(){this.beingPushTimeout&&(clearTimeout(this.beingPushTimeout),this.beingPushTimeout=void 0)},e.prototype.updateRoute=function(e,t){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(n){return this.engine.sendMessage(JSON.stringify({type:"router",message:{event:"updateRoute",routeId:e,viewport:t}})),[2]}))}))},e.prototype.requestRoute=function(e,t,n,i){return __awaiter(this,void 0,void 0,(function(){var o,r,s=this;return __generator(this,(function(a){return this.thePushingRouteId?(o=this.thePushingRouteId,this.thePushingRouteId=void 0,this.engine.sendMessage(JSON.stringify({type:"router",message:{event:"updateRoute",routeId:o,viewport:i}})),[2,o]):(r=Math.random().toString(),[2,new Promise((function(o){s.routeResponseHandler[r]=o,s.engine.sendMessage(JSON.stringify({type:"router",message:{event:"requestRoute",requestId:r,name:e,params:null!=t?t:{},viewport:i,root:!0===n}}))}))])}))}))},e.prototype.responseRoute=function(e){var t,n=e.requestId,i=e.routeId;null===(t=this.routeResponseHandler[n])||void 0===t||t.call(this,i)},e.prototype.disposeRoute=function(e){this.engine.sendMessage(JSON.stringify({type:"router",message:{event:"disposeRoute",routeId:e}}))},e.prototype.didReceivedRouteData=function(e){var t=e.event;"responseRoute"===t?this.responseRoute(e):"didPush"===t?this.didPush(e):"didReplace"===t?this.didReplace(e):"didPop"===t&&this.didPop()},e.prototype.didPush=function(e){throw"native implementation"},e.prototype.didReplace=function(e){throw"native implementation"},e.prototype.didPop=function(){throw"native implementation"},e.beingPush=!1,e}();n.Router=i},{}],56:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.TextMeasurer=void 0;var i=e("./components/basic/rich_text"),o=e("./components/component_factory"),r=e("./components/dom_utils"),s=e("./router"),a=function(){function e(){}return e.delay=function(){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(e){return[2,new Promise((function(e){setTimeout((function(){e(null)}),50)}))]}))}))},e.calcMeasureCache=function(e){var t=e.textCache,n=e.textCacheSize,i=this.zhMeasureCache[n]?{measureId:e.attributes.measureId,width:Math.ceil(this.zhMeasureCache[n].width*t.length)+1,height:Math.ceil(this.zhMeasureCache[n].height)+1}:void 0;if(e.constraints&&i&&(i.width<e.constraints.w||0===e.constraints.w))return i},e.saveMeasureCache=function(e,t){var n=e.textCache,i=e.textCacheSize;if(e.constraints&&(e.constraints.w>t.width+44||0===e.constraints.w)){var o={width:t.width/n.length,height:t.height};this.zhMeasureCache[i]=o}},e.didReceivedDoMeasureTextPainter=function(e,t){var n,o,a,l,c,u;return __awaiter(this,void 0,void 0,(function(){var d,h;return __generator(this,(function(p){switch(p.label){case 0:this.activeTextMeasureDocument||(this.activeTextMeasureDocument=document),p.label=1;case 1:return s.Router.beingPush?[4,this.delay()]:[3,3];case 2:return p.sent(),[3,1];case 3:return this.activeTextMeasureDocument?[3,5]:[4,this.delay()];case 4:return p.sent(),[3,3];case 5:return(d=new i.RichText(this.activeTextMeasureDocument,{})).setAttributes({maxWidth:t.maxWidth}),d.setSingleTextSpan([t.text]),(0,r.setDOMStyle)(d.htmlElement,{position:"fixed",top:"0px",left:"0px",opacity:"0",width:"unset",maxWidth:(null===(n=d.attributes)||void 0===n?void 0:n.maxWidth)&&"Infinity"!==(null===(o=d.attributes)||void 0===o?void 0:o.maxWidth)?(null===(a=d.attributes)||void 0===a?void 0:a.maxWidth)+"px":"999999px",height:"unset",maxHeight:(null===(l=d.attributes)||void 0===l?void 0:l.maxHeight)&&"Infinity"!==(null===(c=d.attributes)||void 0===c?void 0:c.maxHeight)?(null===(u=d.attributes)||void 0===u?void 0:u.maxHeight)+"px":"999999px"}),this.activeTextMeasureDocument.body.appendChild(d.htmlElement),[4,this.delay()];case 6:p.sent(),p.label=7;case 7:return[4,d.htmlElement.getBoundingClientRect()];case 8:return h=p.sent(),d.htmlElement.remove(),e.componentFactory.callbackTextPainterMeasureResult(t.seqId,h),[2]}}))}))},e.didReceivedDoMeasureData=function(e,t){return __awaiter(this,void 0,void 0,(function(){var n,i,a=this;return __generator(this,(function(l){switch(l.label){case 0:this.activeTextMeasureDocument||(this.activeTextMeasureDocument=document),l.label=1;case 1:return s.Router.beingPush?[4,this.delay()]:[3,3];case 2:return l.sent(),[3,1];case 3:return this.activeTextMeasureDocument?[3,5]:[4,this.delay()];case 4:return l.sent(),[3,3];case 5:return t.items?(o.ComponentFactory.disableCache=!0,n=t.items,i=n.map((function(t){return e.componentFactory.create(t,a.activeTextMeasureDocument)})).filter((function(e){return e})),o.ComponentFactory.disableCache=!1,i.length<5,[4,Promise.all(i.map((function(e){return __awaiter(a,void 0,void 0,(function(){var t,n,i,o,s,a,l,c,u,d;return __generator(this,(function(h){switch(h.label){case 0:return e.canMeasureResultCache&&(t=this.calcMeasureCache(e))?[2,t]:((0,r.setDOMStyle)(e.htmlElement,{position:"fixed",top:"0px",left:"0px",opacity:"0",width:"unset",maxWidth:(null===(i=e.attributes)||void 0===i?void 0:i.maxWidth)&&"Infinity"!==(null===(o=e.attributes)||void 0===o?void 0:o.maxWidth)?(null===(s=e.attributes)||void 0===s?void 0:s.maxWidth)+"px":"999999px",height:"unset",maxHeight:(null===(a=e.attributes)||void 0===a?void 0:a.maxHeight)&&"Infinity"!==(null===(l=e.attributes)||void 0===l?void 0:l.maxHeight)?(null===(c=e.attributes)||void 0===c?void 0:c.maxHeight)+"px":"999999px"}),this.activeTextMeasureDocument.body.appendChild(e.htmlElement),[4,this.delay()]);case 1:h.sent(),h.label=2;case 2:return[4,e.htmlElement.getBoundingClientRect()];case 3:return n=h.sent(),e.htmlElement.remove(),e.canMeasureResultCache&&this.saveMeasureCache(e,n),[2,{measureId:e.attributes.measureId,width:Math.ceil(null!==(u=null==n?void 0:n.width)&&void 0!==u?u:0)+2,height:Math.ceil(null!==(d=null==n?void 0:n.height)&&void 0!==d?d:0)+1}]}}))}))})))]):[3,7];case 6:l.sent().forEach((function(t){e.componentFactory.callbackTextMeasureResult(t.measureId,t)})),l.label=7;case 7:return[2]}}))}))},e.zhMeasureCache={},e}();n.TextMeasurer=a},{"./components/basic/rich_text":22,"./components/component_factory":27,"./components/dom_utils":30,"./router":55}],57:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.WindowInfo=void 0;var i=e("./env"),o=function(){function e(e){this.engine=e}return e.prototype.updateWindowInfo=function(){var e;this.engine.sendMessage(JSON.stringify({type:"window_info",message:{window:{width:i.MPEnv.platformScope.getSystemInfoSync().screenWidth,height:i.MPEnv.platformScope.getSystemInfoSync().screenHeight,padding:{top:i.MPEnv.platformScope.getSystemInfoSync().statusBarHeight,bottom:i.MPEnv.platformScope.getSystemInfoSync().screenHeight-(null===(e=i.MPEnv.platformScope.getSystemInfoSync().safeArea)||void 0===e?void 0:e.bottom)}},devicePixelRatio:i.MPEnv.platformScope.getSystemInfoSync().pixelRatio,darkMode:"dark"===i.MPEnv.platformScope.getSystemInfoSync().theme}}))},e}();n.WindowInfo=o},{"./env":46}],58:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.WXPage=n.WXApp=void 0;var i=e("./platform_channel/plugin_register"),o=e("./platform_channel/mp_method_channel"),r=e("./env"),s=e("./page"),a=e("./router"),l=e("./text_measurer"),c={};try{var u=e("mp-custom-components");u.usingComponents&&(c=u.usingComponents)}catch(e){console.error(e)}var d={router:{},runtime:{subpackagesMap:{},tabBarMap:{},usingComponents:c},pages:{index:{}},redirect:{},optimization:{domSubTreeLevel:10,elementMultiplexing:!0,textMultiplexing:!0,commentMultiplexing:!0,domExtendMultiplexing:!0,styleValueReduce:5e3,attrValueReduce:5e3}},h=function(e,t){this.indexPage=e,this.engine=t,this.router=new p(this.engine),t.app=this};n.WXApp=h;n.WXPage=function(e,t,n){return void 0===t&&(t="#vdom"),void 0===n&&(n=r.MPEnv.platformGlobal().app),{data:{pageMeta:{naviBar:{}}},kboneRender:void 0,kboneDocument:void 0,kbonePageId:void 0,lightModeStyle:{naviBarBackgroundColor:"#ffffff",naviBarFrontColor:"#000000"},darkModeStyle:{naviBarBackgroundColor:"#000000",naviBarFrontColor:"#ffffff"},prepare:function(){var e=this,t=this.kboneRender.createPage(this.route,d);this.kbonePageId=t.pageId;var n=t.window;this.kboneDocument=t.document,this.kboneDocument.window=n,n.$$createSelectorQuery=function(){return r.MPEnv.platformScope.createSelectorQuery().in(e)},n.$$createIntersectionObserver=function(t){return r.MPEnv.platformScope.createIntersectionObserver(e,t)};var i="dark"===r.MPEnv.platformScope.getSystemInfoSync().theme?this.darkModeStyle:this.lightModeStyle;this.setData({pageId:this.kbonePageId,"pageMeta.naviBar.backgroundColor":i.naviBarBackgroundColor,"pageMeta.naviBar.naviBarFrontColor":i.naviBarFrontColor})},onLoad:function(t){var i,o;this.prepare();var r=this.kboneDocument,c=this.kboneDocument;l.TextMeasurer.activeTextMeasureDocument=c,a.Router.clearBeingPushTimeout(),a.Router.beingPush=!1;var u,d=((u=n.indexPage.split("/")).pop(),u.join("/")),h=e;if(!e||t.route){var p=__assign({},t);delete p.route,t.route?h={route:t.route,params:p}:"/index"===(h={route:null!==(o=null===(i=this.route)||void 0===i?void 0:i.replace(d,""))&&void 0!==o?o:"/",params:p}).route&&(h.route="/")}(null==h?void 0:h.route)&&(h.route=decodeURIComponent(h.route),h.params=__assign({},t)),this.mpPage=new s.Page(r.body,n.engine,h,r),this.mpPage.miniProgramPage=this,this.mpPage.isFirst=1===getCurrentPages().length},onUnload:function(){this.mpPage.viewId&&n.router.disposeRoute(this.mpPage.viewId)},onShow:function(){var e;l.TextMeasurer.activeTextMeasureDocument=null!==(e=this.kboneDocument)&&void 0!==e?e:this.selectComponent(t+"_tm").miniDom.document,a.Router.clearBeingPushTimeout(),a.Router.beingPush=!1},onHide:function(){0},onAppShow:function(){},onPullDownRefresh:function(){this.mpPage.onRefresh().then((function(e){r.MPEnv.platformScope.stopPullDownRefresh()}))},onShareAppMessage:function(e){return{promise:this.mpPage.onWechatMiniProgramShareAppMessage(e)}},onReachBottom:function(){this.mpPage.onReachBottom()},onPageScroll:function(e){this.mpPage.onPageScroll(e.scrollTop),this.kboneDocument.window.scrollY=e.scrollTop,this.kboneDocument.window.scrollY=e.scrollTop,this.kboneDocument.window.scrollY=e.scrollTop,this.kboneDocument.window.$$trigger("scroll",e.scrollTop)}}};var p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.encodeRelativePath=function(e,t){var n=[];if(t)for(var i in t)n.push("".concat(i,"=").concat(encodeURIComponent(t[i])));return n.length>0?"".concat(e,"?").concat(n.join("&")):"".concat(e)},t.prototype.encodeIndexPath=function(e,t){var n=[];if(t)for(var i in t)n.push("".concat(i,"=").concat(encodeURIComponent(t[i])));var o=e.indexOf("?")>=0?e.split("?")[0]:e,r=e.indexOf("?")>=0?e.substr(e.indexOf("?")):"";return n.length>0?"/".concat(this.engine.app.indexPage,"?route=").concat(encodeURI(o)).concat(encodeURIComponent(r),"&").concat(n.join("&")):"/".concat(this.engine.app.indexPage,"?route=").concat(encodeURI(o)).concat(encodeURIComponent(r))},t.prototype.didPush=function(e){var t=this;a.Router.clearBeingPushTimeout(),a.Router.beingPush=!0;var n=e.routeId;this.thePushingRouteId=n;var i=e.name;r.MPEnv.platformScope.navigateTo({url:this.encodeRelativePath(i,e.params),fail:function(){r.MPEnv.platformScope.navigateTo({url:t.encodeIndexPath(i,e.params)})}}),a.Router.beingPushTimeout=setTimeout((function(){a.Router.beingPush=!1}),1e3)},t.prototype.didReplace=function(e){var t=this;a.Router.clearBeingPushTimeout(),a.Router.beingPush=!0;var n=e.routeId;this.thePushingRouteId=n;var i=e.name;r.MPEnv.platformScope.redirectTo({url:this.encodeRelativePath(i,e.params),fail:function(){r.MPEnv.platformScope.redirectTo({url:t.encodeIndexPath(i,e.params)})}}),a.Router.beingPushTimeout=setTimeout((function(){a.Router.beingPush=!1}),1e3)},t.prototype.didPop=function(){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(e){switch(e.label){case 0:return a.Router.beingPush?[4,this.delayPop()]:[3,2];case 1:e.sent(),e.label=2;case 2:return a.Router.clearBeingPushTimeout(),a.Router.beingPush=!0,r.MPEnv.platformScope.navigateBack(),a.Router.beingPushTimeout=setTimeout((function(){a.Router.beingPush=!1}),1e3),[2]}}))}))},t.prototype.delayPop=function(){0},t}(a.Router),m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onMethodCall=function(e,t){var n;return __awaiter(this,void 0,void 0,(function(){var i,o=this;return __generator(this,(function(s){if("Clipboard.setData"===e)return r.MPEnv.platformScope.setClipboardData({data:t.text}),[2,null];if("Clipboard.getData"===e)return[2,new Promise((function(e,t){r.MPEnv.platformScope.getClipboardData({success:function(t){e({text:t.data})},fail:function(e){t(e)}})}))];if("RootBundle.getAssets"===e)return(null===(n=this.engine)||void 0===n?void 0:n.debugger)?(i="http://".concat(o.engine.debugger.serverAddr,"/assets/").concat(t.uri),[2,new Promise((function(e,t){r.MPEnv.platformScope.request({url:i,responseType:"arraybuffer",success:function(t){e(r.MPEnv.platformScope.arrayBufferToBase64(t.data))},fail:function(e){t(e.errMsg)}})}))]):[2,r.MPEnv.platformScope.getFileSystemManager().readFileSync("assets/"+t.uri,"base64",0)];throw"NOTIMPLEMENTED"}))}))},t}(o.MPMethodChannel);i.PluginRegister.registerChannel("flutter/platform",m)},{"./env":46,"./page":50,"./platform_channel/mp_method_channel":52,"./platform_channel/plugin_register":54,"./router":55,"./text_measurer":56,"mp-custom-components":"mp-custom-components"}]},{},[48])(48)}));
